<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Spring-ä¾èµ–æŸ¥æ‰¾</title>
      <link href="/2020/07/14/Spring-%E4%BE%9D%E8%B5%96%E6%9F%A5%E6%89%BE/"/>
      <url>/2020/07/14/Spring-%E4%BE%9D%E8%B5%96%E6%9F%A5%E6%89%BE/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¾èµ–æŸ¥æ‰¾"><a href="#ä¾èµ–æŸ¥æ‰¾" class="headerlink" title="ä¾èµ–æŸ¥æ‰¾"></a>ä¾èµ–æŸ¥æ‰¾</h2><h3 id="å†å²"><a href="#å†å²" class="headerlink" title="å†å²"></a>å†å²</h3><h3 id="å•ä¸€ç±»å‹ä¾èµ–æŸ¥æ‰¾"><a href="#å•ä¸€ç±»å‹ä¾èµ–æŸ¥æ‰¾" class="headerlink" title="å•ä¸€ç±»å‹ä¾èµ–æŸ¥æ‰¾"></a>å•ä¸€ç±»å‹ä¾èµ–æŸ¥æ‰¾</h3><p>JNDI - javax.naming.Context#lookup*(javax.naming.Name);<br>JavaBeans - java.beans.beancontext.BeanContext</p><p>BeanFactory:</p><p> æ ¹æ®beanåç§°æŸ¥æ‰¾<br> getBean(String);<br> getBean(String,Objectâ€¦) //è¦†ç›–é»˜è®¤å‚æ•°</p><p> æ ¹æ®Beanç±»å‹æŸ¥æ‰¾<br> beanå®æ—¶æŸ¥æ‰¾<br>   getBean(Class)<br>   getBean(Class,Objectâ€¦)<br> beanå»¶æ—¶æŸ¥æ‰¾<br>   getBeanProvider(Class);<br>   getBeanProvider(String,Class); //è¦†ç›–é»˜è®¤å‚æ•°</p><p>æ ¹æ®Beanåç§°å’Œç±»å‹æŸ¥æ‰¾<br>  getBean(String,Class);</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡ &#123;<span class="doctag">@link</span> org.springframework.beans.factory.ObjectProvider&#125; è¿›è¡Œä¾èµ–æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectProviderDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">        applicationContext.register(ObjectProviderDemo<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        applicationContext.refresh();</span><br><span class="line">        lookupByObjectProvider(applicationContext);</span><br><span class="line">        applicationContext.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">helloWorld</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">lookupByObjectProvider</span><span class="params">(AnnotationConfigApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">        ObjectProvider&lt;String&gt; objectProvider = applicationContext.getBeanProvider(String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(objectProvider.getObject());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é›†åˆç±»å‹ä¾èµ–æŸ¥æ‰¾"><a href="#é›†åˆç±»å‹ä¾èµ–æŸ¥æ‰¾" class="headerlink" title="é›†åˆç±»å‹ä¾èµ–æŸ¥æ‰¾"></a>é›†åˆç±»å‹ä¾èµ–æŸ¥æ‰¾</h3><p>java.beans.beancontext.BeanContext</p><h4 id="ListableBeanFactory"><a href="#ListableBeanFactory" class="headerlink" title="ListableBeanFactory"></a>ListableBeanFactory</h4><p>æ˜¯é’ˆå¯¹æŸä¸ªç±»å‹å»æŸ¥æ‰¾ä¸€ä¸ªé›†åˆåˆ—è¡¨ã€‚<br>ä¸€ç§æ˜¯æŸ¥è¯¢beançš„åç§°ï¼Œ ä¸€ç§æ˜¯æŸ¥è¯¢beançš„å®ä¾‹ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨beançš„åç§°æ¥åˆ¤æ–­å½“å‰beanæ˜¯å¦å­˜åœ¨ï¼Œæˆ–è€…è¿›ä¸€æ­¥åˆ¤æ–­BeanDefinitionæ˜¯å¦å­˜åœ¨ã€‚<br>è€ŒæŸ¥è¯¢beanå®ä¾‹ä¼šææ—©åˆå§‹åŒ–beanå®ä¾‹ï¼Œé€ æˆåˆå§‹åŒ–ä¸å®Œæ•´ã€‚</p><ul><li>æ ¹æ®Beanç±»å‹æŸ¥æ‰¾<ul><li>è·å–åŒç±»å‹Beanåç§°åˆ—è¡¨<ul><li>getBeanNamesForType(Class)</li><li>getBeanNamesForType(ResolvableType)</li></ul></li><li>è·å–ç—›ç±»å‹Beanå®ä¾‹åˆ—è¡¨<ul><li>getBeansOfType(Class)ä»¥åŠé‡è½½æ–¹æ³•</li></ul></li></ul></li><li>æ ¹æ®æ³¨è§£ç±»å‹æŸ¥æ‰¾<ul><li>è·å–æ ‡æ³¨ç±»å‹Bean åç§°åˆ—è¡¨<ul><li>getBeanNamesForAnnotation(Class&lt;? extends Annotation&gt;);</li></ul></li><li>è·å–æ ‡æ³¨ç±»å‹Beanå®ä¾‹åˆ—è¡¨<ul><li>getBeansWithAnnotation(Class&lt;? extends Annotation&gt;);</li></ul></li><li>è·å–æŒ‡å®šåç§°+æ ‡æ³¨ç±»å‹å®ä¾‹<ul><li>findAnnotationOnBean(String,Class&lt;? extends Annotation&gt;);</li></ul></li></ul></li></ul><h3 id="å±‚æ¬¡æ€§ä¾èµ–æŸ¥æ‰¾"><a href="#å±‚æ¬¡æ€§ä¾èµ–æŸ¥æ‰¾" class="headerlink" title="å±‚æ¬¡æ€§ä¾èµ–æŸ¥æ‰¾"></a>å±‚æ¬¡æ€§ä¾èµ–æŸ¥æ‰¾</h3><p>java.beans.beancontext.BeanContext</p><h4 id="HierachicalBeanFactory"><a href="#HierachicalBeanFactory" class="headerlink" title="HierachicalBeanFactory"></a>HierachicalBeanFactory</h4><p><img src="/2020/07/14/Spring-%E4%BE%9D%E8%B5%96%E6%9F%A5%E6%89%BE/hierarchical_class.jpg" alt></p><ul><li>åŒäº² BeanFactory: getParentBeanFactory();<ul><li>å±‚æ¬¡æŸ¥æ‰¾</li><li>æ ¹æ®Beanåç§°æŸ¥æ‰¾<ul><li>åŸºäºcontainsLocalBeanæ–¹æ³•å®ç°   </li></ul></li><li>æ ¹æ®Beanç±»å‹æŸ¥æ‰¾å®ä¾‹åˆ—è¡¨<ul><li>å•ä¸€ç±»å‹ï¼šBeanFactoryUtils#beanOfType</li><li>é›†åˆç±»å‹ï¼šBeanFactoryUtils#beansOfTypeIncludingAncestors</li></ul></li><li>æ ¹æ®Javaæ³¨è§£æŸ¥æ‰¾åç§°åˆ—è¡¨<ul><li>BeanFactoryUtils#beanNamesForTypeIncludingAncestors</li></ul></li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HierarchicalDependencyLookupDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line"></span><br><span class="line">        ConfigurableListableBeanFactory beanFactory = applicationContext.getBeanFactory();</span><br><span class="line"></span><br><span class="line">        HierarchicalBeanFactory parentBeanFactory = createParentBeanFactory();</span><br><span class="line"></span><br><span class="line">        beanFactory.setParentBeanFactory(parentBeanFactory);</span><br><span class="line"></span><br><span class="line">        displayContainsLocalBean(beanFactory, <span class="string">"user"</span>); <span class="comment">//false</span></span><br><span class="line">        displayContainsLocalBean(parentBeanFactory, <span class="string">"user"</span>); <span class="comment">//true</span></span><br><span class="line">        </span><br><span class="line">        displayContainsBean(beanFactory, <span class="string">"user"</span>); <span class="comment">//true</span></span><br><span class="line">        displayContainsBean(parentBeanFactory,<span class="string">"user"</span>);<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">        applicationContext.refresh();</span><br><span class="line">        applicationContext.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">displayContainsBean</span><span class="params">(HierarchicalBeanFactory beanFactory, String beanName)</span> </span>&#123;</span><br><span class="line">        System.out.printf(<span class="string">"å½“å‰ BeanFactory [%s] æ˜¯å¦åŒ…å«  bean[name:%s]  %s\n"</span>, beanFactory, beanName, containsBean(beanFactory,beanName));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">containsBean</span><span class="params">(HierarchicalBeanFactory beanFactory, String beanName)</span> </span>&#123;</span><br><span class="line">        BeanFactory parentBeanFactory = beanFactory.getParentBeanFactory();</span><br><span class="line">        <span class="keyword">if</span> (parentBeanFactory <span class="keyword">instanceof</span> HierarchicalBeanFactory) &#123;</span><br><span class="line">            HierarchicalBeanFactory parentHierarchicalBeanFactory = HierarchicalBeanFactory<span class="class">.<span class="keyword">class</span>.<span class="title">cast</span>(<span class="title">parentBeanFactory</span>)</span>;</span><br><span class="line">            <span class="keyword">if</span> (containsBean(parentHierarchicalBeanFactory, beanName)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> beanFactory.containsLocalBean(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">displayContainsLocalBean</span><span class="params">(HierarchicalBeanFactory parentBeanFactory, String user)</span> </span>&#123;</span><br><span class="line">        System.out.printf(<span class="string">"å½“å‰ BeanFactory [%s] æ˜¯å¦åŒ…å« Local bean[name:%s]  %s\n"</span>, parentBeanFactory, user, parentBeanFactory.containsLocalBean(user));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> HierarchicalBeanFactory <span class="title">createParentBeanFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        DefaultListableBeanFactory beanFactory = <span class="keyword">new</span> DefaultListableBeanFactory();</span><br><span class="line">        XmlBeanDefinitionReader reader = <span class="keyword">new</span> XmlBeanDefinitionReader(beanFactory);</span><br><span class="line">        String location = <span class="string">"classpath:applicationContext-lookup.xml"</span>;</span><br><span class="line">        reader.loadBeanDefinitions(location);</span><br><span class="line">        <span class="keyword">return</span> beanFactory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å»¶è¿Ÿä¾èµ–æŸ¥æ‰¾"><a href="#å»¶è¿Ÿä¾èµ–æŸ¥æ‰¾" class="headerlink" title="å»¶è¿Ÿä¾èµ–æŸ¥æ‰¾"></a>å»¶è¿Ÿä¾èµ–æŸ¥æ‰¾</h3><p><img src="/2020/07/14/Spring-%E4%BE%9D%E8%B5%96%E6%9F%A5%E6%89%BE/ObjectFactory_Class.jpg" alt></p><ul><li>Beanå»¶è¿Ÿä¾èµ–æŸ¥æ‰¾æ¥å£<ul><li>org.springframework.beans.factory.ObjectFactory#getObject();</li><li>org.springframework.beans.factory.ObjectProvider<ul><li>Spring5å¯¹äºJava8çš„ç‰¹æ€§æ‰©å±•</li><li>å‡½æ•°å¼æ¥å£<ul><li>getIfAvailable(Supplier)</li><li>ifAvailable(Consumer)</li></ul></li><li>Streamæ‰©å±• - stream() </li></ul></li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡ &#123;<span class="doctag">@link</span> org.springframework.beans.factory.ObjectProvider&#125; è¿›è¡Œä¾èµ–æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectProviderDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">        applicationContext.register(ObjectProviderDemo<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        applicationContext.refresh();</span><br><span class="line"></span><br><span class="line">        lookupByObjectProvider(applicationContext);</span><br><span class="line">        lookupIfAvailable(applicationContext);</span><br><span class="line">        lookupByStream(applicationContext);</span><br><span class="line">        applicationContext.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">lookupByStream</span><span class="params">(AnnotationConfigApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">        ObjectProvider&lt;String&gt; objectProvider = applicationContext.getBeanProvider(String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//        Iterator&lt;String&gt; iterator = objectProvider.iterator();</span></span><br><span class="line"><span class="comment">//        while(iterator.hasNext())&#123;</span></span><br><span class="line"><span class="comment">//            System.out.println(iterator.next());</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        objectProvider.stream().forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">lookupIfAvailable</span><span class="params">(AnnotationConfigApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">        ObjectProvider&lt;User&gt; userObjectProvider = applicationContext.getBeanProvider(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        User user = userObjectProvider.getIfAvailable(User::<span class="keyword">new</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Primary</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">helloWorld</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">message</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"message"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">lookupByObjectProvider</span><span class="params">(AnnotationConfigApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">        ObjectProvider&lt;String&gt; objectProvider = applicationContext.getBeanProvider(String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(objectProvider.getObject());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰å…¨ä¾èµ–æŸ¥æ‰¾"><a href="#å®‰å…¨ä¾èµ–æŸ¥æ‰¾" class="headerlink" title="å®‰å…¨ä¾èµ–æŸ¥æ‰¾"></a>å®‰å…¨ä¾èµ–æŸ¥æ‰¾</h3><p>ä¾èµ–æŸ¥æ‰¾å®‰å…¨æ€§å¯¹æ¯”</p><table><thead><tr><th>ä¾èµ–æŸ¥æ‰¾ç±»å‹</th><th>ä»£è¡¨å®ç°</th><th>æ˜¯å¦å®‰å…¨</th></tr></thead><tbody><tr><td>å•ä¸€ç±»å‹æŸ¥æ‰¾</td><td>BeanFactory#getBean</td><td>å¦</td></tr><tr><td></td><td>ObjectFactory#getObject</td><td>å¦</td></tr><tr><td></td><td>ObjectProvider#getIfAvailable</td><td>æ˜¯</td></tr><tr><td>é›†åˆç±»å‹æŸ¥æ‰¾</td><td>ListableBeanFactory#getBeansOfType</td><td>æ˜¯</td></tr><tr><td></td><td>ObjectProvider.stream</td><td>æ˜¯</td></tr></tbody></table><h3 id="å†…å»ºå¯æŸ¥æ‰¾çš„ä¾èµ–"><a href="#å†…å»ºå¯æŸ¥æ‰¾çš„ä¾èµ–" class="headerlink" title="å†…å»ºå¯æŸ¥æ‰¾çš„ä¾èµ–"></a>å†…å»ºå¯æŸ¥æ‰¾çš„ä¾èµ–</h3><h3 id="ä¾èµ–æŸ¥æ‰¾ä¸­çš„å¼‚å¸¸"><a href="#ä¾èµ–æŸ¥æ‰¾ä¸­çš„å¼‚å¸¸" class="headerlink" title="ä¾èµ–æŸ¥æ‰¾ä¸­çš„å¼‚å¸¸"></a>ä¾èµ–æŸ¥æ‰¾ä¸­çš„å¼‚å¸¸</h3><h3 id="åŠé€€"><a href="#åŠé€€" class="headerlink" title="åŠé€€"></a>åŠé€€</h3>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> ä¾èµ–æŸ¥æ‰¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring-Bean</title>
      <link href="/2020/07/14/Spring-Bean/"/>
      <url>/2020/07/14/Spring-Bean/</url>
      
        <content type="html"><![CDATA[<h2 id="BeanDefinition"><a href="#BeanDefinition" class="headerlink" title="BeanDefinition"></a>BeanDefinition</h2><blockquote><p>A BeanDefinition describes a bean instance, which has property values,<br>Constructor arguments values, and further information supplied by concrete implementations.<br>This is just a minimal interface: The main intention is to allow a BeanFactoryPostProcessor to introspect and modify property values and other bean metadata.</p></blockquote><p><img src="/2020/07/14/Spring-Bean/beandefinition_class.jpg" alt="BeanDefinition ç±»å›¾"></p><p>BeanDefinitionï¼š é¡¶çº§çˆ¶æ¥å£<br>AbstractBeanDefinitionï¼šæ˜¯GenericBeanDefinitionã€RootBeanDefinitionã€ChildBeanDefinition çš„é€šç”¨å±æ€§çš„å®Œæ•´å®ç°ã€‚<br>GenericBeanDefinition: æ ‡å‡†çš„beanå®šä¹‰ç›®çš„çš„ä¸€ç«™å¼æœåŠ¡ç±»ï¼Œ</p><p>BeanDefinitionæ˜¯SpringFrameworkä¸­å®šä¹‰çš„é…ç½®å…ƒä¿¡æ¯æ¥å£,åŒ…å«äº†ï¼š</p><ul><li>Bean çš„ç±»å</li><li>Bean çš„è¡Œä¸ºé…ç½®å…ƒç´ ï¼Œå¦‚ä½œç”¨åŸŸã€è‡ªåŠ¨ç»‘å®šæ¨¡å¼ã€ç”Ÿå‘½å‘¨æœŸå›è°ƒç­‰</li><li>å…¶ä»–Beanå¼•ç”¨ï¼Œï¼ˆCollaboratorsã€Dependends)</li><li>é…ç½®è®¾ç½®ï¼ˆBeançš„Propertiesï¼‰</li></ul><h3 id="BeanDefinition-å…ƒä¿¡æ¯"><a href="#BeanDefinition-å…ƒä¿¡æ¯" class="headerlink" title="BeanDefinition å…ƒä¿¡æ¯"></a>BeanDefinition å…ƒä¿¡æ¯</h3><table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Class</td><td>Beançš„å…¨é™ç±»åï¼Œå¿…é¡»æ˜¯å…·ä½“ç±»</td></tr><tr><td>Name</td><td>Beançš„åç§°æˆ–è€…ğŸ†”</td></tr><tr><td>Scope</td><td>Beançš„ä½œç”¨åŸŸï¼Œsingletonã€prototype</td></tr><tr><td>Constructor arguments</td><td>Beançš„æ„é€ å™¨å‚æ•° for DI</td></tr><tr><td>Properties</td><td>Beançš„å±æ€§è®¾ç½® for DI</td></tr><tr><td>Autowiring Mode</td><td>Beançš„è‡ªåŠ¨ç»‘å®šæ¨¡å¼ï¼šByName ã€ byType</td></tr><tr><td>Lazy Initialization Mode</td><td>Bean å»¶è¿Ÿåˆå§‹åŒ–æ¨¡å¼</td></tr><tr><td>initialzation method</td><td>Beanåˆå§‹åŒ–å›è°ƒæ–¹æ³•åç§°</td></tr><tr><td>destruction method</td><td>Bean é”€æ¯å›è°ƒæ–¹æ³•åç§°</td></tr></tbody></table><h3 id="BeanDefinition-æ„å»º"><a href="#BeanDefinition-æ„å»º" class="headerlink" title="BeanDefinition æ„å»º"></a>BeanDefinition æ„å»º</h3><ul><li>é€šè¿‡BeanDefinitionBuilderæ„å»ºBeandefinition</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">        <span class="comment">//bean definition builder.</span></span><br><span class="line">BeanDefinitionBuilder beanDefinitionBuilder = BeanDefinitionBuilder.genericBeanDefinition(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">beanDefinitionBuilder.addPropertyValue(<span class="string">"id"</span>,<span class="number">1L</span>);</span><br><span class="line">beanDefinitionBuilder.addPropertyValue(<span class="string">"name"</span>,<span class="string">"lisi"</span>);</span><br><span class="line"></span><br><span class="line">BeanDefinition beanDefinition = beanDefinitionBuilder.getBeanDefinition();</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡GenericBeanDefinition æ„å»º</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GenericBeanDefinition genericBeanDefinition = <span class="keyword">new</span> GenericBeanDefinition();</span><br><span class="line">genericBeanDefinition.setBeanClass(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">MutablePropertyValues propertyValues = <span class="keyword">new</span> MutablePropertyValues();</span><br><span class="line"><span class="comment">//        propertyValues.addPropertyValue("id",2L);</span></span><br><span class="line"><span class="comment">//        propertyValues.addPropertyValue("name","zhaowu");</span></span><br><span class="line"></span><br><span class="line">propertyValues.add(<span class="string">"id"</span>,<span class="number">2L</span>)</span><br><span class="line">        .add(<span class="string">"name"</span>,<span class="string">"zhaowu"</span>);</span><br><span class="line">genericBeanDefinition.setPropertyValues(propertyValues);</span><br></pre></td></tr></table></figure><h2 id="SpringBean-å‘½å"><a href="#SpringBean-å‘½å" class="headerlink" title="SpringBean å‘½å"></a>SpringBean å‘½å</h2><p>æ¯ä¸ªBeanæ‹¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ ‡è¯†ç¬¦ï¼Œè¿™äº›æ ‡è¯†ç¬¦åœ¨Beanæ‰€åœ¨çš„å®¹å™¨å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚<br>é€šå¸¸ï¼Œä¸€ä¸ªBeanä»…æœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åˆ«åæ¥æ‰©å……ã€‚</p><p>åœ¨åŸºäºXMLçš„é…ç½®å…ƒä¿¡æ¯ä¸­ï¼Œå¯ä»¥ä½¿ç”¨idæˆ–è€…nameå±æ€§æ¥è´µå§“Beançš„æ ‡è¯†ç¬¦ã€‚é€šå¸¸Beançš„æ ‡è¯†ç¬¦ç”±å­—æ¯ç»„æˆï¼Œå…è®¸å‡ºç°ç‰¹æ®Šå­—ç¬¦ã€‚å¯ä»¥åœ¨Beançš„nameå±æ€§ä½¿ç”¨é€—å·â€œ,â€æˆ–è€…â€œ;â€æˆ–è€…ç©ºæ ¼æ¥é—´éš”ã€‚</p><p>Beançš„idæˆ–è€…nameå±æ€§å¦‚æœä¸ºç©ºï¼Œå®¹å™¨ä¼šä¸ºBeanè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„åç§°ã€‚</p><h3 id="BeanNameGenerator"><a href="#BeanNameGenerator" class="headerlink" title="BeanNameGenerator"></a>BeanNameGenerator</h3><p><img src="/2020/07/14/Spring-Bean/bean_name_generator.jpg" alt="BeanNameGenerator ç±»å›¾"></p><h3 id="BeanDefinition-é…ç½®"><a href="#BeanDefinition-é…ç½®" class="headerlink" title="BeanDefinition é…ç½®"></a>BeanDefinition é…ç½®</h3><h4 id="Xml"><a href="#Xml" class="headerlink" title="Xml"></a>Xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.github.springframework.models.User"</span> <span class="attr">primary</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"id"</span> <span class="attr">value</span>=<span class="string">"1"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"zhangsan"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"superUser"</span> <span class="attr">class</span>=<span class="string">"com.github.springframework.models.SuperUser"</span> <span class="attr">parent</span>=<span class="string">"user"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"addr"</span> <span class="attr">value</span>=<span class="string">"ä¸Šæµ·"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"objectFactory"</span> <span class="attr">class</span>=<span class="string">"org.springframework.beans.factory.config.ObjectFactoryCreatingFactoryBean"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"targetBeanName"</span> <span class="attr">value</span>=<span class="string">"user"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Javaæ³¨è§£-Bean"><a href="#Javaæ³¨è§£-Bean" class="headerlink" title="Javaæ³¨è§£ @Bean"></a>Javaæ³¨è§£ @Bean</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationBeanDefinitionDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//create factory bean</span></span><br><span class="line">        AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//register config class.</span></span><br><span class="line">        applicationContext.register(Config<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//refresh</span></span><br><span class="line">        applicationContext.refresh();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//getUser</span></span><br><span class="line">        System.out.println(applicationContext.getBean(User<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span></span>&#123;</span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">            User user = <span class="keyword">new</span> User();</span><br><span class="line">            user.setId(<span class="number">1L</span>);</span><br><span class="line">            user.setName(<span class="string">"Ann: zhangsan"</span>);</span><br><span class="line">            <span class="keyword">return</span> user;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Javaæ³¨è§£-Component"><a href="#Javaæ³¨è§£-Component" class="headerlink" title="Javaæ³¨è§£ @Component"></a>Javaæ³¨è§£ @Component</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationBeanDefinitionDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//create factory bean</span></span><br><span class="line">        AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//register config class.</span></span><br><span class="line">        applicationContext.register(Config<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//refresh</span></span><br><span class="line">        applicationContext.refresh();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        System.out.println(applicationContext.getBean(Config<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Component</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span></span>&#123;</span><br><span class="line">        <span class="meta">@Bean</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> User <span class="title">user</span><span class="params">()</span></span>&#123;</span><br><span class="line">            User user = <span class="keyword">new</span> User();</span><br><span class="line">            user.setId(<span class="number">1L</span>);</span><br><span class="line">            user.setName(<span class="string">"Ann: zhangsan"</span>);</span><br><span class="line">            <span class="keyword">return</span> user;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BeanDefinitionæ³¨å†Œåˆ°å®¹å™¨"><a href="#BeanDefinitionæ³¨å†Œåˆ°å®¹å™¨" class="headerlink" title="BeanDefinitionæ³¨å†Œåˆ°å®¹å™¨"></a>BeanDefinitionæ³¨å†Œåˆ°å®¹å™¨</h2><p><img src="/2020/07/14/Spring-Bean/BeanDefinitionRegistry_Class.jpg" alt="BeanDefinitionRegistry ç±»å›¾"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">beanDefinitionRegistry</span><span class="params">(BeanDefinitionRegistry registry, String name)</span> </span>&#123;</span><br><span class="line">    BeanDefinitionBuilder beanDefinitionBuilder = BeanDefinitionBuilder.genericBeanDefinition(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    beanDefinitionBuilder.addPropertyValue(<span class="string">"id"</span>, <span class="number">1L</span>)</span><br><span class="line">            .addPropertyValue(<span class="string">"name"</span>, <span class="string">"Reg: zhangsan"</span>);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.hasText(name)) &#123;</span><br><span class="line">        registry.registerBeanDefinition(name, beanDefinitionBuilder.getBeanDefinition());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        BeanDefinitionReaderUtils.registerWithGeneratedName(beanDefinitionBuilder.getBeanDefinition(),registry);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºAnnotatinoConfigApplicationContext æ˜¯ BeanDefinitionRegistryçš„é—´æ¥å­ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">applicationContext.register(Config<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">beanDefinitionRegistry(applicationContext,<span class="string">"REG:ZhangSan:Name"</span>);</span><br><span class="line">beanDefinitionRegistry(applicationContext,<span class="keyword">null</span>);</span><br><span class="line">applicationContext.refresh();</span><br><span class="line">System.out.println(applicationContext.getBeansOfType(Config<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">System.out.println(applicationContext.getBeansOfType(User<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">System.out.println(applicationContext.getBeansOfType(AnnotationApplicationContextDemo<span class="class">.<span class="keyword">class</span>))</span>;</span><br></pre></td></tr></table></figure><h2 id="Bean-å®ä¾‹åŒ–"><a href="#Bean-å®ä¾‹åŒ–" class="headerlink" title="Bean å®ä¾‹åŒ–"></a>Bean å®ä¾‹åŒ–</h2><p>å¸¸è§„ï¼š</p><ul><li><p>é€šè¿‡æ„é€ å™¨ï¼ˆé…ç½®å…ƒä¿¡æ¯ï¼šXMLã€Javaæ³¨è§£ã€JavaAPIï¼‰</p></li><li><p>é™æ€å·¥å‚æ–¹æ³•ï¼ˆé…ç½®å…ƒä¿¡æ¯ï¼šXMLã€JavaAPIï¼‰</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> User2 <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user-by-static-method"</span> <span class="attr">class</span>=<span class="string">"com.github.spring.beans.User2"</span>  <span class="attr">factory-method</span>=<span class="string">"getInstance"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:/META-INF/bean-creation-context.xml"</span>);</span><br><span class="line"></span><br><span class="line">User2 user = applicationContext.getBean(<span class="string">"user-by-static-method"</span>, User2<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure><ul><li>Beanå·¥å‚æ–¹æ³•ï¼ˆé…ç½®å…ƒä¿¡æ¯ï¼šXMLã€JavaAPIï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">default</span> User2 <span class="title">createuser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultUserFactory</span> <span class="keyword">implements</span> <span class="title">UserFactory</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userFactory"</span> <span class="attr">class</span>=<span class="string">"com.github.spring.factory.DefaultUserFactory"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user-by-instance-method"</span> <span class="attr">factory-bean</span>=<span class="string">"userFactory"</span> <span class="attr">factory-method</span>=<span class="string">"createuser"</span>/&gt;</span></span><br><span class="line">``</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">ApplicationContext applicationContext = new ClassPathXmlApplicationContext("classpath:/META-INF/bean-creation-context.xml");</span><br><span class="line">User2 user3 = applicationContext.getBean("user-by-instance-method", User2.class);</span><br></pre></td></tr></table></figure><ul><li>FactoryBeanï¼ˆXMLã€Javaæ³¨è§£ã€JavaAPIï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserFactoryBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span>&lt;<span class="title">User2</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User2 <span class="title">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> User2.getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> User2<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user-by-factory-bean"</span> <span class="attr">class</span>=<span class="string">"com.github.spring.factory.UserFactoryBean"</span>/&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:/META-INF/bean-creation-context.xml"</span>);</span><br><span class="line">User2 user2 = applicationContext.getBean(<span class="string">"user-by-factory-method"</span>, User2<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure><p>ç‰¹æ®Šæ–¹å¼ï¼š</p><ul><li>ServiceLoaderFactoryBean</li></ul><p>Java ServiceLoader: ä¼šåœ¨classpath:/META-INF/servicesä¸‹åŠ è½½æ¥å£é…ç½®æ–‡ä»¶ï¼š</p><p>æ–‡ä»¶ååç§°ä¸ºå…¨é™å®šæ¥å£åç§°ï¼Œå†…å®¹ä¸ºå…¨é™å®šå®ç°ç±»</p><p><img src="/2020/07/14/Spring-Bean/service-loader.jpg" alt="services é…ç½®æ–‡ä»¶"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.github.spring.factory.DefaultUserFactory</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">demoServiceLoader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ServiceLoader&lt;UserFactory&gt; serviceLoader = ServiceLoader.load(UserFactory<span class="class">.<span class="keyword">class</span>, <span class="title">Thread</span>.<span class="title">currentThread</span>().<span class="title">getContextClassLoader</span>())</span>;</span><br><span class="line">    displayServiceLoad(serviceLoader);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">displayServiceLoad</span><span class="params">(ServiceLoader&lt;UserFactory&gt; serviceLoader)</span> </span>&#123;</span><br><span class="line">    Iterator&lt;UserFactory&gt; iterator = serviceLoader.iterator();</span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">        UserFactory userFactory = iterator.next();</span><br><span class="line">        System.out.println(userFactory.createuser());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ServiceLoaderFactoryBeançš„å®ç°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userFactoryServiceLoader"</span> <span class="attr">class</span>=<span class="string">"org.springframework.beans.factory.serviceloader.ServiceLoaderFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"serviceType"</span> <span class="attr">value</span>=<span class="string">"com.github.spring.factory.UserFactory"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:/META-INF/sp-bean-creation-context.xml"</span>);</span><br><span class="line">ServiceLoader&lt;UserFactory&gt; serviceLoader = applicationContext.getBean(<span class="string">"userFactoryServiceLoader"</span>, ServiceLoader<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">displayServiceLoad(serviceLoader);</span><br></pre></td></tr></table></figure><ul><li>AutowireCapableBeanFactory#createBean(java.lang.Class,int, boolean);</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AutowireCapableBeanFactory beanFactory = applicationContext.getAutowireCapableBeanFactory();</span><br><span class="line">UserFactory userFactory = beanFactory.createBean(DefaultUserFactory<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">System.out.println(userFactory.createuser());</span><br></pre></td></tr></table></figure><ul><li>BeanDefinitionRegistry#registerBeanDefinition(String,BeanDefinition);</li></ul><h2 id="Beançš„åˆå§‹åŒ–"><a href="#Beançš„åˆå§‹åŒ–" class="headerlink" title="Beançš„åˆå§‹åŒ–"></a>Beançš„åˆå§‹åŒ–</h2><ul><li><p>@PostConstructor</p></li><li><p>InitializingBean çš„ afterPropertiesSet</p></li><li><p>Beançš„initMethod<br>@Bean(initMethod=â€â€)</p><bean initmethod>AbstractBeanDefinition.setInitMethodName("");</bean></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DefaultUserFactory</span> <span class="keyword">implements</span> <span class="title">UserFactory</span>, <span class="title">InitializingBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DefaultUserFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DefaultUserFactory Constructor Called."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DefaultUserFactory PostConstructor Called."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initUserFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DefaultUserFactory initUserFactory Called."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DefaultUserFactory afterPropertiesSet called."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanInitializationDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">        applicationContext.register(BeanInitializationDemo<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        applicationContext.refresh();</span><br><span class="line">        UserFactory userFactory = applicationContext.getBean(UserFactory<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">        <span class="title">System</span>.<span class="title">out</span>.<span class="title">println</span>(<span class="title">userFactory</span>.<span class="title">createuser</span>())</span>;</span><br><span class="line">        applicationContext.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span>(initMethod = <span class="string">"initUserFactory"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DefaultUserFactory <span class="title">userFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DefaultUserFactory();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å»¶è¿Ÿåˆå§‹åŒ–"><a href="#å»¶è¿Ÿåˆå§‹åŒ–" class="headerlink" title="å»¶è¿Ÿåˆå§‹åŒ–"></a>å»¶è¿Ÿåˆå§‹åŒ–</h3><ul><li>xml: <bean lazy-init="true"></bean></li><li>annotation: @Lazy</li></ul><p>å¯¹äºå»¶è¿Ÿåˆå§‹åŒ–ï¼Œæ˜¯åœ¨applicationContextåˆå§‹åŒ–ä¹‹åè¿›è¡Œåˆå§‹åŒ–ã€‚<br>éå»¶è¿Ÿåˆå§‹åŒ–ï¼Œæ˜¯åœ¨applicationContextåˆå§‹åŒ–ä¹‹å‰è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h2 id="Bean-çš„é”€æ¯"><a href="#Bean-çš„é”€æ¯" class="headerlink" title="Bean çš„é”€æ¯"></a>Bean çš„é”€æ¯</h2><ul><li>@PreDestroy</li><li>å®ç°DisposableBeanæ¥å£çš„destoy()æ–¹æ³•</li><li>Beançš„ destroyæ–¹æ³•<bean destroy>@Bean(destroy="")AbstractBeanDefinition.setDestroyMethodName(""); </bean></li></ul><h2 id><a href="#" class="headerlink" title></a></h2><ul><li>å¦‚ä½•æ³¨å†Œä¸€ä¸ªSpring Bean</li></ul><p>å¯ä»¥é€šè¿‡BeanDefinitionå’Œå¤–éƒ¨å•ä½“å¯¹è±¡æ¥æ³¨å†Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UserFactory userFactory = <span class="keyword">new</span> DefaultUserFactory();</span><br><span class="line">ConfiguableListableBeanFactory factory = applicationContext.getBeanFactory();</span><br><span class="line">factory.registerSingleton(<span class="string">"userFactory"</span>, userFactory);</span><br><span class="line"></span><br><span class="line">UserFactory userFactory = applicationContext.getBean(<span class="string">"UserFactory"</span>,UserFactory<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure><ul><li><p>Spring BeanDefinition æ˜¯ä»€ä¹ˆï¼Ÿ</p></li><li><p>Spring å®¹å™¨æ˜¯å¦‚ä½•æ³¨å†ŒBeançš„ï¼Ÿ</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring-Bean </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº«å…ƒæ¨¡å¼</title>
      <link href="/2020/07/12/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/12/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h2><p>äº«å…ƒæ¨¡å¼çš„ç›®çš„åœ¨äºè¿ç”¨å…±äº«æŠ€æœ¯ï¼Œä½¿å¾—ä¸€äº›ç»†ç²’åº¦çš„å¯¹è±¡å¯ä»¥å…±äº«ã€‚<br>å¤šé£Ÿç”¨ç»†ç²’åº¦çš„å¯¹è±¡ï¼Œä»¥ä¾¿äºé‡ç”¨æˆ–è€…é‡æ„ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä½¿ç”¨å…±äº«å¯¹è±¡å¯ä»¥æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡çš„ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p><p>å¤§é‡çš„ç»†ç²’åº¦å¯¹è±¡ï¼Œéœ€è¦æŠŠå¯¹è±¡çš„å…±æœ‰å±æ€§æå–å‡ºæ¥ï¼Œåšä¸ºå†…éƒ¨çŠ¶æ€ï¼Œå‰©ä½™çš„éå…±æœ‰åšä¸ºå¤–éƒ¨çŠ¶æ€ã€‚<br>å†…éƒ¨çŠ¶æ€ï¼šå¯ä»¥å…±äº«å‡ºæ¥çš„ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨è¥„å£å¯¹è±¡å†…éƒ¨ï¼Œå¹¶ä¸”ä¸ä¼šéšç€ç¯å¢ƒçš„æ”¹å˜è€Œæ”¹å˜ã€‚<br>å¤–éƒ¨çŠ¶æ€ï¼šå¯¹è±¡å¾—ä»¥ä¾èµ–çš„ä¸€ä¸ªæ ‡è®°ï¼Œæ˜¯éšç€ç¯å¢ƒçš„æ”¹å˜è€Œæ”¹å˜çš„ï¼Œä¸å¯ä»¥å…±äº«çš„çŠ¶æ€ã€‚</p><p><img src="/2020/07/12/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/fly_weight.jpeg" alt="äº«å…ƒæ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Flyweight"><a href="#Flyweight" class="headerlink" title="Flyweight"></a>Flyweight</h4><p>æŠ½è±¡äº«å…ƒè§’è‰²ï¼Œäº§å“æŠ½è±¡ç±»ï¼ŒåŒæ—¶å®šä¹‰å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€å’Œå†…éƒ¨çŠ¶æ€çš„æ¥å£æˆ–è€…å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span>  <span class="class"><span class="keyword">class</span> <span class="title">Flyweight</span></span>&#123;</span><br><span class="line">   <span class="keyword">private</span> String instrinsic; <span class="comment">//inner status</span></span><br><span class="line">   <span class="keyword">protected</span> <span class="keyword">final</span> String extrinsic; <span class="comment">//external status</span></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Flyweight</span><span class="params">(String extrinsic)</span></span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.extrinsic = extrinsic;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getInstrinsic</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.instrinsic;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInstrinsic</span><span class="params">(String instrinsic)</span></span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.instrinsic = instrinsic;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteFlyweight"><a href="#ConcreteFlyweight" class="headerlink" title="ConcreteFlyweight"></a>ConcreteFlyweight</h4><p>å…·ä½“äº«å…ƒè§’è‰²ï¼Œå®ç°æŠ½è±¡è§’è‰²çš„å®šä¹‰ä¸šåŠ¡ï¼Œè¯¥è§’è‰²ä¸­éœ€è¦æ³¨æ„çš„æ˜¯å†…éƒ¨çŠ¶æ€å¤„ç†åº”è¯¥ä¸ç¯å¢ƒæ— å…³ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFlyweight1</span> <span class="keyword">extends</span> <span class="title">Flyweight</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteFlyweight1</span><span class="params">(String _Extrinsic)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(_Extrinsic);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFlyweight2</span> <span class="keyword">extends</span> <span class="title">Flyweight</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteFlyweight2</span><span class="params">(String _Extrinsic)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(_Extrinsic);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="unsharConcreteFlyweight"><a href="#unsharConcreteFlyweight" class="headerlink" title="unsharConcreteFlyweight"></a>unsharConcreteFlyweight</h4><p>ä¸å¯å…±äº«çš„äº«å…ƒè§’è‰²</p><p>ä¸å­˜åœ¨å¤–éƒ¨çŠ¶æ€æˆ–è€…å®‰å…¨è¦æ±‚ä¸èƒ½å¤Ÿä½¿ç”¨å…±äº«æŠ€æœ¯çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸€èˆ¬ä¸ä¼šå‡ºç°åœ¨äº«å…ƒå·¥å‚ä¸­ã€‚</p><h4 id="FlyweightFactory"><a href="#FlyweightFactory" class="headerlink" title="FlyweightFactory"></a>FlyweightFactory</h4><p>äº«å…ƒå·¥å‚ï¼Œæ„é€ ä¸€ä¸ªæ± å®¹å™¨ï¼ŒåŒæ—¶æä¾›ä»æ± ä¸­è·å¾—å¯¹è±¡çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyweightFactory</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, Flyweight&gt; pool = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Flyweight <span class="title">getFlyweight</span><span class="params">(String extrinsic)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        Flyweight flyweight = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(pool.containsKey(extrinsic))&#123;</span><br><span class="line">            flyweight = pool.get(extrinsic);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            flyweight = <span class="keyword">new</span> ConcreteFlyweight1(extrinsic);</span><br><span class="line">            pool.put(extrinsic, flyweight);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flyweight;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>å¯ä»¥å‡å°‘åº”ç”¨ç¨‹åºåˆ›å»ºçš„å¯¹è±¡ï¼Œé™ä½ç¨‹åºå†…å­˜çš„å ç”¨ï¼Œå¢å¼ºç¨‹åºçš„æ€§èƒ½ã€‚</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>æé«˜äº†ç¨‹åºçš„å¤æ‚æ€§ï¼Œéœ€è¦åˆ†ç¦»å‡ºå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œè€Œä¸”å¤–éƒ¨çŠ¶æ€å…·æœ‰å›ºè¯ç‰¹å¾ï¼Œä¸èƒ½éšç€å†…éƒ¨çŠ¶æ€çš„æ”¹å˜è€Œæ”¹å˜ã€‚</p><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><ul><li>çº¿ç¨‹å®‰å…¨çš„é—®é¢˜<br>åˆ›å»ºçš„å¯¹è±¡å°½é‡å¤šï¼Œå¤šåˆ°æ»¡è¶³ä¸šåŠ¡å¯¹è±¡ä¸ºæ­¢ã€‚</li><li>æ€§èƒ½å¹³è¡¡<br>å¤–éƒ¨çŠ¶æ€æœ€å¥½ä»¥åŸºæœ¬ç±»å‹ä¸ºæ ‡å¿—ï¼Œå¦‚String, Intç­‰å¯ä»¥å¤§å¹…æå‡æ•ˆç‡ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> äº«å…ƒæ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é—¨é¢æ¨¡å¼</title>
      <link href="/2020/07/11/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/11/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="é—¨é¢æ¨¡å¼"><a href="#é—¨é¢æ¨¡å¼" class="headerlink" title="é—¨é¢æ¨¡å¼"></a>é—¨é¢æ¨¡å¼</h2><p>é—¨é¢æ¨¡å¼ä¹Ÿå«å¤–è§‚æ¨¡å¼ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>è¦æ±‚ä¸€ä¸ªå­ç³»ç»Ÿçš„å¤–éƒ¨ä¸å…¶å†…éƒ¨çš„é€šä¿¡å¿…é¡»é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å¯¹è±¡è¿›è¡Œã€‚</p><p>å¤–è§‚æ¨¡å¼æä¾›ä¸€ä¸ªé«˜å±‚æ¬¡çš„æ¥å£ï¼Œä½¿å¾—å­ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ã€‚</p><p>é—¨é¢æ¨¡å¼æ³¨é‡è¦æ±‚â€œç»Ÿä¸€çš„å¯¹è±¡â€ï¼Œæä¾›ä¸€ä¸ªè®¿é—®å­ç³»ç»Ÿçš„æ¥å£ï¼Œé™¤äº†è¿™ä¸ªæ¥å£ä¸å…è®¸ä»»ä½•è®¿é—®å­ç³»ç»Ÿçš„è¡Œä¸ºå‘ç”Ÿã€‚</p><p><img src="/2020/07/11/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/facade_class.jpeg" alt="å¤–è§‚æ¨¡å¼"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Subsystem"><a href="#Subsystem" class="headerlink" title="Subsystem"></a>Subsystem</h4><p>å­ç³»ç»Ÿè§’è‰²ï¼Œå¯ä»¥åŒæ—¶æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­ç³»ç»Ÿï¼Œæ¯ä¸€ä¸ªå­ç³»ç»Ÿéƒ½ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»çš„é›†åˆã€‚å­ç³»ç»Ÿå¹¶ä¸çŸ¥é“é—¨é¢çš„å­˜åœ¨ã€‚å¯¹äºå­ç³»ç»Ÿè€Œè¨€ï¼Œé—¨é¢çŸ¥è¯†ä¸€ä¸ªå®¢æˆ·ç«¯è€Œå·²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">classA</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomethingA</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//..logic a</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">classB</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomethingB</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//. logic b</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">classC</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomethingC</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//. logic c.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Facade"><a href="#Facade" class="headerlink" title="Facade"></a>Facade</h4><p>é—¨é¢è§’è‰²ï¼Œå®¢æˆ·ç«¯å¯ä»¥è°ƒç”¨è¿™ä¸ªè§’è‰²çš„æ–¹æ³•ã€‚è¿™ä¸ªè§’è‰²çŸ¥é“å­ç³»ç»Ÿçš„æ‰€æœ‰åŠŸèƒ½å’Œè´£ä»»ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ¬è§’è‰²ä¼šå°†æ‰€æœ‰ä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚å§”æ´¾åˆ°ç›¸åº”çš„å­ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯è¯´æ”¹è§’è‰²æ²¡æœ‰å®é™…çš„ä¸šåŠ¡é€»è¾‘ï¼Œåªæ˜¯ä¸€ä¸ªå§”æ‰˜ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Facade</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> classA a = <span class="keyword">new</span> classA();</span><br><span class="line">    <span class="keyword">private</span> classB b = <span class="keyword">new</span> classB();</span><br><span class="line">    <span class="keyword">private</span> classC c = <span class="keyword">new</span> classC();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.a.doSomethingA();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodB</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.b.doSomethingB();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">methodC</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.c.doSomethingC();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li>å‡å°‘ç³»ç»Ÿçš„ç›¸äº’ä¾èµ–</li><li>æé«˜äº†çµæ´»æ€§</li><li>æé«˜å®‰å…¨æ€§</li></ul><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>ä¸ºä¸€ä¸ªå¤æ‚çš„æ¨¡å—æˆ–è€…å­ç³»ç»Ÿæä¾›ä¸€ä¸ªä¾›å¤–ç•Œè®¿é—®çš„æ¥å£</li><li>å­ç³»ç»Ÿç›¸å¯¹ç‹¬ç«‹</li><li>é¢„é˜²ä½æ°´å¹³äººå‘˜å¸¦æ¥çš„é£é™©æ‰©æ•£</li><li>ä¸€ä¸ªå­ç³»ç»Ÿå¯ä»¥æœ‰å¤šä¸ªé—¨é¢</li><li>é—¨é¢ä¸å‚ä¸å­ç³»ç»Ÿå†…çš„ä¸šåŠ¡é€»è¾‘</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> å¤–è§‚æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é€‚é…å™¨æ¨¡å¼</title>
      <link href="/2020/07/10/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/10/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h2><p>å½“æˆ‘ä»¬å»å›½å¤–æ—…è¡Œæ—¶ï¼Œæˆ‘ä»¬å›½å†…çš„æ’å¤´ä¸èƒ½ç›´æ¥æ’å…¥åˆ°å›½å¤–çš„æ’çº¿æ¿ä¸Šï¼Œæˆ‘ä»¬éœ€è¦è´­ä¹°ä¸€ä¸ªç”µæºé€‚é…å™¨æ¥é€‚é…å›½å¤–çš„æ’çº¿æ¿ã€‚</p><p>æˆ–è€…æœ€æ–°ç‰ˆçš„macbook pro ç”¨çš„æ˜¯utypecï¼Œå¹¶ä¸èƒ½ç›´æ¥æ’å…¥usb3.0çš„uç›˜ï¼Œæˆ‘ä»¬éœ€è¦è´­ä¹°ä¸€ä¸ªé€‚é…å™¨åšè½¬æ¢ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å°†ä¸€ä¸ªç±»çš„æ¥å£ç¼–ç¨‹å®¢æˆ·ç«¯æ‰€æœŸå¾…çš„å¦ä¸€ç§æ¥å£ï¼Œä»è€Œä½¿åŸæœ¬å› æ¥å£ä¸åŒ¹é…è€Œæ— æ³•åœ¨ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»èƒ½å¤Ÿåœ¨ä¸€èµ·å·¥ä½œã€‚</p><p><img src="/2020/07/10/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/adaptor_class.jpeg" alt="é€‚é…å™¨æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h4><p>ç›®æ ‡è§’è‰²æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œæ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„è§’è‰²ï¼Œä¸å¯èƒ½å»ä¿®æ”¹è§’è‰²ä¸­çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Target</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteTarget"><a href="#ConcreteTarget" class="headerlink" title="ConcreteTarget"></a>ConcreteTarget</h4><p>å…·ä½“çš„ç›®æ ‡è§’è‰²å®ç°ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteTarget</span> <span class="keyword">implements</span> <span class="title">Target</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Adaptee"><a href="#Adaptee" class="headerlink" title="Adaptee"></a>Adaptee</h4><p>æºè§’è‰²ï¼Œå·²ç»ä½¿ç”¨ä¸­çš„è§’è‰²ã€‚éœ€è¦å°†Adapteeè½¬æ¢ä¸ºTargetã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adaptee</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Adaptor"><a href="#Adaptor" class="headerlink" title="Adaptor"></a>Adaptor</h4><p>é€‚é…å™¨è§’è‰²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adaptor</span> <span class="keyword">extends</span> <span class="title">Adaptee</span> <span class="keyword">implements</span> <span class="title">Target</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Target target = <span class="keyword">new</span> ConcreteTarget();</span><br><span class="line">target.request();</span><br><span class="line"></span><br><span class="line">Target target2 = <span class="keyword">new</span> Adaptor();</span><br><span class="line">target2.request();</span><br></pre></td></tr></table></figure><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><p>å½“éœ€è¦æŠŠå¤šä¸ªAdapteeè½¬æ¢ä¸ºTargetçš„æ—¶å€™ï¼Œå°±ä¸èƒ½ä½¿ç”¨ç»§æ‰¿äº†ï¼Œå› ä¸ºJavaä¸­ä¸æ”¯æŒå¤šç»§æ‰¿ã€‚<br>è¿™ç§æ–¹å¼å«åšå¯¹è±¡é€‚é…å™¨ã€‚<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨èšåˆï¼ˆå…³è”ï¼‰æ¥å®Œæˆé€‚é…ã€‚</p><p><img src="/2020/07/10/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/adaptor_calss2.jpeg" alt="å¯¹è±¡é€‚é…å™¨ç±»å›¾"></p><p>ç±»é€‚é…å™¨æ˜¯ç”±ç±»çš„ç»§æ‰¿å…³ç³»å®Œæˆçš„ã€‚<br>å¯¹è±¡é€‚é…å™¨æ˜¯ç”±ç±»çš„å…³è”å…³ç³»çºªå¿µæ€§è€¦åˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> é€‚é…å™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¡¥æ¥æ¨¡å¼</title>
      <link href="/2020/07/09/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/09/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¡¥æ¥æ¨¡å¼"><a href="#æ¡¥æ¥æ¨¡å¼" class="headerlink" title="æ¡¥æ¥æ¨¡å¼"></a>æ¡¥æ¥æ¨¡å¼</h2><p>æ¡¥æ¢æ¨¡å¼çš„é‡ç‚¹åœ¨è§£è€¦ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å°†æŠ½è±¡å’Œå®ç°è§£è€¦ï¼Œä½¿å¾—ä¸¤è€…å¯ä»¥ç‹¬ç«‹çš„å˜åŒ–ã€‚<br>å®ƒä½¿ç”¨äº†ç±»é—´çš„èšåˆå…³ç³»ã€ç»§æ‰¿ã€è¦†å†™ç­‰å¸¸ç”¨åŠŸèƒ½ã€‚è§£å†³äº†ç»§æ‰¿çš„ç¼ºç‚¹è€Œæå‡ºçš„è®¾è®¡æ¨¡å¼ã€‚</p><p><img src="/2020/07/09/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/bridge_class.jpeg" alt="æ¡¥æ¥æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>æŠ½è±¡è§’è‰²å¼•ç”¨å®ç°è§’è‰²ï¼Œæˆ–è€…è¯´æŠ½è±¡è§’è‰²çš„éƒ¨åˆ†å®ç°æ˜¯ç”±å®ç°è§’è‰²å®Œæˆçš„ã€‚</p><h4 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h4><p>æŠ½è±¡åŒ–è§’è‰²ï¼Œå®šä¹‰å‡ºè¯¥æŠ½è±¡è§’è‰²çš„è¡Œä¸ºï¼ŒåŒæ—¶ä¿å­˜ä¸€ä¸ªå¯¹å®ç°åŒ–è§’è‰²çš„å¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Abstraction</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Implementor imp;</span><br><span class="line">    <span class="comment">//å¿…é¡»æŒ‡å®šå®ç°è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Abstraction</span><span class="params">(Implementor imp)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.imp = imp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.imp.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Implementor <span class="title">getImp</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="RefindAbstraction"><a href="#RefindAbstraction" class="headerlink" title="RefindAbstraction"></a>RefindAbstraction</h4><p>ä¿®æ­£æŠ½è±¡åŒ–è§’è‰²ï¼Œå¼•ç”¨å®ç°åŒ–è§’è‰²å¯¹æŠ½è±¡åŒ–è§’è‰²è¿›è¡Œä¿®æ­£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RefindAbstraction</span> <span class="keyword">extends</span> <span class="title">Abstraction</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RefindAbstraction</span><span class="params">(Implementor imp)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(imp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">//....</span></span><br><span class="line">      <span class="keyword">super</span>.request();</span><br><span class="line">      <span class="keyword">super</span>.getImp().doAnyThing();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Implementor"><a href="#Implementor" class="headerlink" title="Implementor"></a>Implementor</h4><p>å®ç°åŒ–è§’è‰²ï¼Œæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå®šä¹‰è§’è‰²å¿…é¡»çš„è¡Œä¸ºå’Œå±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Implementor</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAnyThing</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteImplementor"><a href="#ConcreteImplementor" class="headerlink" title="ConcreteImplementor"></a>ConcreteImplementor</h4><p>å…·ä½“å®ç°åŒ–è§’è‰²ï¼Œå®ç°æ¥å£æˆ–è€…æŠ½è±¡ç±»å®šä¹‰çš„æ–¹æ³•å’Œå±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteImplementor1</span> <span class="keyword">implements</span> <span class="title">Implementor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAnyThing</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteImplementor2</span> <span class="keyword">implements</span> <span class="title">Implementor</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAnyThing</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Implementor imp = <span class="keyword">new</span> ConcreteImplementor1();</span><br><span class="line">Abstraction abs = <span class="keyword">new</span> RefindAbstraction(imp);</span><br><span class="line">abs.request();</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li><p>æŠ½è±¡å’Œå®ç°åˆ†ç¦»<br>ä¸ºäº†è§£å†³ç»§æ‰¿çš„ç¼ºç‚¹è€Œæå‡ºçš„è®¾è®¡æ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œå®ç°å¯ä»¥ä¸å—æŠ½è±¡çš„çº¦æŸï¼Œä¸å†ç»‘å®šåˆ°å›ºå®šçš„æŠ½è±¡å±‚æ¬¡ä¸Šã€‚</p></li><li><p>ä¼˜ç§€çš„æ‰©å±•èƒ½åŠ›</p></li></ul><p>å¯ä»¥éšæ„å¢åŠ æŠ½è±¡å’Œå®ç°ã€‚</p><ul><li>å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜</li></ul><p>ç”±æŠ½è±¡å±‚é€šè¿‡èšåˆå…³ç³»å®Œæˆäº†å°è£…ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>ä¸å¸Œæœ›æˆ–è€…ä¸é€‚ç”¨ä½¿ç”¨ç»§æ‰¿çš„åœºæ™¯<br>ç»§æ‰¿å±‚æ¬¡å¤ªé«˜ï¼Œæ— æ³•æ›´ç»†åŒ–è®¾è®¡é¢—ç²’ç­‰åœºæ™¯ï¼Œéœ€è¦è€ƒè™‘ä½¿ç”¨ã€‚</li><li>æ¥å£æˆ–è€…æŠ½è±¡ç±»ä¸ç¨³å®šçš„åœºæ™¯<br>æ¥å£æˆ–è€…æŠ½è±¡ç±»ä¸ç¨³å®šï¼Œç»å¸¸å˜æ›´æ—¶ï¼Œä½¿ç”¨æ¡¥æ¢æ¨¡å¼ã€‚</li><li>é‡ç”¨å‹è¦æ±‚é«˜çš„åœºæ™¯<br>è®¾è®¡çš„é¢—ç²’åº¦ç²¤è¥¿ï¼Œè¢«é‡ç”¨çš„å¯èƒ½æ€§è¶Šå¤§ã€‚<br>é‡‡ç”¨ç»§æ‰¿å—åˆ°çˆ¶ç±»çš„é™åˆ¶ï¼Œä¸å¯èƒ½å‡ºç°å¤ªç»†çš„ç²’åº¦ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> æ¡¥æ¥æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è£…é¥°å™¨æ¨¡å¼</title>
      <link href="/2020/07/08/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/08/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è£…é¥°å™¨æ¨¡å¼"><a href="#è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="è£…é¥°å™¨æ¨¡å¼"></a>è£…é¥°å™¨æ¨¡å¼</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°å™¨æ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»ã€‚</p><p><img src="/2020/07/08/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/decorator_class.jpeg" alt="è£…é¥°å™¨æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h4><p>Component æ˜¯ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå®šä¹‰éœ€è¦è¢«è£…é¥°çš„åŸå§‹ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Concrete-Component"><a href="#Concrete-Component" class="headerlink" title="Concrete Component"></a>Concrete Component</h4><p>Component çš„å®ç°ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteComponent</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">//....</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Decorator"><a href="#Decorator" class="headerlink" title="Decorator"></a>Decorator</h4><p>æŠ½è±¡ç±»ï¼Œç”¨äºå®ç°æ¥å£æˆ–è€…æŠ½è±¡æ–¹æ³•ã€‚åŒ…å«è¢«ä¿®é¥°çš„Componnetå±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Decorator</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Component component = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Decorator</span><span class="params">(Component c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.component = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.component.operate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Concrete-Decorator"><a href="#Concrete-Decorator" class="headerlink" title="Concrete Decorator"></a>Concrete Decorator</h4><p>å…·ä½“è£…é¥°è§’è‰²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteDecorator1</span> <span class="keyword">extends</span> <span class="title">Decorator</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteDecorator1</span><span class="params">(Component component)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(component);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.method1();</span><br><span class="line">       <span class="keyword">super</span>.operate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteDecorator2</span> <span class="keyword">extends</span> <span class="title">Decorator</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteDecorator2</span><span class="params">(Component component)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(component);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operate</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.operate();</span><br><span class="line">       <span class="keyword">this</span>.method2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Component c = <span class="keyword">new</span> ConcreteComponent();</span><br><span class="line">c = <span class="keyword">new</span> ConcreteDecorator1(c);</span><br><span class="line">c = <span class="keyword">new</span> ConcreteDecorator2(c);</span><br><span class="line">c.operate();</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>è£…é¥°ç±»å’Œè¢«è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å‘å±•ï¼Œè€Œä¸ä¼šç›¸äº’è€¦åˆã€‚<br>è£…é¥°æ¨¡å¼æ˜¯ç»§æ‰¿å…³ç³»çš„ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆã€‚<br>è£…é¥°æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½ã€‚</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>å½“è£…é¥°å¤šå±‚æ—¶å¯¼è‡´ç³»ç»Ÿå¤æ‚åº¦é«˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> ä»£ç†æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§‚å¯Ÿè€…æ¨¡å¼</title>
      <link href="/2020/07/07/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/07/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><p>è§‚å¯Ÿè€…æ¨¡å¼ä¹Ÿå«å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ï¼Œåˆ™æ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥å¹¶ä¸”è¢«è‡ªåŠ¨æ›´æ–°ã€‚</p><p><img src="/2020/07/07/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/observer_class.jpeg" alt="è§‚å¯Ÿè€…æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Subject"><a href="#Subject" class="headerlink" title="Subject"></a>Subject</h4><p>å®šä¹‰è¢«è§‚å¯Ÿè€…å¿…é¡»å®ç°çš„èŒè´£ï¼Œå¿…é¡»èƒ½å¤ŸåŠ¨æ€çš„å¢åŠ ã€å–æ¶ˆè§‚å¯Ÿè€…ã€‚<br>å®ƒä¸€èˆ¬æ˜¯æŠ½è±¡ç±»æˆ–è€…å®ç°ç±»ï¼Œä»…ä»…å®Œæˆä½œä¸ºè¢«è§‚å¯Ÿè€…å¿…é¡»å®ç°çš„èŒè´£ï¼Œç®¡ç†è§‚å¯Ÿè€…å¹¶é€šçŸ¥è§‚å¯Ÿè€…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Vector&lt;Observer&gt; obsVector = <span class="keyword">new</span> Vector&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addObserver</span><span class="params">(Observer o)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obsVector.add(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delObserver</span><span class="params">(Observer o)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.obsVector.remove(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notifyObservers</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(Observer o : <span class="keyword">this</span>.obsVector)&#123;</span><br><span class="line">            o.update();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteSubject"><a href="#ConcreteSubject" class="headerlink" title="ConcreteSubject"></a>ConcreteSubject</h4><p>å…·ä½“çš„è¢«è§‚å¯Ÿè€…ï¼Œå®šä¹‰è¢«è§‚å¯Ÿè€…è‡ªå·±çš„ä¸šåŠ¡ï¼ŒåŒæ—¶å®šä¹‰å¯¹å“ªäº›äº‹ä»¶è¿›è¡Œé€šçŸ¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteSubject</span> <span class="keyword">extends</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBusiness</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="keyword">super</span>.notifyObservers();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h4><p>è§‚å¯Ÿè€…æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå¯¹æ¥æ”¶åˆ°çš„ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteObserver"><a href="#ConcreteObserver" class="headerlink" title="ConcreteObserver"></a>ConcreteObserver</h4><p>å…·ä½“çš„è§‚å¯Ÿè€…ï¼Œä¸åŒçš„è§‚å¯Ÿè€…åœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™çš„å…·ä½“å®šä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something when invoked.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ConcreteSubject subject = <span class="keyword">new</span> ConcreteSubject();</span><br><span class="line">Observer obs = <span class="keyword">new</span> ConcreteObserver();</span><br><span class="line">subject.addObserver(obs);</span><br><span class="line">subject.doBusiness();</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li>è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆ<br>å¦‚è®ºå¢åŠ è§‚å¯Ÿè€…è¿˜æ˜¯è¢«è§‚å¯Ÿè€…éƒ½éå¸¸å®¹æ˜“æ‰©å±•</li><li>å»ºç«‹äº†ä¸€å¥—è§„åˆ™çš„è§¦å‘æœºåˆ¶</li></ul><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>æ•ˆç‡ç¼ºé™·ï¼Œè€ƒè™‘é‡‡ç”¨å¼‚æ­¥æ–¹å¼é€šçŸ¥ã€‚</p><p>å¹¿æ’­é“¾çš„é—®é¢˜ A -&gt; B -&gt; C</p><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><h4 id="Javaä¸­çš„è§‚å¯Ÿè€…"><a href="#Javaä¸­çš„è§‚å¯Ÿè€…" class="headerlink" title="Javaä¸­çš„è§‚å¯Ÿè€…"></a>Javaä¸­çš„è§‚å¯Ÿè€…</h4><p>java æä¾›äº†java.util.Observeræ¥å£ å’Œ java.util.Observable ç±»ã€‚<br>è¢«è§‚å¯Ÿè€…ç»§æ‰¿java.util.Observableï¼Œ è§‚å¯Ÿè€…å®ç°java.util.Observer.<br>ä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è€ƒè™‘åˆ°æ€§èƒ½ä¸€èˆ¬ä¸ä¼šç”¨è¿™ç§æ–¹å¼æ¥å®ç°ã€‚</p><h4 id="ç”Ÿäº§ä¸­çš„è§‚å¯Ÿè€…"><a href="#ç”Ÿäº§ä¸­çš„è§‚å¯Ÿè€…" class="headerlink" title="ç”Ÿäº§ä¸­çš„è§‚å¯Ÿè€…"></a>ç”Ÿäº§ä¸­çš„è§‚å¯Ÿè€…</h4><p>ä¸€èˆ¬ä½¿ç”¨MQæ¥å¼‚æ­¥å¤„ç†<br>æœ¬åœ°çš„å¦‚Disruptor</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è§‚å¯Ÿè€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring IOC And DI</title>
      <link href="/2020/07/06/Spring-IOC-And-DI/"/>
      <url>/2020/07/06/Spring-IOC-And-DI/</url>
      
        <content type="html"><![CDATA[<h2 id="IOC-ç®€å²"><a href="#IOC-ç®€å²" class="headerlink" title="IOC ç®€å²"></a>IOC ç®€å²</h2><ul><li>1983å¹´ï¼ŒRichard E.Sweet åœ¨&lt;<The mesa programming enviroment>&gt;æå‡ºå¥½è±ååŸåˆ™ï¼ˆâ€œä¸è¦æ‰“ç”µè¯ç»™æˆ‘ï¼Œæˆ‘ä¼šæ‰“ç”µè¯ç»™ä½ â€ï¼‰ã€‚</The></li><li>1988å¹´ï¼ŒRolph E.Johnson å’ŒBrian Footeåœ¨ã€ŠDesigning Reusable Classesã€‹ä¸­æå‡ºæ§åˆ¶åè½¬ã€‚</li><li>1996å¹´ï¼ŒMichael Mattsonåœ¨ã€ŠObject-Oriented Frameworks, A survey of methodological issuesã€‹å°†æ§åˆ¶åè½¬å‘½åä¸ºå¥½è±ååŸåˆ™ã€‚</li><li>2004ï¼ŒMartin Fowleråœ¨ã€ŠInversion Of Control Containers and the Dependency Injection patternã€‹æå‡ºè‡ªå·±å¯¹å’ŒIOCå’ŒDIçš„ç†è§£</li><li>2005å¹´ï¼ŒMartin Foloweråœ¨ã€ŠInversion Of Controlã€‹ä¸­å¯¹IOCè¿›ä¸€æ­¥è¯´æ˜ã€‚</li><li><a href="https://www.martinfowler.com/articles/injection.html" target="_blank" rel="noopener">Martin å¤§çˆ·å…³äºIOCçš„è¯´æ˜</a></li></ul><h2 id="IOC-çš„å®ç°ç­–ç•¥"><a href="#IOC-çš„å®ç°ç­–ç•¥" class="headerlink" title="IOC çš„å®ç°ç­–ç•¥"></a>IOC çš„å®ç°ç­–ç•¥</h2><p>WIKI:</p><p> In object-oriented programming, there are several basic techniques to implement inversion of control. there are:</p><ul><li>Using a service locator pattern</li><li>Using dependency injection<ul><li>constructor  injection</li><li>parameter injection</li><li>setter injection</li><li>interface injection</li></ul></li><li>Using a contextualized lookup.</li><li>Using template method design pattern</li><li>Using Strategy design pattern.</li></ul><p>EXPERT ONE-ON-ONE J2EE DEVELOPMENT without EJBæåˆ°çš„ç­–ç•¥ï¼š</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Spring </tag>
            
            <tag> IOC </tag>
            
            <tag> DI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­ä»‹è€…æ¨¡å¼</title>
      <link href="/2020/07/06/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/06/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h2><p>ä¸»è¦ä¸ºäº†é™ä½æ¨¡å—å†…éƒ¨ä¹‹é—´ç±»çš„ç›¸äº’å¼•ç”¨ï¼Œé˜²æ­¢å‡ºç°ç³»ç»Ÿæˆ–è€…æ¨¡å—å†…éƒ¨è¿‡åº¦è€¦åˆã€‚</p><p>ä¸­ä»‹è€…æ¨¡å¼ä¹Ÿå«è°ƒåœè€…æ¨¡å¼ï¼Œä¸€ä¸ªå¯¹è±¡è¦å’ŒNä¸ªå¯¹è±¡äº¤æµç‰¹åˆ«æ··ä¹±ï¼Œè¿™ä¸ªæ—¶å€™åŠ å…¥ä¸€ä¸ªä¸­å¿ƒï¼Œæ‰€æœ‰çš„ç±»éƒ½å’Œä¸­å¿ƒäº¤æµï¼Œè¿™æ ·å°±å˜æˆäº†æ˜Ÿå‹æ‹“æ‰‘ç»“æ„ã€‚</p><p><img src="/2020/07/06/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/star_class.jpeg" alt="æ˜Ÿå‹æ‹“æ‰‘ç»“æ„"></p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡å°è£…ä¸€äº›åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾ç¤ºåœ°ç›¸äº’è°ƒç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p><p><img src="/2020/07/06/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/mediator_class.jpeg" alt="ä¸­ä»‹è€…æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Mediator"><a href="#Mediator" class="headerlink" title="Mediator"></a>Mediator</h4><p>æŠ½è±¡ä¸­ä»‹è€…è§’è‰²ï¼Œå®šä¹‰ç»Ÿä¸€çš„æ¥å£ï¼Œç”¨äºå„åŒäº‹è§’è‰²ä¹‹é—´çš„é€šä¿¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> ConcreteColleague1 c1;</span><br><span class="line">    <span class="keyword">protected</span> ConcreteColleague2 c2;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ConcreteColleague1 <span class="title">getC1</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> c1;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ConcreteColleague2 <span class="title">getC2</span><span class="params">()</span></span>&#123; <span class="keyword">return</span> c2;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC1</span><span class="params">(ConcreteColleague1 c1)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.c1 = c1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setC2</span><span class="params">(ConcreteColleague2 c2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.c2 = c2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doSomething1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doSomething2</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Concrete-Mediator"><a href="#Concrete-Mediator" class="headerlink" title="Concrete Mediator"></a>Concrete Mediator</h4><p>å…·ä½“ä¸­ä»‹è€…è§’è‰²é€šè¿‡åè°ƒå„åŒäº‹è§’è‰²å®ç°åä½œè¡Œä¸ºï¼Œå› ä¸ºå®ƒå¿…é¡»ä¾èµ–äºå„ä¸ªåŒäº‹è§’è‰²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteMediator</span> <span class="keyword">extends</span> <span class="title">Mediator</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.c1.selfMethod1();</span><br><span class="line">        <span class="keyword">super</span>.c2.selfMethod2();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.c1.selfMethod1();</span><br><span class="line">        <span class="keyword">super</span>.c2.selfMethod2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Colleague"><a href="#Colleague" class="headerlink" title="Colleague"></a>Colleague</h4><p>åŒäº‹è§’è‰²ï¼Œæ¯ä¸ªåŒäº‹è§’è‰²éƒ½çŸ¥é“ä¸­ä»‹è€…è§’è‰²ï¼Œè€Œä¸”ä¸å…¶ä»–åŒäº‹è§’è‰²é€šä¿¡æ—¶ï¼Œä¸€å®šè¦é€šè¿‡ä¸­ä»‹è€…è§’è‰²åä½œã€‚<br>ä¸€ç§æ˜¯åŒäº‹æœ¬èº«çš„è¡Œä¸ºå«è‡ªå‘è¡Œä¸ºï¼Œæ¯”å¦‚æ”¹å˜å¯¹è±¡æœ¬èº«çš„çŠ¶æ€ï¼Œå¤„ç†è‡ªå·±çš„è¡Œä¸ºï¼Œä¸å…¶ä»–åŒäº‹ç±»æˆ–è€…ä¸­ä»‹è€…<br>ç¬¬äºŒç§æ˜¯ä¾èµ–è¡Œä¸ºï¼Œå¿…é¡»ä¾èµ–ä¸­ä»‹è€…æ‰èƒ½å®Œæˆçš„è¡Œä¸ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Colleague</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Mediator mediator;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Colleague</span><span class="params">(Mediator mediator)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteColleague1</span> <span class="keyword">extends</span> <span class="title">Colleague</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteColleague1</span><span class="params">(Mediator mediator)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selfMethod1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depMethod1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.mediator.doSomething1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteColleague2</span> <span class="keyword">extends</span> <span class="title">Colleague</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteColleague2</span><span class="params">(Mediator mediator)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selfMethod1</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">depMethod1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.mediator.doSomething1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>å‡å°‘ç±»ä¹‹é—´çš„ä¾èµ–ï¼ŒæŠŠåŸæœ‰çš„ä¸€å¯¹å¤šçš„ä¾èµ–å˜æˆäº†ä¸€å¯¹ä¸€çš„ä¾èµ–ï¼ŒåŒäº‹ç±»åªä¾èµ–ä¸­ä»‹è€…ï¼Œå‡å°‘äº†ä¾èµ–ï¼ŒåŒæ—¶é™ä½äº†ç±»ä¹‹é—´çš„è€¦åˆã€‚</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>ä¸­ä»‹è€…æ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸­ä»‹è€…ä¼šè†¨èƒ€ï¼Œè€Œä¸”é€»è¾‘å¤æ‚ï¼ŒåŸæœ¬Nä¸ªå¯¹è±¡ç›´æ¥çš„ç›¸äº’ä¾èµ–å…³ç³»è½¬æ¢ä¸ºä¸­ä»‹è€…å’ŒåŒäº‹ç±»çš„ä¾èµ–å…³ç³»ï¼ŒåŒäº‹ç±»è¶Šå¤šï¼Œä¸­ä»‹è€…çš„é€»è¾‘å°±è¶Šå¤æ‚ã€‚</p><h3 id="åº”ç”¨-1"><a href="#åº”ç”¨-1" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="æœºåœºè°ƒåº¦ä¸­å¿ƒ"><a href="#æœºåœºè°ƒåº¦ä¸­å¿ƒ" class="headerlink" title="æœºåœºè°ƒåº¦ä¸­å¿ƒ"></a>æœºåœºè°ƒåº¦ä¸­å¿ƒ</h4><p>æ¯ä¸€æ¶é£æœºéƒ½å’Œæœºåœºè°ƒåº¦ä¸­å¿ƒä¿æŒè”ç³»ã€‚</p><h4 id="MVCæ¡†æ¶"><a href="#MVCæ¡†æ¶" class="headerlink" title="MVCæ¡†æ¶"></a>MVCæ¡†æ¶</h4><p>Controlleråšä¸ºä¸€ä¸ªä¸­ä»‹è€…ï¼ŒæŠŠModelå’ŒViewéš”ç¦»å¼€ï¼Œåè°ƒMVååŒå·¥ä½œï¼ŒæŠŠMè¿è¡Œçš„ç»“æœå’ŒVä»£è¡¨çš„è§†å›¾èåˆæˆä¸€ä¸ªå‰ç«¯å¯ä»¥å±•ç¤ºçš„é¡µé¢ï¼Œå‡å°‘MVçš„ä¾èµ–å…³ç³»ã€‚</p><h4 id="åª’ä½“ç½‘å…³"><a href="#åª’ä½“ç½‘å…³" class="headerlink" title="åª’ä½“ç½‘å…³"></a>åª’ä½“ç½‘å…³</h4><h4 id="ä¸­ä»‹æœåŠ¡"><a href="#ä¸­ä»‹æœåŠ¡" class="headerlink" title="ä¸­ä»‹æœåŠ¡"></a>ä¸­ä»‹æœåŠ¡</h4>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> ä¸­ä»‹è€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç©ºå¯¹è±¡æ¨¡å¼</title>
      <link href="/2020/07/06/%E7%A9%BA%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/06/%E7%A9%BA%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="ç©ºå¯¹è±¡æ¨¡å¼"><a href="#ç©ºå¯¹è±¡æ¨¡å¼" class="headerlink" title="ç©ºå¯¹è±¡æ¨¡å¼"></a>ç©ºå¯¹è±¡æ¨¡å¼</h2><p>ç©ºå¯¹è±¡æ¨¡å¼æ—¶é€šè¿‡ç©ºä»£ç å®ç°ä¸€ä¸ªæ¥å£æˆ–è€…æŠ½è±¡ç±»çš„æ‰€æœ‰æ–¹æ³•ï¼Œä»¥æ»¡è¶³å¼€å‘éœ€æ±‚ï¼Œç®€åŒ–ç¨‹åºã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>é€šè¿‡å®ç°ä¸€ä¸ªé»˜è®¤æ— æ„ä¹‰çš„å¯¹è±¡æ¥é¿å…nullå€¼çš„å‡ºç°ã€‚ä¸ºäº†é¿å…ç¨‹åºä¸­å‡ºç°åˆ¤æ–­nullçš„æƒ…å†µè€Œäº§ç”Ÿçš„ã€‚</p><p><img src="/2020/07/06/%E7%A9%BA%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%BC%8F/null_Object" alt="ç©ºå¯¹è±¡æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeSound</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">implements</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeSound</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Wang..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NullAnimal</span> <span class="title">import</span>  <span class="title">Animal</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeSound</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è§£é‡Šå™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é‡Šå™¨æ¨¡å¼</title>
      <link href="/2020/07/05/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/05/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è§£é‡Šå™¨æ¨¡å¼"><a href="#è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼"></a>è§£é‡Šå™¨æ¨¡å¼</h2><p>è§£é‡Šå™¨æ¨¡å¼æ˜¯ä¸€ç§æŒ‰ç…§è§„å®šè¯­æ³•è¿›è¡Œè§£æçš„æ–¹æ¡ˆã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç»™ä¸€é—¨è¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶ä¸”å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</p><p>æ¯”å¦‚Javaè¯­è¨€ï¼Œå®šä¹‰æ–‡æ³•çš„è¡¨ç¤ºæ˜¯Javaçš„è¯­æ³•ã€‚<br>javacç¼–è¯‘å™¨çœ‹ä½œæ˜¯è§£é‡Šå™¨ï¼Œè§£é‡Šå™¨ç”¨æ¥å°†Javaâ€œè§£é‡Šä¸ºâ€ .class æ ¼å¼çš„æ–‡ä»¶ã€‚</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="AbstractExpression"><a href="#AbstractExpression" class="headerlink" title="AbstractExpression"></a>AbstractExpression</h4><p>æŠ½è±¡è§£é‡Šå™¨ï¼ŒæŠ½è±¡è§£é‡Šå™¨é€šå¸¸åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œ æ˜¯ç”Ÿæˆè¯­æ³•é›†åˆçš„å…³é”®ï¼Œæ¯ä¸ªè¯­æ³•é›†åˆå®ŒæˆæŒ‡å®šè¯­æ³•çš„è§£æä»»åŠ¡ï¼Œé€šè¿‡é€’å½’è°ƒç”¨çš„æ–¹å¼ï¼Œæœ€ç»ˆç”±æœ€å°çš„è¯­æ³•ä½†æ„¿è¿›è¡Œè§£æå®Œæˆã€‚<br>å…·ä½“çš„è§£é‡Šä»»åŠ¡ç”±å„ä¸ªå®ç°ç±»å®Œæˆã€‚å…·ä½“çš„è§£é‡Šå™¨åˆ†åˆ«ç”±TerminalExpressionå’ŒNon-terminalExpressionå®Œæˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£æå…¬å¼å’Œæ•°å€¼ï¼Œå…¶ä¸­varä¸­çš„keyæ˜¯å…¬å¼ä¸­çš„å‚æ•°ï¼Œvalueå€¼æ˜¯å…·ä½“çš„æ•°å­—ã€‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> var</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(HashMap&lt;String,Integer&gt; <span class="keyword">var</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="TerminalExpression"><a href="#TerminalExpression" class="headerlink" title="TerminalExpression"></a>TerminalExpression</h4><p>ç»ˆç»“ç¬¦è¡¨è¾¾å¼<br>å®ç°ä¸æ–‡æ³•ä¸­çš„å…ƒç´ ç›¸å…³è”çš„è§£é‡Šæ“ä½œï¼Œé€šå¸¸ä¸€ä¸ªè§£é‡Šå™¨æ¨¡å¼ä¸­åªæœ‰ä¸€ä¸ªç»ˆç»“ç¬¦çš„è¡¨è¾¾å¼ï¼Œä½†æ˜¯æœ‰å¤šä¸ªå®ä¾‹ï¼Œå¯¹åº”ä¸åŒçš„ç»ˆç»“ç¬¦ã€‚è¡¨è¾¾å¼ä¸­æ¯ä¸ªç»ˆç»“ç¬¦éƒ½åœ¨æ ˆä¸­äº§ç”Ÿäº†ä¸€ä¸ªvarExpressionã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VarExpression</span> <span class="keyword">extends</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String key;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VarExpression</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(HashMap&lt;String, Integer&gt; <span class="keyword">var</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">var</span>.get(<span class="keyword">this</span>.key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="NoneTerminalExpression"><a href="#NoneTerminalExpression" class="headerlink" title="NoneTerminalExpression"></a>NoneTerminalExpression</h4><p>éç»ˆç»“ç¬¦è¡¨è¾¾å¼<br>æ–‡æ³•ä¸­æ¯æ¡è§„åˆ™éƒ½å¯¹åº”ä¸€ä¸ªéç»ˆç»“è¡¨è¾¾å¼ï¼Œå…·ä½“åˆ°æˆ‘ä»¬çš„ä¾‹å­å°±æ˜¯åŠ å‡æ³•è§„åˆ™åˆ†åˆ«å¯¹åº”åˆ°AddExpressionå’ŒSubExpressionä¸¤ä¸ªç±»ï¼Œéç»ˆç»“è¡¨è¾¾å¼æ ¹æ®é€»è¾‘çš„å¤æ‚ç¨‹åº¦è€Œå¢åŠ ï¼ŒåŸåˆ™ä¸Šæ¯ä¸ªæ–‡æ³•è§„åˆ™éƒ½å¯¹åº”ä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">SymbolExpression</span> <span class="keyword">extends</span> <span class="title">Expression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span>  Expression left;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span>  Expression right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SymbolExpression</span><span class="params">(Expression left, Expression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AddExpression</span> <span class="keyword">extends</span> <span class="title">SymbolExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AddExpression</span><span class="params">(Expression left, Expression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(left, right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(HashMap&lt;String, Integer&gt; <span class="keyword">var</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.left.interpreter(<span class="keyword">var</span>) + <span class="keyword">super</span>.right.interpreter(<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubExpression</span> <span class="keyword">extends</span> <span class="title">SymbolExpression</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SubExpression</span><span class="params">(Expression left, Expression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(left, right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpreter</span><span class="params">(HashMap&lt;String, Integer&gt; <span class="keyword">var</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.left.interpreter(<span class="keyword">var</span>) - <span class="keyword">super</span>.right.interpreter(<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h4><p>ç¯å¢ƒè§’è‰²ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Calculator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Expression expression;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Calculator</span><span class="params">(String expStr)</span> </span>&#123;</span><br><span class="line">        Stack&lt;Expression&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        <span class="keyword">char</span>[] charArray = expStr.toCharArray();</span><br><span class="line"></span><br><span class="line">        Expression left = <span class="keyword">null</span>;</span><br><span class="line">        Expression right = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; charArray.length; i++) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (charArray[i]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">                    left = stack.pop();</span><br><span class="line">                    right = <span class="keyword">new</span> VarExpression(String.valueOf(charArray[++i]));</span><br><span class="line">                    stack.push(<span class="keyword">new</span> AddExpression(left, right));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">                    left = stack.pop();</span><br><span class="line">                    right = <span class="keyword">new</span> VarExpression(String.valueOf(charArray[++i]));</span><br><span class="line">                    stack.push(<span class="keyword">new</span> SubExpression(left, right));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    stack.push(<span class="keyword">new</span> VarExpression(String.valueOf(charArray[i])));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.expression = stack.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">run</span><span class="params">(HashMap&lt;String, Integer&gt; <span class="keyword">var</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.expression.interpreter(<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    String expStr = getExpStr();</span><br><span class="line">    HashMap&lt;String, Integer&gt; <span class="keyword">var</span> = getValue(expStr);</span><br><span class="line">    Calculator calculator = <span class="keyword">new</span> Calculator(expStr);</span><br><span class="line">    System.out.println(calculator.run(<span class="keyword">var</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, Integer&gt; <span class="title">getValue</span><span class="params">(String expStr)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    HashMap&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c : expStr.toCharArray()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c != <span class="string">'+'</span> &amp; c != <span class="string">'-'</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(String.valueOf(c))) &#123;</span><br><span class="line">                String in = (<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in))).readLine();</span><br><span class="line">                map.put(String.valueOf(c), Integer.valueOf(in));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getExpStr</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Input Expression"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in)).readLine();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>æ‰©å±•æ€§è‰¯å¥½ï¼Œä¿®æ”¹è¯­æ³•è§„åˆ™åªéœ€è¦ä¿®æ”¹ç›¸åº”çš„éç»ˆç»“ç¬¦è¡¨è¾¾å¼å°±å¯ä»¥äº†ã€‚<br>å¦‚æœæ‰©å±•è¯­æ³•ï¼Œåˆ™åªè¦å¢åŠ éç»ˆç»“ç¬¦ç±»å°±å¯ä»¥äº†ã€‚</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>è§£é‡Šå™¨æ¨¡å¼ä¼šå¼•èµ·ç±»è†¨èƒ€ï¼Œæ¯ä¸ªè¯­æ³•éƒ½è¦äº§ç”Ÿä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œè¯­æ³•è§„åˆ™æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå°±å¯ä»¥èƒ½äº§ç”Ÿå¤§é‡çš„ç±»æ–‡ä»¶ã€‚<br>è§£é‡Šå™¨æ¨¡å¼é‡‡ç”¨é€’å½’è°ƒç”¨æ–¹å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼éœ€è¦çŸ¥é“æœ€ç»ˆçš„ç»“æœï¼Œå¿…é¡»ä¸€å±‚å±‚é€’å½’ï¼Œæ— è®ºæ˜¯é¢å‘å¯¹è±¡è¿˜æ˜¯é¢å‘è¿‡ç¨‹ï¼Œé€’å½’éƒ½æ˜¯åœ¨å¿…è¦æ¡ä»¶ä¸‹æ‰ä½¿ç”¨ï¼Œå¯¼è‡´è°ƒè¯•å¤æ‚ã€‚</p><p>æ•ˆç‡é—®é¢˜ï¼Œè§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨å¤§é‡çš„å¾ªç¯å’Œé€’å½’ï¼Œæ•ˆç‡æ—¶ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><p>é‡å¤å‘ç”Ÿçš„é—®é¢˜å¯ä»¥è§£é‡Šå™¨æ¨¡å¼ï¼Œå¤šä¸ªåº”ç”¨æœåŠ¡å™¨ï¼Œæ¯å¤©äº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œéœ€è¦å¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œåˆ†æå¤„ç†ï¼Œç”±äºå„ä¸ªæœåŠ¡å™¨çš„æ—¥å¿—æ ¼å¼ä¸åŒï¼Œä½†æ˜¯æ•°æ®è¦ç´ ç›¸åŒï¼ŒæŒ‰ç…§è§£é‡Šå™¨æ¨¡å¼ç»ˆç»“ç¬¦è¡¨è¾¾å¼ç›¸åŒï¼Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼éœ€è¦å®šåˆ¶ã€‚</p><p>ä¸€ä¸ªç®€å•è¯­æ³•éœ€è¦è§£é‡Šçš„åœºæ™¯ï¼Œè§£é‡Šå™¨æ¨¡å¼ä¸€èˆ¬ç”¨æ¥è§£æè¡¨æ ‡å‡†çš„å­—ç¬¦é›†ï¼Œå¦‚SQLè¯­æ³•åˆ†æã€‚</p><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>å°½é‡ä¸è¦åœ¨é‡è¦çš„æ¨¡å—ä¸­ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼ï¼Œç»´æŠ¤æˆæœ¬å¤ªé«˜ã€‚å°½é‡ä½¿ç”¨shellã€JRubyã€Groovyæ¥æ›¿ä»£ã€‚</p><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><p>æˆç†Ÿçš„å·¥å…·<br>Expression4J<br>MESP: Math Expression String Parserã€<br>Jep.</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è§£é‡Šå™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤‡å¿˜å½•æ¨¡å¼</title>
      <link href="/2020/07/04/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/04/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="å¤‡å¿˜å½•æ¨¡å¼"><a href="#å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼"></a>å¤‡å¿˜å½•æ¨¡å¼</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥çŠ¶æ€ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚<br>è¿™æ ·ä»¥åå°±å¯ä»¥å°†è¯¥çŠ¶æ€æ¢å¤åˆ°åŸæ¥ä¿å­˜çš„çŠ¶æ€ã€‚</p><p><img src="/2020/07/04/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/memento.jpeg" alt="å¤‡å¿˜å½•æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Originator"><a href="#Originator" class="headerlink" title="Originator"></a>Originator</h4><p>å‘èµ·äººè§’è‰²ï¼Œè®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ï¼Œè´Ÿè´£å®šä¹‰å“ªäº›å±æ€§å¤‡ä»½èŒƒå›´çš„çŠ¶æ€ï¼Œè´Ÿè´£åˆ›å»ºå’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Boy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String state = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = <span class="string">" I Am So Sad."</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯ä»¥åˆ›å»ºå¤šä¸ªå¤‡ä»½</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  Memento <span class="title">createMemento</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Memento(<span class="keyword">this</span>.state);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯ä»¥é€‰æ‹©ä»»æ„çš„å¤‡ä»½è¿›è¡Œæ¢å¤</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> memento</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restore</span><span class="params">(Memento memento)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(memento.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Memento"><a href="#Memento" class="headerlink" title="Memento"></a>Memento</h4><p>å¤‡å¿˜å½•è§’è‰²ï¼Œè´Ÿè´£å­˜å‚¨Originatorå‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›å‘èµ·äººéœ€è¦çš„å†…éƒ¨çŠ¶æ€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String state = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Memento</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Caretaker"><a href="#Caretaker" class="headerlink" title="Caretaker"></a>Caretaker</h4><p>å¤‡å¿˜å½•ç®¡ç†å‘˜è§’è‰²ï¼Œå¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ã€ä¿å­˜å’Œæä¾›å¤‡å¿˜å½•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Memento memento;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memento = memento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Caretaker caretaker = <span class="keyword">new</span> Caretaker();</span><br><span class="line">caretaker.setMemento(boy.createMemento());</span><br><span class="line">System.out.println(<span class="string">"Now Boy Is : "</span> + boy.getState());</span><br><span class="line"></span><br><span class="line">boy.change();</span><br><span class="line">System.out.println(<span class="string">"Now Boy Is : "</span> + boy.getState());</span><br><span class="line"></span><br><span class="line">boy.restore(caretaker.getMemento());</span><br><span class="line">System.out.println(<span class="string">"Now Boy Is : "</span> + boy.getState());</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>éœ€è¦ä¿å­˜å’Œæ¢å¤æ•°æ®çš„ç›¸å…³çŠ¶æ€åœºæ™¯</li><li>æä¾›ä¸€ä¸ªå¯å›æ»šçš„æ“ä½œ </li><li>éœ€è¦ç›‘æ§çš„å‰¯æœ¬åœºæ™¯ä¸­</li><li>æ•°æ®åº“è¿æ¥çš„äº‹åŠ¡ç®¡ç†</li></ul><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><ul><li>å¤‡å¿˜å½•çš„ç”Ÿå‘½å‘¨æœŸ<br>ä¸»åŠ¨ç®¡ç†å¤‡å¿˜å½•çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸å®ç”¨å°±éœ€è¦ç«‹å³åˆ é™¤å…¶å¼•ç”¨ã€‚</li><li>å¤‡å¿˜å½•çš„æ€§èƒ½<br>è¦æ§åˆ¶å¤‡å¿˜å½•çš„å†å²è®°å½•æ•°é‡ï¼Œä»¥åŠå¤§å¯¹è±¡çš„å¤‡å¿˜å½•ã€‚</li></ul><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><h4 id="Cloneæ–¹å¼çš„å¤‡å¿˜å½•"><a href="#Cloneæ–¹å¼çš„å¤‡å¿˜å½•" class="headerlink" title="Cloneæ–¹å¼çš„å¤‡å¿˜å½•"></a>Cloneæ–¹å¼çš„å¤‡å¿˜å½•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Originator</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String state = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Originator <span class="title">createMemento</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restoreMemento</span><span class="params">(Originator originator)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(originator.getState());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Originator <span class="title">clone</span><span class="params">()</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Originator)<span class="keyword">super</span>.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Originator originator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Originator <span class="title">getOriginator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> originator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOriginator</span><span class="params">(Originator originator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.originator = originator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¤šçŠ¶æ€çš„å¤‡å¿˜å½•æ¨¡å¼"><a href="#å¤šçŠ¶æ€çš„å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="å¤šçŠ¶æ€çš„å¤‡å¿˜å½•æ¨¡å¼"></a>å¤šçŠ¶æ€çš„å¤‡å¿˜å½•æ¨¡å¼</h4><p>æŠŠæ•´ä¸ªå¯¹è±¡è½¬æ¢æˆMapï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åºåˆ—åŒ–ã€æˆ–è€…ç›´æ¥å¤åˆ¶æ•´ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String,Object&gt; stateMap;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Memento</span><span class="params">(HashMap&lt;String, Object&gt; stateMap)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stateMap = stateMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HashMap&lt;String, Object&gt; <span class="title">getStateMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stateMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStateMap</span><span class="params">(HashMap&lt;String, Object&gt; stateMap)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stateMap = stateMap;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.beans.BeanInfo;</span><br><span class="line"><span class="keyword">import</span> java.beans.Introspector;</span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyDescriptor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> HashMap&lt;String,Object&gt; <span class="title">backupProp</span><span class="params">(Object bean)</span></span>&#123;</span><br><span class="line">        HashMap&lt;String,Object&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            BeanInfo beanInfo = Introspector.getBeanInfo(bean.getClass());</span><br><span class="line">            PropertyDescriptor[] descriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">            <span class="keyword">for</span> (PropertyDescriptor descriptor : descriptors) &#123;</span><br><span class="line">                String fieldName = descriptor.getName();</span><br><span class="line">                Method getter = descriptor.getReadMethod();</span><br><span class="line">                Object fieldValue = getter.invoke(bean, <span class="keyword">new</span> Object[]&#123;&#125;);</span><br><span class="line">                <span class="keyword">if</span> (!fieldName.equalsIgnoreCase(<span class="string">"class"</span>))&#123;</span><br><span class="line">                    result.put(fieldName, fieldValue);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">restoreProp</span><span class="params">(Object bean, HashMap&lt;String,Object&gt; propMap)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            BeanInfo beanInfo = Introspector.getBeanInfo(bean.getClass());</span><br><span class="line">            PropertyDescriptor[] descriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">            <span class="keyword">for</span> (PropertyDescriptor descriptor : descriptors) &#123;</span><br><span class="line">                String fieldName = descriptor.getName();</span><br><span class="line">                <span class="keyword">if</span> (propMap.containsKey(fieldName))&#123;</span><br><span class="line">                    Method setter  = descriptor.getWriteMethod();</span><br><span class="line">                    setter.invoke(bean, <span class="keyword">new</span> Object[]&#123;propMap.get(fieldName)&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Originator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String state1 = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">private</span> String state2 = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">private</span> String state3 = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState1</span><span class="params">(String state1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state1 = state1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState2</span><span class="params">(String state2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state2 = state2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState3</span><span class="params">(String state3)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state3 = state3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">createMemento</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Memento(BeanUtils.backupProp(<span class="keyword">this</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restoreMemento</span><span class="params">(Memento memento)</span></span>&#123;</span><br><span class="line">        BeanUtils.restoreProp(<span class="keyword">this</span>, memento.getStateMap());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¤šå¤‡ä»½çš„å¤‡å¿˜å½•"><a href="#å¤šå¤‡ä»½çš„å¤‡å¿˜å½•" class="headerlink" title="å¤šå¤‡ä»½çš„å¤‡å¿˜å½•"></a>å¤šå¤‡ä»½çš„å¤‡å¿˜å½•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    Map&lt;String, Memento&gt; map =  <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">backup</span><span class="params">(String version, Memento memento)</span></span>&#123;</span><br><span class="line">        map.put(version, memento);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">get</span><span class="params">(String version)</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> map.get(version);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Memento&gt; <span class="title">getAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼˜é›…çš„å®ç°"><a href="#ä¼˜é›…çš„å®ç°" class="headerlink" title="ä¼˜é›…çš„å®ç°"></a>ä¼˜é›…çš„å®ç°</h3><p>Bean å¯¹è±¡ä¸“æ³¨è‡ªå·±çš„ä¸šåŠ¡ï¼Œä¸éœ€è¦å…³å¿ƒå¤‡ä»½å’Œæ¢å¤ä¸šåŠ¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Original</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String state;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String info;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(String state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInfo</span><span class="params">(String info)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.info = info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤‡ä»½ç®¡ç†å‘˜è´Ÿè´£ç‰ˆæœ¬çš„å¤‡ä»½ä¸æ¢å¤å·¥ä½œï¼ŒèŒè´£æ˜æ™°ã€‚<br>åŒæ—¶è¦æ³¨æ„å†å²ç‰ˆæœ¬æ¬¡æ•°ï¼Œé˜²æ­¢ç‰ˆæœ¬è¿‡å¤šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretacker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Original&gt; histo = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">backup</span><span class="params">(String key, Original o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (histo.size() &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            histo.put(key,(Original) o.clone() );</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Original <span class="title">get</span><span class="params">(String k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> histo.get(k);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è´£ä»»é“¾æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring æ€»è§ˆ</title>
      <link href="/2020/07/03/Spring-%E6%80%BB%E8%A7%88/"/>
      <url>/2020/07/03/Spring-%E6%80%BB%E8%A7%88/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Springç›¸å…³å†…å®¹æ¥æºäºSpringå®˜æ–¹ç½‘ç«™ä¸Springæºç ã€‚</p></blockquote><p><a href="https://spring.io/projects/spring-framework" target="_blank" rel="noopener">Spring 5.2.7</a></p><p>Springæ¡†æ¶ä¸ºä¼ä¸šçº§åº”ç”¨æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„é…ç½®å¼€å‘æ¨¡å‹ï¼Œå¯ä»¥åœ¨ä»»ä½•ç±»å‹çš„å‘å¸ƒå¹³å°ã€‚<br>Springä¸“æ³¨äºä¼ä¸šåº”ç”¨çš„ç®¡é“ï¼Œä¿è¯å¼€å‘å›¢é˜Ÿä¸“æ³¨äºä¼ä¸šçš„ä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸éœ€è¦å…³æ³¨å‘å¸ƒå¹³å°ã€‚</p><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><h4 id="æ ¸å¿ƒæŠ€æœ¯"><a href="#æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="æ ¸å¿ƒæŠ€æœ¯"></a>æ ¸å¿ƒæŠ€æœ¯</h4><ul><li><a href="/2020/07/06/Spring-IOC-And-DI/">Dependency Injectionä¾èµ–æ³¨å…¥</a></li><li>events äº‹ä»¶</li><li>resources èµ„æºç®¡ç†</li><li>i18n å›½é™…åŒ–</li><li>validation æ ¡éªŒ</li><li>data binding æ•°æ®ç»‘å®š</li><li>type conversion ç±»å‹è½¬æ¢</li><li>SpEL </li><li>AOP Aspect Oriented Programming é¢å‘åˆ‡é¢ç¼–ç¨‹</li></ul><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><ul><li>Mock Objects: æ¨¡æ‹Ÿå¯¹è±¡</li><li>TestContext framework: æµ‹è¯•ä¸Šä¸‹æ–‡æ¡†æ¶</li><li>Spring MVC Test: MVCæµ‹è¯•æ¡†æ¶</li><li>WebTestClient: webæµ‹è¯•å®¢æˆ·ç«¯</li></ul><h4 id="DataAccess"><a href="#DataAccess" class="headerlink" title="DataAccess"></a>DataAccess</h4><ul><li>transactions: äº‹åŠ¡</li><li>DAO Support: DAO æ”¯æŒ</li><li>JDBC:</li><li>ORMï¼š</li><li>Marshalling XML</li></ul><h4 id="Spring-MVC"><a href="#Spring-MVC" class="headerlink" title="Spring MVC"></a>Spring MVC</h4><h4 id="Spring-WebFlux"><a href="#Spring-WebFlux" class="headerlink" title="Spring WebFlux"></a>Spring WebFlux</h4><h4 id="Integration"><a href="#Integration" class="headerlink" title="Integration"></a>Integration</h4><ul><li>remoting</li><li>JMS</li><li>JCA</li><li>JMX</li><li>email</li><li>tasks</li><li>scheduling</li><li>cache</li></ul><h4 id="Languages"><a href="#Languages" class="headerlink" title="Languages"></a>Languages</h4><ul><li>Kotlin</li><li>Groovy</li><li>dynamic languages.</li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Spring </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ¨¡å¼</title>
      <link href="/2020/07/03/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/03/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h2><p>å‘½ä»¤æ¨¡å¼çš„å°è£…æ€§éå¸¸å¥½ï¼ŒæŠŠè¯·æ±‚æ–¹ï¼ˆInvokerï¼‰å’Œæ‰§è¡Œæ–¹ï¼ˆReceiverï¼‰åˆ†å¼€ï¼Œæ‰©å±•æ€§ä¹Ÿéå¸¸å¥½ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å°†ä¸€ä¸ªè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿å¾—ä¸åŒçš„è¯·æ±‚æŠŠå®¢æˆ·ç«¯å‚æ•°åŒ–ï¼Œå¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œå¯ä»¥æä¾›å‘½ä»¤çš„æ’¤é”€å’Œæ¢å¤åŠŸèƒ½ã€‚</p><p><img src="/2020/07/03/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/command_diagram.jpeg" alt="å‘½ä»¤æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Receiver"><a href="#Receiver" class="headerlink" title="Receiver"></a>Receiver</h4><p>æŠ½è±¡æ¥æ”¶è€…ï¼Œå®šä¹‰æ¯ä¸ªæ¥æ”¶è€…éƒ½å¿…é¡»å®Œæˆçš„ä¸šåŠ¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Receiver</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„Receiver</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Concrete1Reveiver</span> <span class="keyword">extends</span> <span class="title">Receiver</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Concrete2Reveiver</span> <span class="keyword">extends</span> <span class="title">Receiver</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h4><p>ä¸åŒçš„å‘½ä»¤å®ç°éƒ½éœ€è¦ç»§æ‰¿è¯¥ç±»ï¼Œå®ç°è‡ªå·±çš„executeé€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span>  <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“çš„å‘½ä»¤å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCommand1</span> <span class="keyword">extends</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Receiver receiver;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteCommand1</span><span class="params">(Receiver receiver)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCommand2</span> <span class="keyword">extends</span> <span class="title">Command</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Receiver receiver;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteCommand2</span><span class="params">(Receiver receiver)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Invoker"><a href="#Invoker" class="headerlink" title="Invoker"></a>Invoker</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Invoker</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Command command;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command command)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.command = command;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">action</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.command.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Invoker invoker = <span class="keyword">new</span> Invoker();</span><br><span class="line">invoker.setCommand(<span class="keyword">new</span> ConcreteCommand1(<span class="keyword">new</span> Concrete1Reveiver()));</span><br><span class="line">invoker.action();</span><br></pre></td></tr></table></figure><h3 id="æ¨¡å¼åº”ç”¨"><a href="#æ¨¡å¼åº”ç”¨" class="headerlink" title="æ¨¡å¼åº”ç”¨"></a>æ¨¡å¼åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li>è§£è€¦<br>è°ƒç”¨è€…è§’è‰²ä¸æ¥æ”¶è€…è§’è‰²ä¹‹é—´æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ï¼Œè°ƒç”¨è€…å®ç°åŠŸèƒ½æ—¶åªéœ€è¦è°ƒç”¨CommandæŠ½è±¡ç±»çš„executeæ–¹æ³•å³å¯ï¼Œä¸éœ€è¦äº†è§£æ˜¯å“ªä¸ªæ¥æ”¶è€…æ‰§è¡Œã€‚</li><li>å¯æ‰©å±•æ€§å¥½<br>Commandå­ç±»å¯ä»¥éå¸¸å®¹æ˜“çš„æ‰©å±•ï¼Œè°ƒç”¨è€…Invokerå’Œé«˜å±‚çš„æ¨¡å—Clientä¸äº§ç”Ÿä¸¥é‡çš„ä»£ç è€¦åˆã€‚</li><li>ä¸å…¶ä»–æ¨¡å¼æ··åˆä½¿ç”¨<br>ä¸è´£ä»»é“¾æ¨¡å¼ç»“åˆï¼Œå®ç°å‘½ä»¤æ—è§£æä»»åŠ¡<br>ä¸æ¨¡ç‰ˆæ–¹æ³•ç»“åˆï¼Œå‡å°‘Commandå­ç±»è†¨èƒ€çš„é—®é¢˜ã€‚</li></ul><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>Commandçš„å­ç±»ä¼šéšç€å‘½ä»¤çš„å¢å¤šé€æ­¥è†¨èƒ€ã€‚</p><h3 id="å‘½ä»¤çš„æ’¤é”€"><a href="#å‘½ä»¤çš„æ’¤é”€" class="headerlink" title="å‘½ä»¤çš„æ’¤é”€"></a>å‘½ä»¤çš„æ’¤é”€</h3><h4 id="åå‘½ä»¤"><a href="#åå‘½ä»¤" class="headerlink" title="åå‘½ä»¤"></a>åå‘½ä»¤</h4><p>é€šè¿‡ç›¸åçš„å‘½ä»¤æ¥å®ç°å‘½ä»¤çš„æ’¤é”€ã€‚</p><h4 id="ç»“åˆå¤‡å¿˜å½•æ¨¡å¼"><a href="#ç»“åˆå¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="ç»“åˆå¤‡å¿˜å½•æ¨¡å¼"></a>ç»“åˆå¤‡å¿˜å½•æ¨¡å¼</h4><p>ç»“åˆå¤‡å¿˜å½•æ¨¡å¼è¿˜åŸæœ€åçŠ¶æ€ï¼ŒæŠ˜ä¸­å‘æ˜‚å‘é€‚åˆæ¥æ”¶è€…ä¸ºçŠ¶æ€çš„å˜æ›´æƒ…å†µï¼Œè€Œä¸é€‚åˆäº‹ä»¶å¤„ç†ã€‚</p><h2 id="ä»£ç å®ä¾‹"><a href="#ä»£ç å®ä¾‹" class="headerlink" title="ä»£ç å®ä¾‹"></a>ä»£ç å®ä¾‹</h2><p>å‡è®¾æœ‰ä¸ªå½•éŸ³æœºï¼Œå½•éŸ³æœºé¢æ¿æœ‰ä¸‰ä¸ªæŒ‰é’®ï¼Œ playï¼Œ rewindï¼Œ stopã€‚</p><p>éœ€è¦æ ¹æ®ä¸‰ä¸ªæŒ‰é’®ä½œå‡ºç›¸åº”çš„åé¦ˆã€‚</p><h3 id="Receiver-1"><a href="#Receiver-1" class="headerlink" title="Receiver"></a>Receiver</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AudioPlayer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paly</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Play"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rewind</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Rewind"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Stop"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Command-1"><a href="#Command-1" class="headerlink" title="Command"></a>Command</h3><p>ä¸åŒçš„Commandè°ƒç”¨ä¸åŒçš„Receiverå‘½ä»¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> AudioPlayer audioPlayer = <span class="keyword">new</span> AudioPlayer();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PlayCommand</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.audioPlayer.paly();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RewindCommand</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        audioPlayer.rewind();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopCommand</span> <span class="keyword">extends</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        audioPlayer.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Invoker-1"><a href="#Invoker-1" class="headerlink" title="Invoker"></a>Invoker</h3><p>ç”¨äºè½¬å‘Command</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KeyPad</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Command command;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command command)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.command = command;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.command.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Use-1"><a href="#Use-1" class="headerlink" title="Use"></a>Use</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KeyPad keyPad = <span class="keyword">new</span> KeyPad();</span><br><span class="line"></span><br><span class="line">keyPad.setCommand(<span class="keyword">new</span> RewindCommand());</span><br><span class="line">keyPad.action();</span><br><span class="line"></span><br><span class="line">keyPad.setCommand(<span class="keyword">new</span> StopCommand());</span><br><span class="line">keyPad.action();</span><br></pre></td></tr></table></figure><p>å¦‚æœåæœŸéœ€è¦å¢åŠ ä¸€ä¸ªæŒ‰é’®ï¼ŒstopAndRewind()ï¼Œç›´æ¥å¢åŠ ä¸€ä¸ªCommandå­ç±»å³å¯ï¼Œå…¶ä»–åœ°æ–¹ä¸éœ€è¦åŠ¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopAndRewindCommand</span> <span class="keyword">extends</span>  <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        audioPlayer.stop();</span><br><span class="line">        audioPlayer.rewind();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è´£ä»»é“¾æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</title>
      <link href="/2020/07/02/%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/02/%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"><a href="#æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼" class="headerlink" title="æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"></a>æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</h2><p>æŠ½è±¡ç±»å®šä¹‰ä¸€ç»„æ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œå…·ä½“çš„åŠŸèƒ½ç”±å­ç±»æ¥å®ç°ã€‚<br>å®ƒä»…ä»…ä½¿ç”¨äº†Javaçš„ç»§æ‰¿æœºåˆ¶ï¼Œä½†ä½¿ç”¨éå¸¸å¹¿æ³›ã€‚<br>ä¸€èˆ¬å¤šä¸ªå­ç±»æœ‰å…¬æœ‰çš„æ–¹æ³•ï¼Œå¹¶ä¸”é€»è¾‘åŸºæœ¬ç›¸åŒçš„æ—¶å€™ä½¿ç”¨ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•æ¡†æ¶ï¼Œå†å°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ç®—æ³•çš„ç»“æ„å°±å¯ä»¥å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p><p><img src="/2020/07/02/%E6%A8%A1%E7%89%88%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/template_method_class.jpeg" alt="æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="åŸºæœ¬æ–¹æ³•"><a href="#åŸºæœ¬æ–¹æ³•" class="headerlink" title="åŸºæœ¬æ–¹æ³•"></a>åŸºæœ¬æ–¹æ³•</h4><p>ä¸€äº›åŸºæœ¬çš„æ“ä½œï¼Œç”±å­ç±»å®ç°å…·ä½“çš„é€»è¾‘ï¼Œåœ¨æ¨¡ç‰ˆæ–¹æ³•ä¸­è¢«è°ƒç”¨ã€‚</p><h4 id="æ¨¡ç‰ˆæ–¹æ³•"><a href="#æ¨¡ç‰ˆæ–¹æ³•" class="headerlink" title="æ¨¡ç‰ˆæ–¹æ³•"></a>æ¨¡ç‰ˆæ–¹æ³•</h4><p>æ¨¡ç‰ˆæ–¹æ³•å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ï¼ŒåŒ…å«äº†åŸºæœ¬æ–¹æ³•çš„è°ƒç”¨é€»è¾‘ã€‚</p><p>æŠ½è±¡æ¨¡ç‰ˆç±»ä¸­åŒ…å«äº†ä¸€ä¸ªæ¨¡ç‰ˆæ–¹æ³•goToSchoolå’Œä¸‰ä¸ªåŸºæœ¬æ–¹æ³•toSchool, study, goHome.<br>è¿™æ ·ï¼Œæ¯ä¸ªå­¦ç”Ÿç»§æ‰¿è¯¥æŠ½è±¡ç±»å®ç°è‡ªå·±é€»è¾‘å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentBehavor</span></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">toSchool</span><span class="params">()</span></span>;</span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">()</span></span>;</span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">goHome</span><span class="params">()</span></span>;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">goToSchool</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">//do something.</span></span><br><span class="line">       toSchool();</span><br><span class="line">       <span class="comment">// do something.</span></span><br><span class="line">       study();</span><br><span class="line">       <span class="comment">// do something.</span></span><br><span class="line">       goHome();</span><br><span class="line">       <span class="comment">// do something.</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li><p>å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†<br>æŠŠè®¤ä¸ºä¸å˜çš„éƒ¨åˆ†ç®—æ³•å°è£…åˆ°çˆ¶ç±»å®ç°ï¼Œå¯å˜éƒ¨åˆ†é€šè¿‡ç»§æ‰¿æ¥æ‰©å±•ã€‚</p></li><li><p>æå–å…¬å…±éƒ¨åˆ†ä»£ç ï¼Œä¾¿äºç»´æŠ¤</p></li><li><p>è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå­ç±»å®ç°<br>åŸºæœ¬æ–¹æ³•ç”±å­ç±»å®ç°ï¼Œå­ç±»å¯ä»¥æ‰©å±•å¢åŠ ç›¸åº”çš„åŠŸèƒ½ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p></li></ul><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>åœ¨å¤æ‚çš„é¡¹ç›®ä¸­ï¼Œå¢åŠ ä»£ç çš„é˜…è¯»éš¾åº¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´£ä»»é“¾æ¨¡å¼</title>
      <link href="/2020/07/02/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/02/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è´£ä»»é“¾æ¨¡å¼"><a href="#è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="è´£ä»»é“¾æ¨¡å¼"></a>è´£ä»»é“¾æ¨¡å¼</h2><p>è´£ä»»é“¾æ¨¡å¼çš„æ ¸å¿ƒåœ¨é“¾ä¸Šï¼Œ é“¾æ˜¯æœ‰å¤šä¸ªå¤„ç†è€…ç»„æˆçš„ã€‚å°±åƒæµæ°´çº¿ä¸Šçš„è´¨æ£€å‘˜ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…äº†è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…ä¹‹é—´çš„å…³ç³»ã€‚<br>å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><p><img src="/2020/07/02/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/chain_class.jpg" alt="è´£ä»»é“¾æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="æŠ½è±¡äº‹ä»¶"><a href="#æŠ½è±¡äº‹ä»¶" class="headerlink" title="æŠ½è±¡äº‹ä»¶"></a>æŠ½è±¡äº‹ä»¶</h4><p>æŠ½è±¡äº‹ä»¶ç±»å‹è¡¨æ˜è¿™ç±»å‹çš„äº‹ä»¶æ˜¯éœ€è¦è¢«å¤„ç†çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IEvent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getType</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…·ä½“çš„äº‹ä»¶"><a href="#å…·ä½“çš„äº‹ä»¶" class="headerlink" title="å…·ä½“çš„äº‹ä»¶"></a>å…·ä½“çš„äº‹ä»¶</h4><p>ä¸åŒç±»å‹çš„å­ç±»äº‹ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventClick</span> <span class="keyword">implements</span> <span class="title">IEvent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventEnter</span> <span class="keyword">implements</span> <span class="title">IEvent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventBlank</span> <span class="keyword">implements</span> <span class="title">IEvent</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŠ½è±¡çš„äº‹ä»¶å¤„ç†å™¨"><a href="#æŠ½è±¡çš„äº‹ä»¶å¤„ç†å™¨" class="headerlink" title="æŠ½è±¡çš„äº‹ä»¶å¤„ç†å™¨"></a>æŠ½è±¡çš„äº‹ä»¶å¤„ç†å™¨</h4><p>å®šä¹‰äº†åªæœ‰Ieventç±»å‹çš„äº‹ä»¶ä¼šè¢«å¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IEventHandler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">check</span><span class="params">(IEvent event)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…·ä½“çš„äº‹ä»¶å¤„ç†å™¨"><a href="#å…·ä½“çš„äº‹ä»¶å¤„ç†å™¨" class="headerlink" title="å…·ä½“çš„äº‹ä»¶å¤„ç†å™¨"></a>å…·ä½“çš„äº‹ä»¶å¤„ç†å™¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClickEventHandler</span> <span class="keyword">implements</span> <span class="title">IEventHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(IEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (event.getType() != <span class="number">1</span>)&#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Father check Ok. "</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EnterEventHandler</span> <span class="keyword">implements</span> <span class="title">IEventHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(IEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (event.getType() == <span class="number">2</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Husband Ok."</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BlankEventHandler</span> <span class="keyword">implements</span> <span class="title">IEventHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(IEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (event.getType() != <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Son Ok"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äº‹ä»¶å¤„ç†é“¾"><a href="#äº‹ä»¶å¤„ç†é“¾" class="headerlink" title="äº‹ä»¶å¤„ç†é“¾"></a>äº‹ä»¶å¤„ç†é“¾</h4><p>ç”¨äºç»„ç»‡äº‹ä»¶å¤„ç†å™¨ï¼Œç¬¦åˆæ¡ä»¶çš„å¤„ç†å™¨å¤„ç†å®Œæˆåæˆ–è€…æ²¡æœ‰å¤„ç†å™¨å¤„ç†éƒ½ä¼šåœæ­¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventHandlerChain</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;IEventHandler&gt; eventChains = <span class="keyword">new</span> ArrayList&lt;IEventHandler&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(IEventHandler eventHandler)</span> </span>&#123;</span><br><span class="line">        eventChains.add(eventHandler);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">check</span><span class="params">(IEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (IEventHandler eventChain : <span class="keyword">this</span>.eventChains) &#123;</span><br><span class="line">            <span class="keyword">if</span> (eventChain.check(event)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><p>å¯ä»¥éšæ„ç»„ç»‡è´£ä»»é“¾çš„é¡ºåºï¼Œç„¶åæ£€æŸ¥éœ€è¦æ£€æŸ¥çš„ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">EventHandlerChain chain = <span class="keyword">new</span> EventHandlerChain();</span><br><span class="line">chain.add(<span class="keyword">new</span> ClickEventHandler());</span><br><span class="line">chain.add(<span class="keyword">new</span> EnterEventHandler());</span><br><span class="line">chain.add(<span class="keyword">new</span> BlankEventHandler());</span><br><span class="line"></span><br><span class="line">chain.check(<span class="keyword">new</span> EventClick());</span><br><span class="line">chain.check(<span class="keyword">new</span> EventEnter());</span><br><span class="line">chain.check(<span class="keyword">new</span> EventBlank());</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><p>å°†è¯·æ±‚å’Œå¤„ç†åˆ†å¼€ã€‚è¯·æ±‚ç€å¯ä»¥ä¸ç”¨çŸ¥é“æ˜¯è°å¤„ç†çš„ï¼Œå¤„ç†è€…å¯ä»¥ä¸ç”¨çŸ¥é“è¯·æ±‚ç€çš„å…¨è²Œã€‚<br>ä¸¤è€…è§£è€¦ï¼Œæé«˜äº†ç³»ç»Ÿçš„çµæ´»æ€§ã€‚</p><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>æ€§èƒ½é—®é¢˜ï¼Œ æœ€å·®çš„æƒ…å†µä¸‹ï¼Œè¯·æ±‚ä»å¤´éå†åˆ°å°¾ï¼Œé“¾æ¡ç‰¹åˆ«é•¿çš„æ—¶å€™ï¼Œæ€§èƒ½æŸè€—æ˜¯ä¸ªå¤§çš„é—®é¢˜ã€‚<br>å› æ­¤åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­è¦æ³¨æ„è´£ä»»é“¾çš„é•¿çŸ­ã€‚<br>è°ƒè¯•ä¸æ–¹ä¾¿ã€‚</p><p>åœ¨å¹¿å‘Šç³»ç»Ÿä¸­ï¼Œç”±ä¸åŒçš„äº‹ä»¶æ¥è§¦å‘ä¸åŒç±»å‹çš„å¹¿å‘Šæ—¶æ ¹æ®è´£ä»»é“¾æ¨¡å¼æ¥å¤„ç†ã€‚<br>æ¯ä¸ªHandlerå¯ä»¥ä¸“æ³¨è‡ªå·±çš„ä¸šåŠ¡å¤„ç†é€»è¾‘ã€‚å…·ä½“Handlerè¿˜å¯ä»¥æŠ½è±¡ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒæŠŠå…¬ç”¨çš„é€»è¾‘å†™åœ¨æŠ½è±¡ç±»é‡Œé¢ï¼Œæ¯ä¸ªå…·ä½“çš„å®ç°ç±»åªè´Ÿè´£ä¸šåŠ¡çš„å¤„ç†å³å¯ï¼ˆä¼˜åŒ–ä¸ºæ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼ï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è´£ä»»é“¾æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿­ä»£å™¨æ¨¡å¼</title>
      <link href="/2020/07/01/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/01/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h2><p>è¿­ä»£å™¨æ¨¡å¼æä¾›äº†éå†å®¹å™¨çš„æ–¹ä¾¿æ€§ï¼Œå®¹å™¨åªè¦ç®¡ç†å¢å‡å…ƒç´ å³å¯ï¼Œéœ€è¦éå†çš„æ—¶å€™äº¤ç”±è¿­ä»£å™¨è¿›è¡Œã€‚</p><p>æ¯”å¦‚Setã€Mapã€Listç­‰å®¹å™¨çš„iteratorã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>è¿­ä»£å™¨æ˜¯ä¸ºå®¹å™¨æœåŠ¡çš„ï¼Œå®ƒæä¾›ä¸€ç§æ–¹æ³•è®¿é—®ä¸€ä¸ªå®¹å™¨å¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ã€‚</p><p><img src="/2020/07/01/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/iterator_class.jpeg" alt="è¿­ä»£å™¨æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a>Iterator</h4><p>æŠ½è±¡è¿­ä»£å™¨è´Ÿè´£å®šä¹‰è®¿é—®å’Œéå†å…ƒç´ çš„æ¥å£ã€‚<br>first() è·å–ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›<br>next() è®¿é—®ä¸‹ä¸€ä¸ªå…ƒç´ ï¼›<br>hasNext() æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªï¼›</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt;</span>&#123;</span><br><span class="line">    <span class="function">E <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">remove</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteIterator"><a href="#ConcreteIterator" class="headerlink" title="ConcreteIterator"></a>ConcreteIterator</h4><p>å…·ä½“è¿­ä»£å™¨è¦å®ç°è¿­ä»£å™¨æ¥å£ï¼Œå®Œæˆå®¹å™¨å…ƒç´ çš„éå†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteIterator</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Vector&lt;E&gt; v = <span class="keyword">new</span> Vector&lt;&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> cursor = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteIterator</span><span class="params">(Vector _vector)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.v = _vector;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.cursor != <span class="keyword">this</span>.v.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.hasNext() ? <span class="keyword">this</span>.v.get(<span class="keyword">this</span>.cursor++) : <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">remove</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.v.remove(<span class="keyword">this</span>.cursor);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Aggregate"><a href="#Aggregate" class="headerlink" title="Aggregate"></a>Aggregate</h4><p>æŠ½è±¡å®¹å™¨è§’è‰²è´Ÿè´£æä¾›åˆ›å»ºå…·ä½“è¿­ä»£å™¨è§’è‰²çš„æ¥å£ï¼Œ å¿…ç„¶æä¾›ä¸€ä¸ªç±»ä¼¼äºcreateIteratorï¼ˆï¼‰çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Aggregate</span>&lt;<span class="title">E</span>&gt;</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">remove</span><span class="params">(E e)</span></span>;</span><br><span class="line">    <span class="function">Iterator <span class="title">iterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Concrete-Aggregate"><a href="#Concrete-Aggregate" class="headerlink" title="Concrete Aggregate"></a>Concrete Aggregate</h4><p>å…·ä½“å®¹å™¨å®ç°å®¹å™¨æ¥å£å®šä¹‰çš„æ–¹æ³•ï¼Œåˆ›å»ºå‡ºå®¹çº³è¿­ä»£å™¨çš„å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteAggrate</span> <span class="keyword">implements</span> <span class="title">Aggregate</span>&lt;<span class="title">E</span>&gt;</span>&#123;</span><br><span class="line">    Vector v = <span class="keyword">new</span> Vector();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(E e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.add(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteIterator&lt;&gt;(<span class="keyword">this</span>.v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(E e)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.remove(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è¿­ä»£å™¨æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»„åˆæ¨¡å¼</title>
      <link href="/2020/07/01/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/07/01/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="ç»„åˆæ¨¡å¼"><a href="#ç»„åˆæ¨¡å¼" class="headerlink" title="ç»„åˆæ¨¡å¼"></a>ç»„åˆæ¨¡å¼</h2><p>ä¹Ÿå«åˆæˆæ¨¡å¼æˆ–è€…éƒ¨åˆ†æ•´ä½“æ¨¡å¼ï¼Œä¸»è¦ç”¨æ¥æè¿°éƒ¨åˆ†ä¸æ•´ä½“çš„å…³ç³»ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºéƒ¨åˆ†æ•´ä½“çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨äºå¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p><p><img src="/2020/07/01/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/combination_class.jpeg" alt="ç»„åˆæ¨¡å¼çš„é€šç”¨ç±»å›¾"></p><h4 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h4><p>å®šä¹‰å‚åŠ ç»„åˆå¯¹è±¡çš„å…±æœ‰æ–¹æ³•å’Œå±æ€§ï¼Œå¯ä»¥å®šä¹‰ä¸€äº›é»˜è®¤çš„è¡Œä¸ºæˆ–è€…å±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Component parent = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Component&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component c)</span></span>&#123;</span><br><span class="line">         c.parent = <span class="keyword">this</span>;</span><br><span class="line">         <span class="keyword">this</span>.list.add(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list.remove(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Component&gt; <span class="title">getChildren</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Component <span class="title">getParent</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.parent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Composite"><a href="#Composite" class="headerlink" title="Composite"></a>Composite</h4><p>æ ‘æå¯¹è±¡ï¼Œä½œç”¨æ˜¯ç»„åˆæ ‘æèŠ‚ç‚¹å’Œå¶å­ç»“ç‚¹å½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Composite</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Leaf"><a href="#Leaf" class="headerlink" title="Leaf"></a>Leaf</h4><p>å¶å­å¯¹è±¡ï¼Œä¸‹é¢æ²¡æœ‰åˆ†æ”¯ï¼Œæœ€å°çš„éå†å•ä½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Leaf</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ul><li>é«˜å±‚æ¨¡å—è°ƒç”¨ç®€å•<br>ä¸€é¢—å±æ€§ç»“æ„ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯Componentï¼Œå±€éƒ¨å’Œæ•´ä½“å¯¹è°ƒç”¨è€…æ¥è¯´æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œä¹Ÿå°±æ˜¯è¯´é«˜å±‚æ¨¡å—ä¸å¿…å…³å¿ƒè‡ªå·±å¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œç®€åŒ–äº†é«˜å±‚æ¨¡å—çš„ä»£ç ã€‚</li><li>èŠ‚ç‚¹è‡ªç”±åº¦å¢åŠ <br>ä½¿ç”¨ç»„åˆæ¨¡å¼åï¼Œå¦‚æœæƒ³å¢åŠ ä¸€ä¸ªæ ‘æèŠ‚ç‚¹ã€æ ‘å¶èŠ‚ç‚¹éƒ½éå¸¸å®¹æ˜“ã€‚<br>å¦‚ä½•å¼€é—­åŸåˆ™ï¼Œåˆ©äºç»´æŠ¤ã€‚</li></ul><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><p>ï¼ˆå®‰å…¨æ¨¡å¼ï¼‰ç›´æ¥ä½¿ç”¨äº†å®ç°ç±»(å¯ä»¥æ‰©å±•)ã€‚ä¸ä¾èµ–å€’ç½®åŸåˆ™å†²çªï¼Œé™åˆ¶äº†æ¥å£çš„å½±å“èŒƒå›´ã€‚</p><h3 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><h4 id="é€æ˜çš„ç»„åˆæ¨¡å¼"><a href="#é€æ˜çš„ç»„åˆæ¨¡å¼" class="headerlink" title="é€æ˜çš„ç»„åˆæ¨¡å¼"></a>é€æ˜çš„ç»„åˆæ¨¡å¼</h4><p>ä»¥ä¸Šçš„ä¾‹å­å°±æ˜¯é€æ˜çš„ç»„åˆæ¨¡å¼ï¼Œå§ç”¨æ¥ç»„åˆä½¿ç”¨çš„æ–¹æ³•æ”¾åˆ°æŠ½è±¡ç±»ä¸­ï¼Œæ— è®ºå¶å­å¯¹è±¡è¿˜æ˜¯æ ‘æå¯¹è±¡éƒ½æœ‰ç›¸åŒçš„ç»“æ„ï¼Œé€šè¿‡getChildren();åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹è¿˜æ˜¯æ ¹èŠ‚ç‚¹ã€‚</p><p>é€æ˜æ¨¡å¼çš„å¥½å¤„æ˜¯éµå¾ªäº†ä¾èµ–å€’ç½®åŸåˆ™</p><h4 id="å®‰å…¨çš„ç»„åˆæ¨¡å¼"><a href="#å®‰å…¨çš„ç»„åˆæ¨¡å¼" class="headerlink" title="å®‰å…¨çš„ç»„åˆæ¨¡å¼"></a>å®‰å…¨çš„ç»„åˆæ¨¡å¼</h4><p>å®‰å…¨æ¨¡å¼æ˜¯å°†å¶å­èŠ‚ç‚¹å’Œæ ‘æèŠ‚ç‚¹å½»åº•åˆ†å¼€ï¼Œæ ‘æèŠ‚ç‚¹å•ç‹¬æ‹¥æœ‰ç”¨æ¥ç»„åˆçš„æ–¹æ³•ã€‚</p><h5 id="Component-1"><a href="#Component-1" class="headerlink" title="Component"></a>Component</h5><p>å®šä¹‰å‚åŠ ç»„åˆå¯¹è±¡çš„å…±æœ‰æ–¹æ³•å’Œå±æ€§ï¼Œå¯ä»¥å®šä¹‰ä¸€äº›é»˜è®¤çš„è¡Œä¸ºæˆ–è€…å±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Component parent = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Component <span class="title">getParent</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.parent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Composite-1"><a href="#Composite-1" class="headerlink" title="Composite"></a>Composite</h5><p>æ ‘æå¯¹è±¡ï¼Œä½œç”¨æ˜¯ç»„åˆæ ‘æèŠ‚ç‚¹å’Œå¶å­ç»“ç‚¹å½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Composite</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Component&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Component c)</span></span>&#123;</span><br><span class="line">         c.parent = <span class="keyword">this</span>;</span><br><span class="line">         <span class="keyword">this</span>.list.add(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(Component c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list.remove(c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Component&gt; <span class="title">getChildren</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Leaf-1"><a href="#Leaf-1" class="headerlink" title="Leaf"></a>Leaf</h5><p>å¶å­å¯¹è±¡ï¼Œä¸‹é¢æ²¡æœ‰åˆ†æ”¯ï¼Œæœ€å°çš„éå†å•ä½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Leaf</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> ç»„åˆæ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¿é—®è€…æ¨¡å¼</title>
      <link href="/2020/06/30/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/30/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="è®¿é—®è€…æ¨¡å¼"><a href="#è®¿é—®è€…æ¨¡å¼" class="headerlink" title="è®¿é—®è€…æ¨¡å¼"></a>è®¿é—®è€…æ¨¡å¼</h2><p>è®¿é—®è€…æ¨¡å¼æ˜¯ä¸€ç§é›†ä¸­è§„æ•´æ¨¡å¼ï¼Œé€‚åˆç”¨äºé‡æ„é¡¹ç›®æ—¶ï¼ˆé‡æ„æ—¶éœ€æ±‚å·²ç»æ¸…æ™°ï¼ŒåŸæœ‰çš„åŠŸèƒ½ç‚¹ä¹Ÿæ˜ç¡®ï¼‰<br>é€šè¿‡è®¿é—®è€…æ¨¡å¼å¯ä»¥å¾ˆå®¹æ˜“è¾¾åˆ°åŠŸèƒ½é›†ä¸­åŒ–ã€‚<br>è¿˜å¯ä»¥ä¸å…¶ä»–æ¨¡å¼æ··ç¼–å»ºç«‹ä¸€å¥—è‡ªå·±çš„è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å°è£…ä¸€äº›ç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„ä¸ªå…ƒç´ çš„æ“ä½œï¼Œå¯ä»¥åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚</p><p><img src="/2020/06/30/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/visitor_class.jpeg" alt="è®¿é—®è€…æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h3><h4 id="Visitor-æŠ½è±¡è®¿é—®è€…"><a href="#Visitor-æŠ½è±¡è®¿é—®è€…" class="headerlink" title="Visitor æŠ½è±¡è®¿é—®è€…"></a>Visitor æŠ½è±¡è®¿é—®è€…</h4><p>æŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼Œå£°æ˜è®¿é—®è€…å¯ä»¥è®¿é—®å“ªäº›å…ƒç´ ï¼Œå…·ä½“åˆ°ç¨‹åºä¸­å°±æ˜¯visitæ–¹æ³•çš„å‚æ•°å®šä¹‰å“ªäº›å¯¹è±¡æ˜¯å¯ä»¥è¢«è®¿é—®çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVisitor</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElement1 el1)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElement2 el2)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteVisitor-å…·ä½“è®¿é—®è€…"><a href="#ConcreteVisitor-å…·ä½“è®¿é—®è€…" class="headerlink" title="ConcreteVisitor å…·ä½“è®¿é—®è€…"></a>ConcreteVisitor å…·ä½“è®¿é—®è€…</h4><p>å½±å“è®¿é—®è€…è®¿é—®åˆ°ä¸€ä¸ªç±»åè¯¥åšä»€ä¹ˆäº‹æƒ…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Visitor</span> <span class="keyword">implements</span> <span class="title">IVisitor</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElement1 el1)</span></span>&#123;</span><br><span class="line">        el1.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(ConcreteElement2 el2)</span></span>&#123;</span><br><span class="line">        el2.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Element-æŠ½è±¡å…ƒç´ "><a href="#Element-æŠ½è±¡å…ƒç´ " class="headerlink" title="Element æŠ½è±¡å…ƒç´ "></a>Element æŠ½è±¡å…ƒç´ </h4><p>æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå£°æ˜æ¥å—å“ªä¸€ç±»è®¿é—®è€…è®¿é—®ã€‚<br>æŠ½è±¡å…ƒç´ æœ‰ä¸¤ç±»æ–¹æ³•ï¼Œ ä¸€ç±»æ˜¯æœ¬èº«çš„ä¸šåŠ¡é€»è¾‘ã€‚å¦ä¸€ç±»æ˜¯å…è®¸è®¿é—®è€…æ¥è®¿é—®çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Element</span></span>&#123;</span><br><span class="line">    <span class="comment">//ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//æ¥å—è®¿é—®è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(IVisitor visitor)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteElement-å…·ä½“å…ƒç´ "><a href="#ConcreteElement-å…·ä½“å…ƒç´ " class="headerlink" title="ConcreteElement å…·ä½“å…ƒç´ "></a>ConcreteElement å…·ä½“å…ƒç´ </h4><p>å®ç°acceptæ–¹æ³•ï¼Œ é€šå¸¸æ˜¯ visitor.visit(this)æ¨¡å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteElement1</span> <span class="keyword">extends</span> <span class="title">Element</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(IVisitor visitor)</span></span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteElement2</span> <span class="keyword">extends</span> <span class="title">Element</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(IVisitor visitor)</span></span>&#123;</span><br><span class="line">        visitor.visit(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ObjectStructureç»“æ„å¯¹è±¡"><a href="#ObjectStructureç»“æ„å¯¹è±¡" class="headerlink" title="ObjectStructureç»“æ„å¯¹è±¡"></a>ObjectStructureç»“æ„å¯¹è±¡</h4><p>å…ƒç´ ç”Ÿäº§è€…ï¼Œä¸€èˆ¬å®¹çº³åœ¨å¤šä¸ªä¸åŒç±»ã€ä¸åŒæ¥å£çš„å®¹å™¨ï¼Œå¦‚List/Set/Mapã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectStructure</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Element <span class="title">createElement</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Random().nextInt(<span class="number">10</span>) &gt; <span class="number">5</span> ? <span class="keyword">new</span> ConcreteElement1() : <span class="keyword">new</span> ConcreteElement2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span> ; i++)&#123;</span><br><span class="line">     ObjectStructure.createElement().accept(<span class="keyword">new</span> Visitor());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™</li><li>ä¼˜ç§€çš„æ‰©å±•æ€§</li><li>çµæ´»</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>è¿èƒŒäº†è¿ªç±³ç‰¹æ³•åˆ™ï¼ŒElementå…·ä½“çš„ç»†èŠ‚éœ€è¦å…¬å¸ƒç»™Visitor</li><li>å…·ä½“å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾ï¼Œå…ƒç´ å¢åŠ /å‡å°‘å­—æ®µVisitoréƒ½éœ€è¦ä¿®æ”¹</li><li>è¿èƒŒäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œè®¿é—®è€…ä¾èµ–çš„æ˜¯å…·ä½“çš„å…ƒç´ ï¼Œè€Œä¸æ˜¯æŠ½è±¡å…ƒç´ ã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><p>å½“ä¸€ä¸ªå¯¹è±¡ç»“æ„åŒ…å«å¾ˆå¤šç±»å¯¹è±¡ï¼Œå®ƒä»¬æœ‰ä¸åŒçš„æ¥å£ï¼Œéœ€è¦å¯¹è¿™äº›å¯¹è±¡å®æ–½ä¸€äº›ä¾èµ–äºå…¶å…·ä½“ç±»çš„æ“ä½œã€‚</p><h3 id="åŒåˆ†æ´¾"><a href="#åŒåˆ†æ´¾" class="headerlink" title="åŒåˆ†æ´¾"></a>åŒåˆ†æ´¾</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbsActor</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">act</span><span class="params">(Role role)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Actor can act any role."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">act</span><span class="params">(KungFuRole role)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Actor can act Kungfu Role."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">YongActor</span> <span class="keyword">extends</span> <span class="title">AbsActor</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">act</span><span class="params">(KungFuRole role)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Yong Man Lov Act KungFu Role."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OldActor</span> <span class="keyword">extends</span> <span class="title">AbsActor</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">act</span><span class="params">(KungFuRole role)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Old Man Can Not Act KungFu Role."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Role</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(AbsActor actor)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KungFuRole</span> <span class="keyword">extends</span> <span class="title">Role</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(AbsActor actor)</span></span>&#123;</span><br><span class="line">        actor.act(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdiotRole</span> <span class="keyword">extends</span> <span class="title">Role</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(AbsActor actor)</span></span>&#123;</span><br><span class="line">        actor.act(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AbsActor actor = <span class="keyword">new</span> OldActor();</span><br><span class="line">Role role = <span class="keyword">new</span> KungFuRole();</span><br><span class="line">actor.act(role); <span class="comment">//oldActor.act(Role)</span></span><br><span class="line">actor.act(<span class="keyword">new</span> KungFuRole()); <span class="comment">//oldActor.act(KungFuRole);</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AbsActor actor = <span class="keyword">new</span> OldActor();</span><br><span class="line">Role role = <span class="keyword">new</span> KungFuRole();</span><br><span class="line">role.accept(actor); <span class="comment">//KungFuRole.accept(OldActor);</span></span><br><span class="line">                    <span class="comment">//OldActor.act(KungFuRole)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> è®¿é—®è€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŠ¶æ€æ¨¡å¼</title>
      <link href="/2020/06/29/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/29/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h2><p>åœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼Œ ç±»çš„è¡Œä¸ºæ—¶ç»™äºˆå®ƒçš„çŠ¶æ€æ”¹å˜çš„ã€‚æŠ˜ä¸­ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å½“ä¸€ä¸ªå¯¹è±¡å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶å…è®¸å…¶æ”¹å˜è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥åƒæ”¹å˜äº†å…¶ç±»ã€‚</p><p><img src="/2020/06/29/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/State_class.jpeg" alt="çŠ¶æ€æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="æŠ½è±¡çŠ¶æ€è§’è‰²State"><a href="#æŠ½è±¡çŠ¶æ€è§’è‰²State" class="headerlink" title="æŠ½è±¡çŠ¶æ€è§’è‰²State"></a>æŠ½è±¡çŠ¶æ€è§’è‰²State</h4><p>æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œè´Ÿè´£å¯¹è±¡çŠ¶æ€çš„å®šä¹‰ï¼Œå¹¶ä¸”å°è£…ç¯å¢ƒè§’è‰²ä»¥å®ç°çŠ¶æ€åˆ‡æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseState</span> <span class="keyword">implements</span> <span class="title">IState</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> Car context;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContext</span><span class="params">(Car context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…·ä½“çŠ¶æ€è§’è‰²ConcreteState"><a href="#å…·ä½“çŠ¶æ€è§’è‰²ConcreteState" class="headerlink" title="å…·ä½“çŠ¶æ€è§’è‰²ConcreteState"></a>å…·ä½“çŠ¶æ€è§’è‰²ConcreteState</h4><p>æ¯ä¸ªå…·ä½“çŠ¶æ€å¿…é¡»å®Œæˆä¸¤ä¸ªèŒè´£ï¼šæœ¬çŠ¶æ€ä¸‹è¦åšçš„äº‹æƒ…ä»¥åŠæœ¬çŠ¶æ€å¦‚ä½•è¿‡æ¸¡åˆ°å…¶ä»–çŠ¶æ€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OpenState</span> <span class="keyword">extends</span> <span class="title">BaseState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.OPEN_STATE);</span><br><span class="line">        System.out.println(<span class="string">"è½¦é—¨å·²å¼€å¯"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.CLOSE_STATE);</span><br><span class="line">        System.out.println(<span class="string">"å…³é—­è½¦é—¨ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å¼€é—¨çŠ¶æ€ä¸‹ä¸å…è®¸é£™è½¦start"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"å¼€é—¨çŠ¶æ€ä¸‹ä¸å…è®¸é£™è½¦Stop"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopState</span> <span class="keyword">extends</span> <span class="title">BaseState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.OPEN_STATE);</span><br><span class="line">        System.out.println(<span class="string">"åœè½¦åå¼€å¯è½¦é—¨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.CLOSE_STATE);</span><br><span class="line">        System.out.println(<span class="string">"åœè½¦åå…³é—­è½¦é—¨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.RUN_STATE);</span><br><span class="line">        System.out.println(<span class="string">"åœè½¦åå†æ¬¡è·‘èµ·æ¥"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.STOP_STATE);</span><br><span class="line">        System.out.println(<span class="string">"åœè½¦åã€‚ã€‚åœæ­¢ä¸åŒ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunState</span> <span class="keyword">extends</span> <span class="title">BaseState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é£™è½¦æ—¶ä¸èƒ½å¼€é—¨"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"é£™è½¦æ—¶è½¦é—¨å·²å…³é—­"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.RUN_STATE);</span><br><span class="line">        System.out.println(<span class="string">"é£™è½¦Run"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.context.setCurrentState(Car.STOP_STATE);</span><br><span class="line">        System.out.println(<span class="string">"é£™è½¦ stop"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloseState</span> <span class="keyword">extends</span> <span class="title">BaseState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setCurrentState(Car.OPEN_STATE);</span><br><span class="line">        System.out.println(<span class="string">"å¼€å¯è½¦é—¨ã€‚ã€‚ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"è½¦é—¨å·²ç»å…³é—­ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context.setCurrentState(Car.RUN_STATE);</span><br><span class="line">        System.out.println(<span class="string">"æ±½è½¦å¼€å§‹è¿è¡Œã€‚ã€‚ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context.setCurrentState(Car.STOP_STATE);</span><br><span class="line">        System.out.println(<span class="string">"æ±½è½¦åœæ­¢ã€‚"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¯å¢ƒè§’è‰²Context"><a href="#ç¯å¢ƒè§’è‰²Context" class="headerlink" title="ç¯å¢ƒè§’è‰²Context"></a>ç¯å¢ƒè§’è‰²Context</h4><p>å®šä¹‰å®¢æˆ·ç«¯éœ€è¦çš„æ¥å£ï¼Œå¹¶ä¸”è´Ÿè´£å…·ä½“çŠ¶æ€çš„åˆ‡æ¢ã€‚</p><p>æŠŠçŠ¶æ€å¯¹è±¡å£°æ˜ä¸ºé™æ€å¸¸é‡ï¼Œæœ‰å‡ ä¸ªçŠ¶æ€å¯¹è±¡å°±å£°æ˜å‡ ä¸ªé™æ€å¸¸é‡ã€‚<br>ç¯å¢ƒè§’è‰²å…·æœ‰çŠ¶æ€æŠ½è±¡è§’è‰²å®šä¹‰çš„æ‰€æœ‰è¡Œä¸ºï¼Œå…·ä½“æ‰§è¡Œä½¿ç”¨å§”æ‰˜æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> <span class="keyword">implements</span> <span class="title">IState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> BaseState OPEN_STATE = <span class="keyword">new</span> OpenState();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> BaseState CLOSE_STATE = <span class="keyword">new</span> CloseState();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> BaseState RUN_STATE = <span class="keyword">new</span> RunState();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> BaseState STOP_STATE = <span class="keyword">new</span> StopState();</span><br><span class="line">    <span class="keyword">private</span> BaseState currentState;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setCurrentState(CLOSE_STATE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> BaseState <span class="title">getCurrentState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentState;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Car <span class="title">setCurrentState</span><span class="params">(BaseState currentState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentState = currentState;</span><br><span class="line">        <span class="keyword">this</span>.currentState.setContext(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentState.open();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentState.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentState.run();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentState.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><p>ç»“åˆå»ºé€ è€…æ¨¡å¼å°†å·²æœ‰çš„çŠ¶æ€æŒ‰ç…§ä¸€å®šçš„é¡ºåºå†é‡æ–°ç»„è£…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Car car = <span class="keyword">new</span> Car();</span><br><span class="line"></span><br><span class="line">car.setCurrentState(Car.CLOSE_STATE);</span><br><span class="line"></span><br><span class="line">car.run(); <span class="comment">//æ±½è½¦å¼€å§‹è¿è¡Œã€‚ã€‚ã€‚</span></span><br><span class="line">car.stop(); <span class="comment">//é£™è½¦ stop</span></span><br><span class="line"></span><br><span class="line">car.run(); <span class="comment">//åœè½¦åå†æ¬¡è·‘èµ·æ¥</span></span><br><span class="line">car.open(); <span class="comment">//é£™è½¦æ—¶ä¸èƒ½å¼€é—¨</span></span><br><span class="line"></span><br><span class="line">car.stop(); <span class="comment">//é£™è½¦ stop</span></span><br><span class="line"></span><br><span class="line">car.open(); <span class="comment">//åœè½¦åå¼€å¯è½¦é—¨</span></span><br><span class="line">car.close(); <span class="comment">//å…³é—­è½¦é—¨ã€‚ã€‚ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ç»“æ„æ¸…æ™°<br>é¿å…è¿‡å¤šçš„switch caseå’Œif elseï¼Œé™ä½äº†ç¨‹åºçš„å¤æ‚æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€‚</li><li>éµå¾ªè®¾è®¡åŸåˆ™<br>éµå¾ªäº†å¼€é—­åŸåˆ™ä»¥åŠå•ä¸€èŒè´£åŸåˆ™ï¼Œæ¯ä¸ªçŠ¶æ€éƒ½æ˜¯ä¸€ä¸ªå­ç±»ï¼Œè¦å¢åŠ çŠ¶æ€å°±è¦å¢åŠ å­ç±»ï¼Œä¿®æ”¹çŠ¶æ€æ—¶åªä¿®æ”¹ä¸€ä¸ªå­ç±»å³å¯ã€‚</li><li>å°è£…æ€§è‰¯å¥½<br>çŠ¶æ€å˜æ¢é˜²æ­¢åˆ°ç±»çš„å†…éƒ¨æ¥å®ç°ï¼Œå¤–éƒ¨è°ƒç”¨ä¸éœ€è¦çŸ¥é“ç±»å†…éƒ¨å¦‚ä½•å®ç°çŠ¶æ€å’Œè¡Œä¸ºçš„å˜æ¢ã€‚</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>çŠ¶æ€è¿‡å¤šæ—¶å­ç±»è†¨èƒ€</li></ul><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><ul><li>è¡Œä¸ºè·ŸéšçŠ¶æ€æ”¹å˜è€Œæ”¹å˜çš„åœºæ™¯</li><li>æ¡ä»¶ã€åˆ†æ”¯åˆ¤æ–­è¯­å¥çš„æ›¿ä»£</li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> çŠ¶æ€æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»£ç†æ¨¡å¼</title>
      <link href="/2020/06/28/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/28/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h2><p>ä»£ç†æ¨¡å¼ä¹Ÿå«å§”æ‰˜æ¨¡å¼ï¼Œè®¸å¤šå…¶ä»–çš„æ¨¡å¼å¦‚çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼æœ¬è´¨ä¸Šæ˜¯åœ¨æ›´ç‰¹æ®Šçš„åœºåˆé‡‡ç”¨äº†ä»£ç†æ¨¡å¼ã€‚<br>åœ¨æ—¥å¸¸åº”ç”¨ä¸­ï¼Œä»£ç†æ¨¡å¼å¯ä»¥æä¾›éå¸¸å¥½çš„è®¿é—®æ§åˆ¶ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬çš„DBçš„è®¿é—®æƒé™ä¸èƒ½ç›´æ¥å…¬å¼€ï¼Œä¸€èˆ¬ä¼šå…¬å¼€ä¸€ä¸ªæ¥å£æ¥æä¾›å¯¹è¿™äº›æ•°æ®ã€‚</p><p><img src="/2020/06/28/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/proxy_class.jpeg" alt="ä»£ç†æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="æŠ½è±¡ä¸»é¢˜Subject"><a href="#æŠ½è±¡ä¸»é¢˜Subject" class="headerlink" title="æŠ½è±¡ä¸»é¢˜Subject"></a>æŠ½è±¡ä¸»é¢˜Subject</h4><p>å¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼Œæ™®é€šçš„ä¸šåŠ¡ç±»å‹å®šä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…·ä½“ä¸»é¢˜RealSubject"><a href="#å…·ä½“ä¸»é¢˜RealSubject" class="headerlink" title="å…·ä½“ä¸»é¢˜RealSubject"></a>å…·ä½“ä¸»é¢˜RealSubject</h4><p>å§”æ‰˜è§’è‰²æˆ–è€…è¢«ä»£ç†è§’è‰²ã€‚ä¸šåŠ¡é€»è¾‘çš„å…·ä½“æ‰§è¡Œè€…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RealSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do something.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä»£ç†ä¸»é¢˜Proxy"><a href="#ä»£ç†ä¸»é¢˜Proxy" class="headerlink" title="ä»£ç†ä¸»é¢˜Proxy"></a>ä»£ç†ä¸»é¢˜Proxy</h4><p>ä»£ç†ç±»ã€å§”æ‰˜ç±»ï¼Œ è´Ÿè´£å¯¹çœŸå®è§’è‰²çš„è°ƒç”¨ï¼ŒæŠŠæ‰€æœ‰æŠ½è±¡ä¸»é¢˜ç±»å®šä¹‰çš„æ–¹æ³•é™åˆ¶å§”æ‰˜ç»™çœŸå®ä¸»é¢˜è§’è‰²å®ç°ï¼Œå¹¶ä¸”åœ¨çœŸå®ä¸»é¢˜è§’è‰²å¤„ç†å®Œæ¯•å‰ååšé¢„å¤„ç†å’Œå–„åå¤„ç†å·¥ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">Subject</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Subject subject = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Proxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.subject = <span class="keyword">new</span> Proxy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Proxy</span><span class="params">(Subject subject)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.subject = subject;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">request</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.before();</span><br><span class="line">        <span class="keyword">this</span>.subject.request();</span><br><span class="line">        <span class="keyword">this</span>.after();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//before </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//after.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>èŒè´£æ¸…æ™°<br>çœŸå®çš„è§’è‰²å°±æ˜¯å®ç°å®é™…çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨å…³å¿ƒå…¶ä»–éæœ¬èŒè´£çš„äº‹ç‰©ï¼Œé€šè¿‡åæœŸçš„ä»£ç†å®Œæˆä¸€ä»¶äº‹ç‰©ï¼Œé™„å¸¦çš„ç»“æœå°±æ˜¯ç¼–ç¨‹ç®€æ´æ¸…æ™°ã€‚</li><li>æ‰©å±•æ€§å¥½<br>å…·ä½“ä¸»é¢˜è§’è‰²æ˜¯éšæ—¶éƒ½ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œåªè¦å®ƒå®ç°äº†æ¥å£ï¼Œä»£ç†ç±»å¯ä»¥åœ¨ä¸åšä»»ä½•ä¿®æ”¹çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚</li><li>æ™ºèƒ½åŒ–<br>ç”¨äºåŠ¨æ€ä»£ç†ã€‚</li></ul><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h2><h3 id="æ™®é€šä»£ç†"><a href="#æ™®é€šä»£ç†" class="headerlink" title="æ™®é€šä»£ç†"></a>æ™®é€šä»£ç†</h3><p>å®¢æˆ·ç«¯åªèƒ½è®¿é—®ä»£ç†è§’è‰²ï¼Œè€Œä¸èƒ½è®¿é—®çœŸå®è§’è‰²ã€‚å±è”½äº†çœŸå®è§’è‰²çš„å˜æ›´å¯¹é«˜å±‚æ¨¡å—çš„å½±å“ã€‚è¯¥æ¨¡å¼é€‚åˆå¯¹æ‰©å±•æ€§è¦æ±‚è¾ƒé«˜çš„åœºåˆã€‚ä¸€èˆ¬é€šè¿‡ç¼–ç¨‹è§„èŒƒç±»çº¦æŸæ¥ç¦æ­¢newä¸€ä¸ªçœŸå®çš„è§’è‰²ã€‚</p><p>è¿™ç§æ–¹å¼è°ƒç”¨è€…åªéœ€è¦çŸ¥é“ä»£ç†å³å¯ï¼Œ ä¸éœ€è¦çŸ¥é“ä»£ç†äº†è°ã€‚</p><p>æ™®é€šä»£ç†çš„å®ç°è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayer</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">""</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayer</span><span class="params">(IGamePlayer _gamePlayer, String _name)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(_gamePlayer == <span class="keyword">null</span> || !(_gamePlayer <span class="keyword">instanceof</span> GameProxy))&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"Create Not Allowed!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.name = _name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killMonster</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ™®é€šä»£ç†çš„ä»£ç†è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayerProxy</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IGamePlayer gamePlayer = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayerProxy</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            gamePlayer = <span class="keyword">new</span> GamePlayer(<span class="keyword">this</span>,name);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">//TODO </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killMonster</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gamePlayer.killMonster();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼ºåˆ¶ä»£ç†"><a href="#å¼ºåˆ¶ä»£ç†" class="headerlink" title="å¼ºåˆ¶ä»£ç†"></a>å¼ºåˆ¶ä»£ç†</h3><p>åªæœ‰é€šè¿‡çœŸå®è§’è‰²æŒ‡å®šçš„ä»£ç†ç±»æ‰å¯ä»¥è®¿é—®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IGamePlayer</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">killMonster</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IGamePlayer <span class="title">getProxy</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayer</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">private</span> IGamePlayer proxy = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayer</span><span class="params">(String _name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = _name;</span><br><span class="line">        <span class="keyword">this</span>.proxy = <span class="keyword">new</span> GamepPlayerProxy(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IGamePlayer <span class="title">getProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.proxy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killMonster</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//do...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GamePlayerProxy</span> <span class="keyword">implements</span> <span class="title">IGamePlayer</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> IGamePlayer gamePlayer = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GamePlayerProxy</span><span class="params">(IGamePlayer _gamePlayer)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gamePlayer = _gamePlayer;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killMonster</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gamePlayer.killMonster();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h3><p>åœ¨å®ç°é˜¶æ®µä¸éœ€è¦å…³å¿ƒä»£ç†è°ï¼Œ åœ¨è¿è¡Œé˜¶æ®µæ‰æŒ‡å®šä»£ç†å“ªä¸ªå¯¹è±¡ã€‚</p><p>é€šè¿‡InvocationHandleræ¥å£ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½ç”±è¯¥Handleræ¥æ¥ç®¡å®é™…çš„ä¸šåŠ¡å¤„ç†ã€‚</p><p>åœ¨ä¸æ”¹å˜å·²æœ‰ä»£ç ç»“æ„çš„æƒ…å†µä¸‹å¢å¼ºæˆ–è€…æ§åˆ¶å¯¹è±¡çš„è¡Œä¸ºã€‚</p><p>åŠ¨æ€ä»£ç†Handlerç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Object target = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyInvocationHandler</span><span class="params">(Object _obj)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target = _obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span><span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> method.invoke(<span class="keyword">this</span>.target, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šçŸ¥æ¥å£ä¸å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IAdvice</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exec</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeforeAdvice</span> <span class="keyword">implements</span> <span class="title">IAdvice</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exec</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//....</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ¨æ€ä»£ç†ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxy</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(condition)&#123; <span class="comment">//åœ¨conditionè¿æ¥ç‚¹æ‰§è¡ŒBeforeAdviceé€šçŸ¥ã€‚</span></span><br><span class="line">            (<span class="keyword">new</span> BeforeAdvice()).exec();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T)Proxy.newProxyInstance(loader, <span class="class"><span class="keyword">interface</span>, <span class="title">h</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Client:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Subject subject = <span class="keyword">new</span> RealSubject();</span><br><span class="line">InvocationHandler handler = <span class="keyword">new</span> MyInvocationHandler(subject);</span><br><span class="line">Subject proxy = DynamicProxy.newProxyInstance(subject.getClass().getClassLoader(), subject.getClass().getInterfaces(), handler);</span><br><span class="line">proxy.killMonster();</span><br></pre></td></tr></table></figure><h3 id="æ‰©å±•-1"><a href="#æ‰©å±•-1" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h3><ul><li>CGLib</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogInterceptor</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Before Interceptor1"</span>);</span><br><span class="line">        Object result = methodProxy.invokeSuper(o, objects);</span><br><span class="line">        System.out.println(<span class="string">"After Interceptor1"</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogInterceptor2</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Before Interceptor2"</span>);</span><br><span class="line">        Object result = methodProxy.invokeSuper(o, objects);</span><br><span class="line">        System.out.println(<span class="string">"After Interceptor2"</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogCallBackFilter</span> <span class="keyword">implements</span> <span class="title">CallbackFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">accept</span><span class="params">(Method method)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"upgrade"</span>.equals(method.getName()))&#123;</span><br><span class="line">            System.out.println(<span class="string">"Upgrade Filter"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Kill Monster Filter"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">LogInterceptor logInterceptor = <span class="keyword">new</span> LogInterceptor();</span><br><span class="line"></span><br><span class="line">LogInterceptor2 logInterceptor2 = <span class="keyword">new</span> LogInterceptor2();</span><br><span class="line"></span><br><span class="line">Enhancer enhancer = <span class="keyword">new</span> Enhancer();</span><br><span class="line">enhancer.setSuperclass(GamePlayer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">enhancer.setCallbacks(<span class="keyword">new</span> Callback[]&#123;logInterceptor,logInterceptor2, NoOp.INSTANCE&#125;);</span><br><span class="line"></span><br><span class="line">enhancer.setCallbackFilter(<span class="keyword">new</span> LogCallBackFilter());</span><br><span class="line"></span><br><span class="line">IGamePlayer gamePlayer = (IGamePlayer)enhancer.create(new Class[]&#123;String.class&#125;, new Object[]&#123;"Lisi"&#125;);</span><br><span class="line"></span><br><span class="line">gamePlayer.killMonster();</span><br><span class="line">gamePlayer.upgrade();</span><br></pre></td></tr></table></figure><ul><li>ASM</li><li>AOP</li></ul><p>æ‰©å±•é˜…è¯»<br><a href="https://www.jianshu.com/p/a728dac249e1?tdsourcetag=s_pcqq_aiomsg" target="_blank" rel="noopener">cglibåŠ¨æ€ä»£ç†ã€asmå­¦ä¹ ç¬”è®°</a><br><a href="https://juejin.im/post/5c1ca8df6fb9a049b347f55c" target="_blank" rel="noopener">JavaåŠ¨æ€ä»£ç†è¯¦è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> ç»“æ„å‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> ç»“æ„å‹æ¨¡å¼ </tag>
            
            <tag> ä»£ç†æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç­–ç•¥æ¨¡å¼</title>
      <link href="/2020/06/28/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/28/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h2><p>ç­–ç•¥æ¨¡å¼ä½¿ç”¨çš„å°±æ˜¯é¢å‘å¯¹è±¡çš„ç»§æ‰¿å’Œå¤šæ€æœºåˆ¶ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å®šä¹‰ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸ªç®—æ³•éƒ½å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬ä¹‹é—´å¯ä»¥äº’æ¢ã€‚</p><p><img src="/2020/06/28/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/strategy_class.jpeg" alt="ç­–ç•¥æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="Strategy-æŠ½è±¡ç­–ç•¥è§’è‰²"><a href="#Strategy-æŠ½è±¡ç­–ç•¥è§’è‰²" class="headerlink" title="Strategy æŠ½è±¡ç­–ç•¥è§’è‰²"></a>Strategy æŠ½è±¡ç­–ç•¥è§’è‰²</h4><p>ç­–ç•¥ç®—æ³•çš„æŠ½è±¡ï¼Œé€šå¸¸æ˜¯æ¥å£ï¼Œå®šä¹‰æ¯ä¸ªç­–ç•¥æˆ–è€…ç®—æ³•å¿…é¡»å…·æœ‰çš„æ–¹æ³•å’Œå±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ConcreteStrategy-å…·ä½“ç­–ç•¥è§’è‰²"><a href="#ConcreteStrategy-å…·ä½“ç­–ç•¥è§’è‰²" class="headerlink" title="ConcreteStrategy å…·ä½“ç­–ç•¥è§’è‰²"></a>ConcreteStrategy å…·ä½“ç­–ç•¥è§’è‰²</h4><p>å®ç°æŠ½è±¡ç­–ç•¥çš„å…·ä½“ç®—æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteStrategy1</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//Do Strategy1.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteStrategy2</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//Do Strategy2.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Context-å°è£…è§’è‰²"><a href="#Context-å°è£…è§’è‰²" class="headerlink" title="Context å°è£…è§’è‰²"></a>Context å°è£…è§’è‰²</h4><p>å°è£…ä¸Šä¸‹æ–‡ï¼Œå±è”½é«˜å±‚æ¨¡å—å¯¹ç­–ç•¥ã€ç®—æ³•çš„ç›´æ¥è®¿é—®ï¼Œå°è£…å¯èƒ½å­˜åœ¨çš„å˜åŒ–ã€‚<br>ç­–ç•¥æ¨¡å¼çš„é‡ç‚¹å°±æ˜¯å°è£…è§’è‰²ï¼Œå®ƒå€Ÿç”¨äº†ä»£ç†æ¨¡å¼çš„æ€è·¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Strategy strategy = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Context</span><span class="params">(Strategy strategy)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAny</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy.doSomething();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Strategy strategy = <span class="keyword">new</span> ConcreteStrategy1();</span><br><span class="line">Context context = <span class="keyword">new</span> Context(strategy);</span><br><span class="line">context.doAny(strategy);</span><br></pre></td></tr></table></figure><h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>ç®—æ³•å¯ä»¥è‡ªç”±åˆ‡æ¢<br>åªéœ€è¦å®ç°ç­–ç•¥æ¥å£ç±»ï¼Œé€šè¿‡å°è£…è§’è‰²å¯¹å…¶è¿›è¡Œå°è£…å³å¯ã€‚</li><li>é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶åˆ¤æ–­<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition1)&#123;</span><br><span class="line">   strategy1.<span class="keyword">do</span>();</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(condition2)&#123;</span><br><span class="line">   strategy2.<span class="keyword">do</span>();</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">// .....</span></span><br></pre></td></tr></table></figure></li><li>æ‰©å±•æ€§å¥½</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>ç­–ç•¥ç±»æ•°é‡å¤š</li><li>æ‰€æœ‰ç­–ç•¥ç±»éƒ½éœ€è¦å¯¹å¤–æš´éœ²<br>ä¸Šå±‚æ¨¡å—å¿…é¡»çŸ¥é“æœ‰å“ªäº›ç­–ç•¥ï¼Œ ç„¶åæ‰èƒ½å†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ï¼Œä¸è¿ªç±³ç‰¹æ³•åˆ™ç›¸è¿èƒŒã€‚<br>(è¿ªç±³ç‰¹æ³•åˆ™ï¼šä¸€ä¸ªç±»å¯¹äºå…¶ä»–ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½)</li></ul><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>å½“å…·ä½“çš„ç­–ç•¥æ•°é‡è¶…è¿‡ä¸€å®šä¸ªæ•°æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨æ··åˆæ¨¡å¼ï¼Œè§£å†³ç­–ç•¥ç±»è†¨èƒ€å’Œå¯¹å¤–æš´éœ²çš„é—®é¢˜ï¼Œå¦åˆ™ä¼šå¸¦æ¥å¾ˆå¤§çš„ç³»ç»Ÿç»´æŠ¤æˆæœ¬ã€‚</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>å¤šä¸ªç±»åªæœ‰åœ¨ç®—æ³•æˆ–è€…è¡Œä¸ºä¸Šç¨æœ‰ä¸åŒçš„åœºæ™¯</li><li>ç®—æ³•éœ€è¦è‡ªç”±åˆ‡æ¢çš„åœºæ™¯</li><li>éœ€è¦å±è”½ç®—æ³•è§„åˆ™çš„åœºæ™¯</li></ul><h3 id="ç­–ç•¥æšä¸¾"><a href="#ç­–ç•¥æšä¸¾" class="headerlink" title="ç­–ç•¥æšä¸¾"></a>ç­–ç•¥æšä¸¾</h3><p>å½“ç­–ç•¥æšä¸¾ä¸ç»å¸¸å‘ç”Ÿå˜åŒ–æ—¶å¯ä»¥ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> StrategyEnum &#123;</span><br><span class="line"></span><br><span class="line">    ADD(<span class="string">"+"</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">exec</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a + b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    SUB(<span class="string">"-"</span>) &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">exec</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a - b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String opt;</span><br><span class="line">    StrategyEnum(String opt) &#123;</span><br><span class="line">        <span class="keyword">this</span>.opt = opt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">exec</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è¡Œä¸ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è¡Œä¸ºå‹æ¨¡å¼ </tag>
            
            <tag> ç­–ç•¥æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯¹è±¡æ± æ¨¡å¼</title>
      <link href="/2020/06/24/%E5%AF%B9%E8%B1%A1%E6%B1%A0%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/24/%E5%AF%B9%E8%B1%A1%E6%B1%A0%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="å¯¹è±¡æ± æ¨¡å¼"><a href="#å¯¹è±¡æ± æ¨¡å¼" class="headerlink" title="å¯¹è±¡æ± æ¨¡å¼"></a>å¯¹è±¡æ± æ¨¡å¼</h2><p>ä¸€ç§ç‰¹æ®Šçš„å·¥å‚å¯¹è±¡ï¼Œä¸€ä¸ªå¯¹è±¡æ± åŒ…å«ä¸€ç»„å·²ç»åˆå§‹åŒ–è¿‡ä¸”å¯ä»¥ä½¿ç”¨çš„å¯¹è±¡ã€‚ç”¨æˆ·å¯ä»¥ä»æ± ä¸­å–å¾—å¯¹è±¡ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ“ä½œï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™å°†å…¶å½’è¿˜ç»™å¯¹è±¡æ± ã€‚</p><p>ä½¿ç”¨å¯¹è±¡æ± çš„ç›®çš„æ˜¯ä¸ºäº†æå‡æ€§èƒ½ï¼Œå½“éœ€è¦åˆ›å»ºæ¯”è¾ƒè€—è´¹æ—¶é—´çš„å¯¹è±¡æ—¶å°¤ä¸ºæ˜æ˜¾ã€‚</p><p><img src="/2020/06/24/%E5%AF%B9%E8%B1%A1%E6%B1%A0%E6%A8%A1%E5%BC%8F/object_pool.jpeg" alt="å¯¹è±¡æ± é€šç”¨ç±»å›¾"></p><h3 id="è§’è‰²å’ŒèŒè´£"><a href="#è§’è‰²å’ŒèŒè´£" class="headerlink" title="è§’è‰²å’ŒèŒè´£"></a>è§’è‰²å’ŒèŒè´£</h3><h4 id="å¯¹è±¡æ± çš„ç®¡ç†è€…"><a href="#å¯¹è±¡æ± çš„ç®¡ç†è€…" class="headerlink" title="å¯¹è±¡æ± çš„ç®¡ç†è€…"></a>å¯¹è±¡æ± çš„ç®¡ç†è€…</h4><p>ç®¡ç†è€…æ¥ç»´æŠ¤å¯¹è±¡æ± ï¼ŒåŒ…æ‹¬åˆå§‹åŒ–å¯¹è±¡æ± ã€æ‰©å……å¯¹è±¡æ± çš„å¤§å°ã€è·å–å¯¹è±¡æ—¶çš„ç­–ç•¥ã€é‡ç½®å½’è¿˜å¯¹è±¡çš„çŠ¶æ€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PoolMgr</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> init ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> max;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> factor;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Colection c; <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">          <span class="comment">//init</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ ¹æ®ç­–ç•¥æ¥åŠ¨æ€çš„ç”Ÿæˆå¯¹è±¡ã€‚ã€‚</span></span><br><span class="line">    <span class="comment">//å¦‚æœå¯¹è±¡ä¸è¶³å¯ä»¥å¢åŠ å¯¹è±¡æ± çš„å¯¹è±¡ï¼Œæˆ–è€…blockingç›´åˆ°æœ‰å¯¹è±¡é‡Šæ”¾ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">aquire</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> c.remove();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">release</span><span class="params">(Object o)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(o == <span class="keyword">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        reset(o);</span><br><span class="line">        c.add(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¯¹è±¡æ± çš„ä½¿ç”¨è€…"><a href="#å¯¹è±¡æ± çš„ä½¿ç”¨è€…" class="headerlink" title="å¯¹è±¡æ± çš„ä½¿ç”¨è€…"></a>å¯¹è±¡æ± çš„ä½¿ç”¨è€…</h4><p>ä½¿ç”¨è€…ä»ç®¡ç†è€…å¤„è·å–å¯¹è±¡ï¼Œä½¿ç”¨å®Œæˆåå¿…é¡»å½’è¿˜å¯¹è±¡é¿å…ä¸€è‡´å ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object o = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">   o = PoolMgr.getInstance();  </span><br><span class="line">&#125;finaly&#123;</span><br><span class="line">   PoolMgr.release(o);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>å¤ç”¨æ± ä¸­çš„å¯¹è±¡ï¼Œæ¶ˆé™¤åˆ›å»º/å›æ”¶å¯¹è±¡æ‰€äº§ç”Ÿçš„å†…å­˜å¼€é”€ï¼ŒCPUå¼€é”€ä»¥åŠIOå¼€é”€ã€‚<br>å¸¸è§çš„æœ‰ï¼šSocketçš„é“¾æ¥æ± ã€çº¿ç¨‹æ± ã€æ•°æ®åº“è¿æ¥æ± ç­‰ã€‚</p><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸­ï¼Œéœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œéœ€è¦åœ¨æ•°æ®ç»“æ„ä¸Šè¿›è¡ŒåŒæ­¥æˆ–è€…ä¸ºé”ç«äº‰äº§ç”Ÿé˜»å¡ï¼Œè¿™ç§å¼€é”€å¤„ç†ä¸å¥½ä¼šæ¯”åˆ›å»ºé”€æ¯ç‹¬äº«çš„å¼€é”€é«˜å¾ˆå¤šã€‚<br>ç”±äºæ± ä¸­çš„å¯¹è±¡æ•°é‡æœ‰é™ï¼Œå¯¹è±¡æ± å°å¯èƒ½ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œå¤ªå¤§å ç”¨å†…å­˜èµ„æºé«˜ï¼›<br>è½»é‡çº§å¯¹è±¡çš„åˆ›å»º/é”€æ¯ä¸éœ€è¦ä½¿ç”¨å¯¹è±¡æ± ï¼Œå¾’å¢ç³»ç»Ÿçš„å¤æ‚åº¦ï¼›</p><h2 id="Common-Pool2"><a href="#Common-Pool2" class="headerlink" title="Common Pool2"></a>Common Pool2</h2><p>Commons Pool2æ ¸å¿ƒéƒ¨åˆ†ç”±ä¸‰ä¸ªåŸºç¡€æ¥å£å’Œç›¸å…³çš„å®ç°ç±»å®ç°ï¼š</p><h3 id="PooledObject"><a href="#PooledObject" class="headerlink" title="PooledObject"></a>PooledObject</h3><p>æ± åŒ–å¯¹è±¡ï¼Œå¯¹æ± ä¸­çš„å¯¹è±¡è¿›è¡Œå°è£…ï¼Œå°è£…å¯¹è±¡çš„çŠ¶æ€å’Œä¸€äº›å…¶ä»–ä¿¡æ¯ã€‚<br>PooldedObject æœ‰ä¸¤ä¸ªå®ç°ç±»ï¼ŒDefaultPoolObjectæ—¶æ™®é€šé€šç”¨çš„å®ç°ï¼ŒPooledSoftReferenceä½¿ç”¨SoftReferenceå°è£…äº†å¯¹è±¡ï¼Œä¾›SoftReferenceObjectPoolä½¿ç”¨ã€‚</p><p><img src="/2020/06/24/%E5%AF%B9%E8%B1%A1%E6%B1%A0%E6%A8%A1%E5%BC%8F/pooledObject.jpeg" alt="æ± åŒ–å¯¹è±¡ç±»å›¾"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PooledObject</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Comparable</span>&lt;<span class="title">PooledObject</span>&lt;<span class="title">T</span>&gt;&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// è·å–å°è£…çš„å¯¹è±¡</span></span><br><span class="line">    <span class="function">T <span class="title">getObject</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹è±¡åˆ›å»ºçš„æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getCreateTime</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹è±¡ä¸Šæ¬¡å¤„äºæ´»åŠ¨çŠ¶æ€çš„æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getActiveTimeMillis</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹è±¡ä¸Šæ¬¡å¤„äºç©ºé—²çŠ¶æ€çš„æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getIdleTimeMillis</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹è±¡ä¸Šæ¬¡è¢«å€Ÿå‡ºçš„æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getLastBorrowTime</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹è±¡ä¸Šæ¬¡è¿”è¿˜çš„æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getLastReturnTime</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹è±¡ä¸Šæ¬¡ä½¿ç”¨çš„æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getLastUsedTime</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çŠ¶æ€ç½®ä¸º PooledObjectState.INVALID</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">invalidate</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´æ–° lastUseTime</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">use</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¯¹è±¡çŠ¶æ€</span></span><br><span class="line">    <span class="function">PooledObjectState <span class="title">getState</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çŠ¶æ€ç½®ä¸º PooledObjectState.ABANDONED</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">markAbandoned</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†çŠ¶æ€ç½®ä¸º PooledObjectState.RETURNING</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">markReturning</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PooledObjectFactory"><a href="#PooledObjectFactory" class="headerlink" title="PooledObjectFactory"></a>PooledObjectFactory</h3><p> æ± åŒ–å¯¹è±¡å·¥å‚ï¼Œè´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ã€é”€æ¯å’ŒéªŒè¯å·¥ä½œï¼ŒFactoryå¯¹è±¡ç”±ObjectPoolæŒæœ‰å¹¶ä½¿ç”¨ã€‚<br>å› ä¸ºå¯¹è±¡çš„åˆ›å»ºã€åˆå§‹åŒ–ã€é”€æ¯å’Œä»°æ­£çš„å·¥ä½œæ— æ³•é€šç”¨ï¼ŒCommons Pool2å¹¶æ²¡æœ‰æä¾›PooledObjectFactoryçš„é»˜è®¤å­ç±»å®ç°ï¼Œåªæä¾›äº†æŠ½è±¡å­ç±»BasePooledObjectFactory<br>å¯ä»¥å®ç°createå’Œwrapä¸¤ä¸ªæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PooledObjectFactory</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ± å¯¹è±¡</span></span><br><span class="line">    <span class="function">PooledObject&lt;T&gt; <span class="title">makeObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”€æ¯å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">destroyObject</span><span class="params">(PooledObject&lt;T&gt; p)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯å¯¹è±¡æ˜¯å¦å¯ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">validateObject</span><span class="params">(PooledObject&lt;T&gt; p)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¿€æ´»å¯¹è±¡ï¼Œä»æ± ä¸­å–å¯¹è±¡æ—¶ä¼šè°ƒç”¨æ­¤æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">activateObject</span><span class="params">(PooledObject&lt;T&gt; p)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é’åŒ–å¯¹è±¡ï¼Œå‘æ± ä¸­è¿”è¿˜å¯¹è±¡æ—¶ä¼šè°ƒç”¨æ­¤æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">passivateObject</span><span class="params">(PooledObject&lt;T&gt; p)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ObjectPool"><a href="#ObjectPool" class="headerlink" title="ObjectPool"></a>ObjectPool</h3><p> æŒæœ‰å¯¹è±¡å¹¶æä¾›å–/è¿˜ç­‰æ“ä½œ.</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> public interface ObjectPool&lt;T&gt; &#123;</span><br><span class="line">    &#x2F;&#x2F; ä»æ± ä¸­è·å–ä¸€ä¸ªå¯¹è±¡ï¼Œå®¢æˆ·ç«¯åœ¨ä½¿ç”¨å®Œå¯¹è±¡åå¿…é¡»ä½¿ç”¨ returnObject æ–¹æ³•è¿”è¿˜è·å–çš„å¯¹è±¡</span><br><span class="line">    T borrowObject() throws Exception, NoSuchElementException,</span><br><span class="line">            IllegalStateException;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; å°†å¯¹è±¡è¿”è¿˜åˆ°æ± ä¸­ã€‚å¯¹è±¡å¿…é¡»æ˜¯ä» borrowObject æ–¹æ³•è·å–åˆ°çš„</span><br><span class="line">    void returnObject(T obj) throws Exception;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ä½¿æ± ä¸­çš„å¯¹è±¡å¤±æ•ˆï¼Œå½“è·å–åˆ°çš„å¯¹è±¡è¢«ç¡®å®šæ— æ•ˆæ—¶ï¼ˆç”±äºå¼‚å¸¸æˆ–å…¶ä»–é—®é¢˜ï¼‰ï¼Œåº”è¯¥è°ƒç”¨è¯¥æ–¹æ³•</span><br><span class="line">    void invalidateObject(T obj) throws Exception;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; æ± ä¸­å½“å‰é—²ç½®çš„å¯¹è±¡æ•°é‡</span><br><span class="line">    int getNumIdle();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; å½“å‰ä»æ± ä¸­å€Ÿå‡ºçš„å¯¹è±¡çš„æ•°é‡</span><br><span class="line">    int getNumActive();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; æ¸…é™¤æ± ä¸­é—²ç½®çš„å¯¹è±¡</span><br><span class="line">    void clear() throws Exception, UnsupportedOperationException;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; å…³é—­è¿™ä¸ªæ± ï¼Œå¹¶é‡Šæ”¾ä¸ä¹‹ç›¸å…³çš„èµ„æº</span><br><span class="line">    void close();</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¯¹è±¡æ± é…ç½®"><a href="#å¯¹è±¡æ± é…ç½®" class="headerlink" title="å¯¹è±¡æ± é…ç½®"></a>å¯¹è±¡æ± é…ç½®</h3><p>å¯¹è±¡æ± é…ç½®æä¾›äº†å¯¹è±¡æ± åˆå§‹åŒ–æ‰€éœ€è¦çš„å‚æ•°ï¼ŒCommon Pool2ä¸­çš„åŸºç¡€é…ç½®ç±»æ—¶BaseObjectPoolConfig, æœ‰GenericObjectPoolConfigå’ŒGenericKeyedObjectPoolConfigï¼Œåˆ†åˆ«ä¸ºGenericObjectPoolå’ŒGenericKeyedObjectPoolä½¿ç”¨ã€‚</p><table><thead><tr><th>å‚æ•°</th><th>è§£é‡Š</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>lifo</td><td>è¿æ¥æ± å­˜æ”¾æ± å¯¹è±¡çš„æ–¹å¼ï¼› true:æ”¾åœ¨ç©ºé—²é˜Ÿåˆ—çš„å˜´é’±ä¹°å‘¢ï¼Œ false:æ”¾åœ¨ç©ºé—²é˜Ÿåˆ—çš„æœ€åé¢</td><td>true</td></tr><tr><td>fairness</td><td>ä»æ± ä¸­è·å–/è¿”è¿˜å¯¹è±¡æ—¶æ˜¯å¦ä½¿ç”¨å…¬å¹³é”æœºåˆ¶</td><td>false</td></tr><tr><td>maxWaitMillis</td><td>è·å–èµ„æºçš„ç­‰å¾…æ—¶é—´ã€‚blockWhenExhaustedä¸ºtrueæ—¶æœ‰æ•ˆã€‚-1ä»£è¡¨æ— æ—¶é—´é™åˆ¶ï¼Œä¸€è‡´é˜»å¡åˆ°æœ‰å¯ç”¨çš„èµ„æº</td><td></td></tr><tr><td>minEvictableIdleTimeMillis</td><td>å¯¹è±¡ç©ºé—²çš„æœ€å°æ—¶é—´ï¼Œæ‰“åˆ°æ­¤å€¼åç©ºé—²å¯¹è±¡å¯èƒ½ä¼šè¢«ç§»é™¤ï¼Œ-1è¡¨ç¤ºä¸ç§»é™¤</td><td>30åˆ†é’Ÿ</td></tr><tr><td>softMinEvictableIdletimeMillis</td><td>å¯¹è±¡ç©ºé—²çš„æœ€å°æ—¶é—´ï¼Œå¹¶ä¸”æ± ä¸­ä¹‹å°‘ä¿ç•™æœ‰minidleæ‰€æŒ‡å®šçš„ä¸ªæ•°</td><td></td></tr><tr><td>numTestsPerEvictionRun</td><td>èµ„æºå›æ”¶çº¿ç¨‹æ‰§è¡Œä¸€æ¬¡å›æ”¶æ“ä½œå›æ”¶èµ„æºçš„ä¸ªæ•°</td><td>3</td></tr><tr><td>evictionPolicyClassName</td><td>èµ„æºå›æ”¶ç­–ç•¥</td><td>org.apache.commons.pool2.impl.DefaultEvictionPolicy</td></tr><tr><td>testOnCreate</td><td>åˆ›å»ºå¯¹è±¡æ—¶æ˜¯å¦è°ƒç”¨factory.validateObject</td><td>false</td></tr><tr><td>testOnBorrow</td><td>è·å–å¯¹å½¢åŠ¿æ˜¯å¦è°ƒç”¨factory.validateObject</td><td>false</td></tr><tr><td>testOnReturn</td><td>è¿”è¿˜å¯¹è±¡æ—¶æ˜¯å¦è°ƒç”¨factory.validateObject</td><td>false</td></tr><tr><td>timeBetweenEvictionRunsMills</td><td>å›æ”¶èµ„æºçº¿ç¨‹çš„æ‰§è¡Œå‘¨æœŸï¼Œé»˜è®¤-1è¡¨ç¤ºä¸å¯ç”¨å›æ”¶èµ„æºçº¿ç¨‹</td><td>-1</td></tr><tr><td>blockWhenExhausted</td><td>èµ„æºè€—å°½æ—¶ï¼Œæ˜¯å¦é˜»å¡ç­‰å¾…è·å–èµ„æº</td><td>true</td></tr><tr><td>testWhileIdel</td><td>æ± ä¸­çš„é™åˆ¶å¯¹è±¡æ˜¯å¦ç”±é€å‡ºå™¨éªŒè¯ï¼Œæ— æ³•éªŒè¯çš„å¯¹è±¡å°†ä»æ± ä¸­åˆ é™¤é”€æ¯</td><td>false</td></tr></tbody></table><h3 id="æ± åŒ–å¯¹è±¡çš„çŠ¶æ€"><a href="#æ± åŒ–å¯¹è±¡çš„çŠ¶æ€" class="headerlink" title="æ± åŒ–å¯¹è±¡çš„çŠ¶æ€"></a>æ± åŒ–å¯¹è±¡çš„çŠ¶æ€</h3><table><thead><tr><th>å‚æ•°å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>IDEL</td><td>åœ¨æ± ä¸­ï¼Œå¤„äºç©ºé—²çŠ¶æ€</td></tr><tr><td>ALLOCATED</td><td>è¢«ä½¿ç”¨ä¸­</td></tr><tr><td>EVICTION</td><td>æ­£åœ¨è¢«é€å‡ºå™¨éªŒè¯</td></tr><tr><td>VALIDAITTON</td><td>æ­£åœ¨éªŒè¯</td></tr><tr><td>INVALID</td><td>é©±é€æµ‹è¯•æˆ–è€…éªŒè¯å¤±è´¥å¹¶å°†è¢«é”€æ¯</td></tr><tr><td>ABANDONED</td><td>å¯¹è±¡è¢«å®¢æˆ·ç«¯æ‹¿å‡ºåï¼Œé•¿æ—¶é—´æœªè¿”å›æ± ä¸­ï¼Œæˆ–è€…æ²¡æœ‰è°ƒç”¨useæ–¹æ³•ï¼Œè¢«æ ‡è®°ä¸ºæŠ›å¼ƒ</td></tr></tbody></table><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBufferFactory</span> <span class="keyword">extends</span> <span class="title">BasePooledObjectFactory</span>&lt;<span class="title">StringBuffer</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> StringBuffer <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è£…ä¸ºæ± åŒ–å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PooledObject&lt;StringBuffer&gt; <span class="title">wrap</span><span class="params">(StringBuffer buffer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DefaultPooledObject&lt;&gt;(buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å®Œè¿”è¿˜å¯¹è±¡æ—¶å°† StringBuffer æ¸…ç©º</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">passivateObject</span><span class="params">(PooledObject&lt;StringBuffer&gt; pooledObject)</span> </span>&#123;</span><br><span class="line">        pooledObject.getObject().setLength(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// åˆ›å»ºå¯¹è±¡æ± é…ç½®</span></span><br><span class="line">GenericObjectPoolConfig config = <span class="keyword">new</span> GenericObjectPoolConfig();</span><br><span class="line"><span class="comment">// åˆ›å»ºå¯¹è±¡å·¥å‚</span></span><br><span class="line">PooledObjectFactory factory = <span class="keyword">new</span> StringBufferFactory();</span><br><span class="line"><span class="comment">// åˆ›å»ºå¯¹è±¡æ± </span></span><br><span class="line">ObjectPool&lt;StringBuffer&gt; pool = <span class="keyword">new</span> GenericObjectPool&lt;&gt;(factory, config);</span><br><span class="line">StringReader in = <span class="keyword">new</span> StringReader(<span class="string">"abcdefg"</span>);</span><br><span class="line">StringBuffer buf = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ä»æ± ä¸­è·å–å¯¹è±¡</span></span><br><span class="line">    buf = pool.borrowObject();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> c = in.read(); c != -<span class="number">1</span>; c = in.read()) &#123;</span><br><span class="line">        buf.append((<span class="keyword">char</span>) c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> buf.toString();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å‡ºç°é”™è¯¯å°†å¯¹è±¡ç½®ä¸ºå¤±æ•ˆ</span></span><br><span class="line">        pool.invalidateObject(buf);</span><br><span class="line">        <span class="comment">// é¿å… invalidate ä¹‹åå† return æŠ›å¼‚å¸¸</span></span><br><span class="line">        buf = <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        <span class="comment">// ignored</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> e;</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        in.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// ignored</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != buf) &#123;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨å®Œåå¿…é¡» returnObject</span></span><br><span class="line">            pool.returnObject(buf);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// ignored</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<br><a href="https://zhuanlan.zhihu.com/p/36216932" target="_blank" rel="noopener">Apache Common Pool2 å¯¹è±¡æ± åº”ç”¨æµ…æ</a><br><a href="https://www.infoq.cn/article/2015/07/ClojureWerkz/" target="_blank" rel="noopener">ä¸€ä¸ªå¹¿ä¸ºäººçŸ¥ä½†é²œæœ‰äººç”¨çš„æŠ€å·§ï¼šå¯¹è±¡æ± </a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> åˆ›å»ºå‹æ¨¡å¼ </tag>
            
            <tag> å¯¹è±¡æ± æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸå‹æ¨¡å¼</title>
      <link href="/2020/06/24/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/24/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸå‹æ¨¡å¼"><a href="#åŸå‹æ¨¡å¼" class="headerlink" title="åŸå‹æ¨¡å¼"></a>åŸå‹æ¨¡å¼</h2><p>ä¸é€šè¿‡newå…³é”®å­—æ¥äº§ç”Ÿä¸€ä¸ªå¯¹è±¡ï¼Œè€Œé€šè¿‡å¯¹è±¡å¤åˆ¶æ¥ç”Ÿäº§å¯¹è±¡çš„æ¨¡å¼ï¼ŒåŸå‹æ¨¡å¼çš„æ ¸å¿ƒæ˜¯cloneæ–¹æ³•ï¼Œé€šè¿‡è¯¥æ–¹æ³•è¿›è¡Œå¯¹è±¡çš„æ‹·è´ã€‚</p><p>ä¹Ÿå°±æ˜¯å…ˆç”Ÿäº§å‡ºä¸€ä¸ªåŒ…å«å¤§é‡å…±æœ‰ä¿¡æ¯çš„ç±»å¯¹è±¡ï¼Œç„¶åæ‹·è´å‡ºå‰¯æœ¬ä¿®æ­£ç»†èŠ‚ä¿¡æ¯ï¼Œå»ºç«‹ä¸€ä¸ªå®Œæ•´çš„ä¸ªæ€§å¯¹è±¡ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”<code>é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡</code>ã€‚</p><p><img src="/2020/06/24/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/prototype.jpeg" alt="åŸå‹æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><ul><li>æ€§èƒ½å¥½<br>åŸå‹æ¨¡å¼æ˜¯å†…å­˜äºŒè¿›åˆ¶æµä¾§æ‹·è´ï¼Œè¦æ¯”ç›´æ¥newä¸€ä¸ªå¯¹è±¡æ€§èƒ½å¥½å¾ˆå¤šï¼Œç‰¹åˆ«åœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…äº§ç”Ÿå¤§é‡çš„å¯¹è±¡æ—¶ï¼ŒåŸå‹æ¨¡å¼å¯ä»¥æ›´å¥½çš„ä½“ç°å…¶ä¼˜ç‚¹ã€‚</li><li>é€ƒé¿æ„é€ å‡½æ•°çš„çº¦æŸ<br>ç›´æ¥åœ¨å†…å­˜ä¸­æ‹·è´ï¼Œæ„é€ å‡½æ•°ä¸ä¼šæ‰§è¡Œã€‚ä¼˜ç‚¹å’Œç¼ºç‚¹éƒ½æ˜¯å‡å°‘äº†çº¦æŸã€‚</li></ul><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><p>éœ€è¦é¢‘ç¹çš„newä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¯¥å¯¹è±¡éœ€è¦ç¹ççš„æ•°æ®å‡†å¤‡æ—¶ï¼›<br>ä¸€ä¸ªå¯¹è±¡è¦æä¾›ç»™å…¶ä»–å¯¹è±¡è®¿é—®ï¼Œå„ä¸ªè°ƒç”¨è€…å¯èƒ½éœ€è¦ä¿®æ”¹å…¶å€¼æ—¶ï¼›</p><p>åŸå‹æ¨¡å¼ä¸€èˆ¬ä¸å·¥å‚æ–¹æ³•æ¨¡å¼ä¸€èµ·å‡ºç°ï¼Œé€šè¿‡cloneçš„æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ï¼Œç„¶åç”±å·¥å‚æ–¹æ³•æä¾›ç»™è°ƒç”¨è€…ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrototypeClass</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PrototypeClass <span class="title">clone</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PrototypeClass p = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            p = (PrototypeClass)<span class="keyword">super</span>.clone();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(CloneNotSupportedException e)&#123;</span><br><span class="line">            <span class="comment">//TODO</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><h3 id="æ„é€ å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ"><a href="#æ„é€ å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ" class="headerlink" title="æ„é€ å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ"></a>æ„é€ å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ</h3><p>Objectç±»çš„cloneæ–¹æ³•åŸç†æ˜¯ä»å†…å­˜ä¸­ï¼ˆå †å†…å­˜ï¼‰ä»¥äºŒè¿›åˆ¶æµçš„æ–¹å¼è¿›è¡Œæ‹·è´ï¼Œé‡æ–°åˆ†é…ä¸€ä¸ªå†…å­˜å¿«ï¼Œæ„é€ å‡½æ•°æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ã€‚</p><h3 id="æµ…æ‹·è´"><a href="#æµ…æ‹·è´" class="headerlink" title="æµ…æ‹·è´"></a>æµ…æ‹·è´</h3><p>Objectç±»æä¾›çš„æ–¹æ³•cloneåªæ˜¯æ‹·è´æœ¬å¯¹è±¡ï¼Œå¯¹äºå…¶å†…éƒ¨çš„æ•°ç»„ã€å¼•ç”¨å¯¹è±¡éƒ½ä¸æ‹·è´è¿˜æ˜¯æŒ‡å‘åŸå£°å¯¹è±¡çš„å†…éƒ¨å…ƒç´ åœ°å€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrototypeClass</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt;String&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PrototypeClass <span class="title">clone</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PrototypeClass p = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">           p = (PrototypeClass) <span class="keyword">super</span>.clone();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(CloneNotSupportedException e) ) &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h3><p>æ·±æ‹·è´éœ€è¦æ‹·è´å¯¹è±¡è‡ªèº«å¤–ï¼Œè¿˜éœ€è¦æ‹·è´å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨çš„å¯¹è±¡ã€‚</p><p>é€šè¿‡cloneæ–¹å¼å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrototypeClass</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> ArrayList&lt;String&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PrototypeClass <span class="title">clone</span><span class="params">()</span></span>&#123;</span><br><span class="line">        PrototypeClass p = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">           p = (PrototypeClass) <span class="keyword">super</span>.clone();</span><br><span class="line">           p.arrayList = (ArrayList&lt;String&gt;) <span class="keyword">this</span>.arrayList.clone();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(CloneNotSupportedException e) ) &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡åºåˆ—åŒ–æ–¹å¼æ¥å®ç°ï¼Œé€šè¿‡åºåˆ—åŒ–å°†å¯¹è±¡(è¯¥å¯¹è±¡çš„ç±»å¿…é¡»å®ç°Serializableæ¥å£)å†™åˆ°ä¸€ä¸ªæµä¸­ï¼Œç„¶åå†ä»æµé‡ŒæŠŠå¯¹è±¡è¯»å‡ºæ¥ä»¥å®ç°æ·±å…‹éš†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Serializable&gt; <span class="function">T <span class="title">clone</span><span class="params">(T t)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">    ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(baos);</span><br><span class="line">    oos.writeObject(t);</span><br><span class="line"></span><br><span class="line">    ByteArrayInputStream bais = <span class="keyword">new</span> ByteArrayInputStream(baos.toByteArray());</span><br><span class="line">    ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(bais);</span><br><span class="line">    <span class="keyword">return</span> (T)ois.readObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="cloneä¸finalçš„å†²çª"><a href="#cloneä¸finalçš„å†²çª" class="headerlink" title="cloneä¸finalçš„å†²çª"></a>cloneä¸finalçš„å†²çª</h3><p>å½“ä½¿ç”¨cloneæ–¹æ³•çš„æ—¶å€™ï¼Œç±»çš„æˆå‘˜å˜é‡ä¸å¯ä»¥å¢åŠ finalå…³é”®å­—ã€‚</p><p>æ‹“å±•ï¼š<br><a href="https://www.cnblogs.com/fnlingnzb-learner/p/10649509.html" target="_blank" rel="noopener">Javaæé«˜ç¯‡â€”â€”å¯¹è±¡å…‹éš†ï¼ˆå¤åˆ¶ï¼‰</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> åˆ›å»ºå‹æ¨¡å¼ </tag>
            
            <tag> åŸå‹æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å»ºé€ è€…æ¨¡å¼</title>
      <link href="/2020/06/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="å»ºé€ è€…æ¨¡å¼"><a href="#å»ºé€ è€…æ¨¡å¼" class="headerlink" title="å»ºé€ è€…æ¨¡å¼"></a>å»ºé€ è€…æ¨¡å¼</h2><p>å»ºé€ è€…æ¨¡å¼ä¸å·¥å‚æ¨¡å¼å…³æ³¨ç‚¹ä¸åŒï¼Œå»ºé€ è€…æ¨¡å¼å…³æ³¨é›¶ä»¶çš„ç»„è£…è¿‡ç¨‹ï¼Œå·¥å‚æ¨¡å¼æ³¨é‡é›¶ä»¶çš„åˆ›å»ºè¿‡ç¨‹ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å»ºé€ è€…æ¨¡å¼ä¹Ÿå«ç”Ÿæˆå™¨æ¨¡å¼ï¼Œ å®ƒå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„å»ºé€ æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p><p><img src="/2020/06/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/creator.jpeg" alt="å»ºé€ è€…æ¨¡å¼é€šç”¨ç±»å›¾"></p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>å°è£…æ€§è‰¯å¥½<br>ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥ä½¿å¾—å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ã€‚</li><li>å»ºé€ è€…ç‹¬ç«‹ï¼Œæ˜“æ‰©å±•<br>ä¸åŒçš„å®ç°ç±»Builderæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå¯¹ç³»ç»Ÿçš„æ‰©å±•æœ‰åˆ©ã€‚</li><li>ä¾¿äºæ§åˆ¶ç»†èŠ‚é£é™©<br>ç”±äºå»ºé€ è€…ç‹¬ç«‹ï¼Œå› æ­¤å¯ä»¥ä¸ªæ€§åŒ–ï¼Œä¿®æ”¹ä¸€ä¸ªå»ºé€ è€…ä¸ä¼šå¯¹å…¶ä»–æ¨¡å—äº§ç”Ÿå½±å“ã€‚</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>äº§å“çš„ç»„æˆéƒ¨åˆ†å¿…é¡»ç›¸åŒï¼Œé™åˆ¶äº†å…¶ä½¿ç”¨èŒƒå›´</li><li>äº§å“å†…éƒ¨å˜åŒ–å¤æ‚æ—¶ï¼Œéœ€è¦å¢åŠ å¾ˆå¤šå»ºé€ è€…ç±»</li></ul><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>ç›¸åŒçš„æ–¹æ³•ï¼Œä¸åŒçš„æ‰§è¡Œé¡ºåºï¼Œäº§ç”Ÿä¸åŒçš„äº‹ä»¶ç»“æœæ—¶ï¼›</li><li>å¤šä¸ªéƒ¨ä»¶æˆ–è€…é›¶ä»¶éƒ½å¯ä»¥è£…é…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯äº§ç”Ÿçš„è¿è¡Œç»“æœä¸åŒæ—¶ï¼›</li><li>äº§å“ç±»éå¸¸å¤æ‚ï¼Œæˆ–è€…äº§å“ç±»ä¸­çš„è°ƒç”¨é¡ºåºä¸åŒäº§ç”Ÿäº†ä¸åŒçš„æ•ˆèƒ½ï¼›</li></ul><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="Product-äº§å“ç±»"><a href="#Product-äº§å“ç±»" class="headerlink" title="Product äº§å“ç±»"></a>Product äº§å“ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BuilderæŠ½è±¡å»ºé€ è€…"><a href="#BuilderæŠ½è±¡å»ºé€ è€…" class="headerlink" title="BuilderæŠ½è±¡å»ºé€ è€…"></a>BuilderæŠ½è±¡å»ºé€ è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setPart</span><span class="params">()</span></span>; <span class="comment">//è®¾ç½®ä¸ªæ€§éƒ¨åˆ†</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Product <span class="title">buildProduct</span><span class="params">()</span></span>;<span class="comment">//å»ºé€ äº§å“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ConcreteBuilder-å…·ä½“å»ºé€ è€…"><a href="#ConcreteBuilder-å…·ä½“å»ºé€ è€…" class="headerlink" title="ConcreteBuilder å…·ä½“å»ºé€ è€…"></a>ConcreteBuilder å…·ä½“å»ºé€ è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPart</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function">pbulic Product <span class="title">buildProduct</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Product();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Director-å¯¼æ¼”ç±»"><a href="#Director-å¯¼æ¼”ç±»" class="headerlink" title="Director å¯¼æ¼”ç±»"></a>Director å¯¼æ¼”ç±»</h3><p>å¯¼æ¼”ç±»èµ·åˆ°å°è£…çš„ä½œç”¨ï¼Œé¿å…é«˜å±‚æ¨¡å—æ·±å…¥åˆ°å»ºé€ è€…å†…éƒ¨çš„å®ç°ç±»ã€‚å½“å»ºé€ è€…æ¨¡å¼æ¯”è¾ƒåºå¤§æ—¶ï¼Œå¯¼æ¼”ç±»å¯ä»¥æœ‰å¤šä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Product <span class="title">buildProductA</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Builder b = <span class="keyword">new</span> ConcreteBuilder();</span><br><span class="line">    b.setPart();</span><br><span class="line">    <span class="keyword">return</span> b.buildProduct();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> åˆ›å»ºå‹æ¨¡å¼ </tag>
            
            <tag> å»ºé€ è€…æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰åç«¯åˆ†ç¦»</title>
      <link href="/2020/06/22/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/"/>
      <url>/2020/06/22/%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/</url>
      
        <content type="html"><![CDATA[<p>åŠ¨é™åˆ†ç¦»æŠ€æœ¯ï¼šCDNã€<br>è´Ÿè½½å‡è¡¡ï¼š<br>     å®ç°æ‰‹æ®µï¼š<br>     1ï¼‰ lvs / lb / å››å±‚æ•°æ®åŒ…ï¼Œ é€Ÿåº¦å¿«ï¼Œä¸è§£åŒ…ã€‚</p><pre><code>2ï¼‰   åå‘ä»£ç†ï¼ˆnginx ã€ Node.js ä¸ƒå±‚  URI/location å»ºç«‹ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¯·æ±‚ä¼ é€’ã€è½¬å‘      å­˜å‚¨ipã€è¯·æ±‚uriã€æ¬¡æ•°ã€æ—¶é—´ç­‰ï¼Œ     ï¼‰     Load Balance å¥åº·æ£€æŸ¥ç®—æ³•ï¼šéšæœºè½®è®­å“ˆå¸Œæœ€å°‘è¿æ¥æ•°æƒé‡/åŠ¨æ€æƒé‡</code></pre><p>å¤šçº§ç¼“å­˜<br>é˜²ç©¿é€</p><p>é™æµ<br>ç†”æ–­<br>é™çº§<br>ç°åº¦å‘å¸ƒ</p><p>æœåŠ¡æ— çŠ¶æ€ï¼šåˆ†å¸ƒå¼é—®é¢˜</p><p>update user set status = 2 where status = 1 and id = 1;</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æŠ½è±¡å·¥å‚æ¨¡å¼</title>
      <link href="/2020/06/22/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/22/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h2><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å‡çº§ç‰ˆæœ¬ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼åªç”Ÿäº§ä¸€ä¸ªç­‰çº§çš„äº§å“ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥ç”Ÿäº§å¤šä¸ªç­‰çº§çš„äº§å“ã€‚</p><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><p>äº§å“ç­‰çº§ï¼šä¸åŒäº§å“çš„ç§ç±»å°±æ˜¯ä¸åŒçš„äº§å“ç­‰çº§ï¼ˆç”µè§†æœºå’Œæ´—è¡£æœºå°±æ˜¯ä¸åŒçš„äº§å“ç­‰çº§ï¼‰<br>äº§å“æ—ï¼šä¸€ä¸ªå…·ä½“å·¥å‚ç”Ÿäº§çš„ä¸åŒç­‰çº§çš„äº§å“ï¼ˆå·¥å‚ç”Ÿäº§çš„ç”µè§†æœºå’Œæ´—è¡£æœºå±äºä¸€ä¸ªäº§å“æ—ï¼‰</p><p><img src="/2020/06/22/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/product_level.gif" alt="äº§å“ç­‰çº§å’Œäº§å“æ—"></p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä¸€ç§ä¸ºè®¿é—®ç±»æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç»„ç›¸å…³æˆ–è€…ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œä¸”è®¿é—®ç±»æ— éœ€æŒ‡å®šæ‰€éœ€è¦äº§å“çš„å…·ä½“ç±»å°±èƒ½å¾—åˆ°åŒæ—çš„ä¸åŒç­‰çº§çš„äº§å“ã€‚</p><p><img src="/2020/06/22/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/abstract_factory.jpeg" alt="æŠ½è±¡å·¥å‚æ¨¡å¼ç±»å›¾"></p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><p>1ï¼‰ å®¢æˆ·ç«¯ä¸ä¾èµ–äºäº§å“ç±»å®ä¾‹å¦‚ä½•è¢«åˆ›å»ºã€å®ç°<br>2ï¼‰ å¼ºè°ƒä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ï¼ˆåŒä¸€äº§å“æ—ï¼‰ä¸€èµ·ä½¿ç”¨åˆ›å»ºå¯¹è±¡éœ€è¦å¤§é‡çš„ä»£ç <br>3ï¼‰ æä¾›ä¸€ä¸ªäº§å“ç±»çš„åº“ï¼Œæ‰€æœ‰çš„äº§å“ä»¥åŒæ ·çš„æ¥å£å‡ºç°ï¼Œä»è€Œä½¿å®¢æˆ·ç«¯ä¸ä¾èµ–äºå…·ä½“å®ç°ã€‚<br>ä¸€ä¸ªå¯¹è±¡æ—éƒ½æœ‰ç›¸åŒçš„çº¦æŸï¼Œåˆ™å¯ä»¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="äº§å“è§’è‰²å®ç°"><a href="#äº§å“è§’è‰²å®ç°" class="headerlink" title="äº§å“è§’è‰²å®ç°"></a>äº§å“è§’è‰²å®ç°</h3><p>æŠ½è±¡äº§å“ï¼šProductï¼Œå®šä¹‰äº§å“çš„è§„èŒƒï¼Œæè¿°äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¤šä¸ªæŠ½è±¡äº§å“ã€‚<br>å…·ä½“äº§å“ï¼šConcreteProductï¼Œå®ç°æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œä¸å…·ä½“å·¥å‚ä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> Product&#123;</span><br><span class="line">    <span class="comment">//all product base filds &amp; methods.</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">on</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">off</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> AbstractTvProduct extends Product&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">switchChannel</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> AbstractFridgeProduct extends Product&#123;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">increaseTemp</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">decreaseTemp</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> HaierTVProduct extends AbstractTvProduct&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> HaierFridgeProduct extends AbstractFridgeProduct&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> TCLTVProduct extends AbstractTvProduct&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> TCLFridgeProduct extends AbstractFridgeProduct&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å·¥å‚è§’è‰²å®ç°"><a href="#å·¥å‚è§’è‰²å®ç°" class="headerlink" title="å·¥å‚è§’è‰²å®ç°"></a>å·¥å‚è§’è‰²å®ç°</h3><p>æŠ½è±¡å·¥å‚ï¼šAbstract Factoryï¼Œæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼ŒåŒ…å«å¤šä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³•,å¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒç­‰çº§çš„äº§å“ã€‚<br>å…·ä½“å·¥å‚ï¼šå®ç°æŠ½è±¡å·¥å‚ä¸­çš„å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="function">Product <span class="title">createTV</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Product <span class="title">createFridge</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HaierFactory</span> <span class="keyword">implements</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="function">Product <span class="title">createTV</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> HaierTVProduct();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Product <span class="title">createFridge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HaierFridgeProduct();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TCLFactory</span> <span class="keyword">implements</span> <span class="title">IFactory</span></span>&#123;</span><br><span class="line">    <span class="function">Product <span class="title">createTV</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> TCLTVProduct();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Product <span class="title">createFridge</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TCLFridgeProduct();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><ul><li>éš”ç¦»äº†å…·ä½“ç±»çš„ç”Ÿæˆï¼Œä½¿å¾—å®¢æˆ·å¹¶ä¸éœ€è¦çŸ¥é“ä»€ä¹ˆè¢«åˆ›å»ºï¼Œå…·æœ‰è‰¯å¥½çš„å°è£…æ€§ã€‚</li><li>å¦‚æœè¦æ‰©å±•äº§å“æ—ï¼ˆæœ‰æ–°çš„å·¥å‚è¦ç”Ÿäº§ç”µè§†å’Œå†°ç®±æ—¶ï¼‰çš„æ—¶å€™ï¼Œåªéœ€è¦å¢åŠ å…·ä½“çš„äº§å“ç±»å’Œå®ç°å·¥å‚æ–¹æ³•å³å¯ï¼ŒåŸæœ‰çš„ä»£ç ä¸éœ€è¦å˜åŠ¨ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li><li>å¦‚æœè¦æ‰©å±•äº§å“ç­‰çº§æ—¶ï¼Œä»æŠ½è±¡äº§å“åˆ°å·¥å‚ç±»ï¼ŒåŸæœ‰çš„ä»£ç éƒ½éœ€è¦å˜åŠ¨ï¼Œè¿èƒŒäº†å¼€é—­åŸåˆ™ã€‚</li></ul><p>å‚é˜…ï¼š<br><a href="http://c.biancheng.net/view/1351.html" target="_blank" rel="noopener">æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆè¯¦è§£ç‰ˆï¼‰</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> åˆ›å»ºå‹æ¨¡å¼ </tag>
            
            <tag> æŠ½è±¡å·¥å‚æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼IDç”Ÿæˆå™¨</title>
      <link href="/2020/06/20/%E5%88%86%E5%B8%83%E5%BC%8FID%E7%94%9F%E6%88%90%E5%99%A8/"/>
      <url>/2020/06/20/%E5%88%86%E5%B8%83%E5%BC%8FID%E7%94%9F%E6%88%90%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>1)èµ„æºé”ç»†ç²’åº¦åŒ–<br>  å°†100ä¸ªèµ„æºæ‹†åˆ†æˆ10ä»½ã€‚<br>  è¿™10ä»½åˆ†åˆ«ä¸Šé”ï¼Œåº”ç”¨åœºæ™¯å¦‚ç§’æ€ã€‚</p><p>2ï¼‰ä¸šåŠ¡ä½¿ç”¨é”ç»†ç²’åº¦åŒ–<br>   åªå¯¹éœ€è¦çš„èµ„æºåŠ é”ï¼Œé¿å…å¤§èŒƒå›´åŠ é”ã€‚</p><p>3ï¼‰æ— é”åŒ–ï¼ˆçœŸæ— é”ï¼Œå‡æ— é”ï¼‰<br>    ThreadLocal çœŸæ— é”<br>    CAS  å‡æ— é”<br>4ï¼‰å¼‚æ­¥+çº¿ç¨‹æ± <br>   Completeable</p><p> hystrix/sentinel é™æµ</p><p> Leaf / </p><p> Snowflake<br> ç¼ºç‚¹ï¼š<br> 1ï¼‰ä¾èµ–äºæ—¶é—´ï¼Œéœ€è¦ntp<br> 2ï¼‰ä¾èµ–äºNodeIdå’ŒAreaIDçš„åˆ†å‘ï¼Œç”¨ZKè§£å†³<br>   é€šè¿‡zkçš„é¡ºåºæ€§åˆ†é…å”¯ä¸€çš„nodeå’Œarea</p><p>åŸºäºMysqlçš„å‘å¸ƒ<br>åŸºäºMysqlçš„ä¼˜åŒ–</p><p>åŸºäºé›ªèŠ±ç®—æ³•</p><p>åŸºäºZK</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ </category>
          
          <category> IDç”Ÿæˆå™¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å‚æ–¹æ³•æ¨¡å¼</title>
      <link href="/2020/06/19/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/19/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h2><ul><li>new å¯¹è±¡çš„æ›¿ä»£æ–¹æ¡ˆ</li><li>éœ€è¦çµæ´»ã€å¯æ‰©å±•çš„æ¡†æ¶æ—¶</li><li>åœ¨å¼‚æ„é¡¹ç›®ä¸­ï¼Œä»å¤–éƒ¨äº§ç”Ÿçš„å¯¹è±¡</li><li>æµ‹è¯•é©±åŠ¨å¼€å‘æ¡†æ¶ä¸‹ä½¿ç”¨ã€‚<a href="https://www.jianshu.com/p/097d32d09713" target="_blank" rel="noopener">æµ‹è¯•é©±åŠ¨å¼€å‘ -TDD</a></li></ul><h2 id="å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å‚æ–¹æ³•æ¨¡å¼"></a>å·¥å‚æ–¹æ³•æ¨¡å¼</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚å·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚</p><p><img src="/2020/06/19/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/factory_comm.jpeg" alt="å·¥å‚æ–¹æ³•æ¨¡å¼çš„é€šç”¨ç±»å›¾"></p><p>æŠ½è±¡äº§å“ç±»Productè´Ÿè´£å®šä¹‰äº§å“çš„å…±æ€§ï¼Œå®ç°å¯¹äº‹ç‰©æœ€æŠ½è±¡çš„å®šä¹‰ï¼›<br>Creatorä¸ºæŠ½è±¡çš„åˆ›å»ºç±»ï¼Œå³æŠ½è±¡å·¥å‚ï¼Œå…·ä½“å¦‚ä½•åˆ›å»ºäº§å“ç±»æ˜¯ç”±å…·ä½“çš„å®ç°å·¥å‚ConcreteCreatorå®Œæˆçš„ã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>è‰¯å¥½çš„å°è£…ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œé™ä½æ¨¡å—é—´çš„è€¦åˆï¼›</li><li>è‰¯å¥½çš„æ‰©å±•æ€§ï¼›</li><li>å±è”½å…·ä½“çš„äº§å“ç±»ï¼Œåªè¦æ¥å£ä¸å˜ï¼Œç³»ç»Ÿä¸­ä¸Šå±‚æ¨¡å—å°±ä¸éœ€è¦å‘ç”Ÿå˜åŒ–ã€‚</li></ul><p>é«˜å±‚æ¨¡å—åªéœ€è¦çŸ¥é“äº§å“çš„æŠ½è±¡ç±»ï¼Œä¸å…³å¿ƒå®ç°ç±»ï¼Œç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™ï¼›<br>åªä¾èµ–äº§å“çš„æŠ½è±¡ï¼Œç¬¦åˆå€’ç½®åŸåˆ™ï¼›<br>ä½¿ç”¨äº§å“å­ç±»æ›¿æ¢çˆ¶ç±»æ—¶ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œç¬¦åˆé‡Œæ°æ›¿æ¢åŸåˆ™ï¼›</p><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å¯¹äºä¸åŒç±»å‹çš„äº§å“éƒ½è¦å¢åŠ ä¸åŒç±»å‹çš„å·¥å‚æ¥ç®¡ç†ï¼Œå¢åŠ ä»£ç çš„å¤æ‚æ€§</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="é€šç”¨å®ç°"><a href="#é€šç”¨å®ç°" class="headerlink" title="é€šç”¨å®ç°"></a>é€šç”¨å®ç°</h3><p>äº§å“ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product1</span> <span class="keyword">extends</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product2</span> <span class="keyword">extends</span> <span class="title">Product</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·¥å‚ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> &lt;T extends Product&gt; <span class="function">T <span class="title">create</span><span class="params">(Class&lt;T&gt; c)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteFactory</span> <span class="keyword">extends</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;T extends Product&gt; <span class="function">T <span class="title">create</span><span class="params">(Class&lt;T&gt; c)</span></span>&#123;</span><br><span class="line">        Product p = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            p = (Product)Class.forName(c.getName()).newInstance();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T)p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Factory factory &#x3D; new ConcreteFactory();</span><br><span class="line">Product p &#x3D; factory.createt(Product1.class);</span><br></pre></td></tr></table></figure><h3 id="ç¼©å°ä¸ºç®€å•å·¥å‚"><a href="#ç¼©å°ä¸ºç®€å•å·¥å‚" class="headerlink" title="ç¼©å°ä¸ºç®€å•å·¥å‚"></a>ç¼©å°ä¸ºç®€å•å·¥å‚</h3><p>å»æ‰æŠ½è±¡çš„Factoryç±»ï¼Œcreate()æ–¹æ³•å˜ä¸ºé™æ€æ–¹æ³•å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> Factory&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T extends Product&gt; <span class="function">T <span class="title">create</span><span class="params">(Class&lt;T&gt; c)</span></span>&#123;</span><br><span class="line">        Product p = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            p = (Product)Class.forName(c.getName()).newInstance();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T)p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Product p = Factory.create(Product1<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure><h3 id="å‡çº§ä¸ºå¤šä¸ªå·¥å‚ç±»"><a href="#å‡çº§ä¸ºå¤šä¸ªå·¥å‚ç±»" class="headerlink" title="å‡çº§ä¸ºå¤šä¸ªå·¥å‚ç±»"></a>å‡çº§ä¸ºå¤šä¸ªå·¥å‚ç±»</h3><p>é‡åˆ°å¤æ‚æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå·¥å‚ç±»åˆå§‹åŒ–éœ€è¦è€—è´¹å¾ˆå¤šèµ„æºï¼Œè¿™æ ·å¯ä»¥å°†å·¥å‚ç±»ç»†åŒ–æ‹†åˆ†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory1</span> <span class="keyword">extends</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Product <span class="title">create</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Product1();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Factory2</span> <span class="keyword">extends</span> <span class="title">Factory</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Product <span class="title">create</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Product2();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„å¥½å¤„æ˜¯èŒè´£æ¸…æ™°ï¼Œç»“æ„ç®€å•ï¼Œä½†æ˜¯å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§å·®äº†äº›ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå†å¢åŠ ä¸€ä¸ªåè°ƒç±»ï¼Œé¿å…è°ƒç”¨è€…ç›´æ¥ä¸å„ä¸ªå­å·¥å‚ç±»äº¤æµï¼Œåè°ƒç±»çš„ä½œç”¨æ˜¯å°è£…å­å·¥å‚ç±»ï¼Œå¯¹é«˜å±‚æ¨¡å—æä¾›ç»Ÿä¸€çš„è®¿é—®æ¥å£ã€‚</p><h3 id="æ›¿ä»£å•ä¾‹æ¨¡å¼"><a href="#æ›¿ä»£å•ä¾‹æ¨¡å¼" class="headerlink" title="æ›¿ä»£å•ä¾‹æ¨¡å¼"></a>æ›¿ä»£å•ä¾‹æ¨¡å¼</h3><p>é€šè¿‡åå°„çš„æ–¹å¼æ¥åˆ›å»ºå”¯ä¸€ä¸€ä¸ªå®ä¾‹</p><h3 id="å»¶è¿Ÿåˆå§‹åŒ–"><a href="#å»¶è¿Ÿåˆå§‹åŒ–" class="headerlink" title="å»¶è¿Ÿåˆå§‹åŒ–"></a>å»¶è¿Ÿåˆå§‹åŒ–</h3><p>ä¸€ä¸ªå¯¹è±¡è¢«ä½¿ç”¨å®Œæ¯•åï¼Œå¹¶ä¸ç«‹å³é‡Šæ”¾ï¼Œå·¥å‚ç±»ä¿æŒå…¶åˆå§‹çŠ¶æ€ï¼Œç­‰å¾…å†æ¬¡è¢«ä½¿ç”¨ã€‚</p><p>å»¶è¿ŸåŠ è½½æ¡†æ¶å¯ä»¥è¢«æ‰©å±•ä¸ºï¼Œé™åˆ¶æŸä¸ªäº§å“ç±»çš„æœ€å¤§å®ä¾‹åŒ–æ•°é‡ï¼ˆå¦‚é“¾æ¥æ± çš„æœ€å¤§é“¾æ¥æ•°é‡ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductFactory</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String,Product&gt; pMap = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Product <span class="title">createProduct</span><span class="params">(String type)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Product p = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(pMap.containsKey(type))&#123;</span><br><span class="line">            p = pMap.get(type);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(type.equals(<span class="string">"Product1"</span>))&#123;</span><br><span class="line">                p = <span class="keyword">new</span> Product1();</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                p = <span class="keyword">new</span> Product2();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> product;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚å·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚</p></blockquote><p><a href="https://www.zhihu.com/question/24843188" target="_blank" rel="noopener">https://www.zhihu.com/question/24843188</a></p><p><a href="https://www.jianshu.com/p/83ef48ce635b" target="_blank" rel="noopener">https://www.jianshu.com/p/83ef48ce635b</a></p><p><a href="https://blog.csdn.net/buyulian/article/details/79203880" target="_blank" rel="noopener">https://blog.csdn.net/buyulian/article/details/79203880</a></p><p><a href="https://blog.csdn.net/qianhaifeng2012/article/details/52014773" target="_blank" rel="noopener">https://blog.csdn.net/qianhaifeng2012/article/details/52014773</a></p><p><a href="https://www.cnblogs.com/aspirant/p/8980573.html" target="_blank" rel="noopener">https://www.cnblogs.com/aspirant/p/8980573.html</a></p><p><a href="http://www.akathink.com/2016/08/01/%E5%BD%BB%E5%BA%95%E6%90%9E%E6%87%82%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" target="_blank" rel="noopener">http://www.akathink.com/2016/08/01/%E5%BD%BB%E5%BA%95%E6%90%9E%E6%87%82%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</a></p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> åˆ›å»ºå‹æ¨¡å¼ </tag>
            
            <tag> å·¥å‚æ–¹æ³•æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•ä¾‹æ¨¡å¼</title>
      <link href="/2020/06/18/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/06/18/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><p>åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œè¦æ±‚ä¸€ä¸ªç±»æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœå‡ºç°å¤šä¸ªå¯¹è±¡å°±ä¼šå‡ºç°â€œæ··ä¹±â€ã€‚</p><ul><li>è¦æ±‚ç”Ÿæˆå”¯ä¸€åºå·çš„åœºæ™¯</li><li>æ•´ä¸ªé¡¹ç›®ä¸­éœ€è¦ä¸€ä¸ªå…±äº«æ•°æ®ï¼Œå¦‚è®¡æ•°å™¨</li><li>åˆ›å»ºå¯¹è±¡è¦æ¶ˆè€—è¿‡å¤šèµ„æºï¼ˆIOè®¿é—®æˆ–è€…æ•°æ®åº“èµ„æºç­‰ï¼‰</li><li>å®šä¹‰å¤§é‡çš„é™æ€å¸¸é‡å’Œé™æ€æ–¹æ³•çš„å·¥å…·ç±»</li></ul><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œè€Œä¸”è‡ªè¡Œå®ä¾‹åŒ–å¹¶ä¸”å‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ã€‚</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>å•ä¾‹æ¨¡å¼åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜å¼€æ”¯ã€‚<br>å½“ä¸€ä¸ªå¯¹è±¡éœ€è¦é¢‘ç¹åœ°åˆ›å»ºã€é”€æ¯æ—¶ï¼Œè€Œä¸”åˆ›å»ºæˆ–è€…é”€æ¯æ—¶çš„æ€§èƒ½æ— æ³•ä¼˜åŒ–æ—¶ï¼Œå•ä¾‹æ¨¡å¼çš„ä¼˜åŠ¿éå¸¸æ˜æ˜¾ã€‚</p><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>æ²¡æœ‰æ¥å£ï¼Œæ— æ³•æ‰©å±•ï¼Œæ²¡æœ‰æ¥å£ä¹Ÿä¸èƒ½ä½¿ç”¨Mockæ–¹å¼è™šæ‹Ÿå¯¹è±¡ã€‚<br>åœ¨å¹¶è¡Œå¼€å‘ç¯å¢ƒä¸­ï¼Œå•ä¾‹æ¨¡å¼æ²¡æœ‰å®Œæˆæ— æ³•è¿›è¡Œæµ‹è¯•ã€‚<br>ä¸å•ä¸€èŒè´£åŸåˆ™å†²çªï¼Œå•ä¾‹æ¨¡å¼æŠŠä¸šåŠ¡é€»è¾‘å’Œå•ä¾‹æ··åˆåœ¨ä¸€ä¸ªç±»ä¸­ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œå•ä¾‹æ¨¡å¼çš„çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚</p><h2 id="æå‰åŠ è½½"><a href="#æå‰åŠ è½½" class="headerlink" title="æå‰åŠ è½½"></a>æå‰åŠ è½½</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å»¶ååŠ è½½"><a href="#å»¶ååŠ è½½" class="headerlink" title="å»¶ååŠ è½½"></a>å»¶ååŠ è½½</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span></span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">         <span class="keyword">synchronized</span>(Singleton<span class="class">.<span class="keyword">class</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(instance == <span class="keyword">null</span>)&#123;</span><br><span class="line">                instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> instance;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Singleton&#123;</span><br><span class="line">    instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> åˆ›å»ºå‹æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> åˆ›å»ºå‹æ¨¡å¼ </tag>
            
            <tag> å•ä¾‹æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisé›†ç¾¤</title>
      <link href="/2020/06/18/Redis%E9%9B%86%E7%BE%A4/"/>
      <url>/2020/06/18/Redis%E9%9B%86%E7%BE%A4/</url>
      
        <content type="html"><![CDATA[<p>IDCæœºæˆ¿ç¡¬ä»¶è®¾å¤‡é€‰è´­æ–¹æ¡ˆ</p><p>1.1 ç”Ÿäº§ç¯å¢ƒä¸­é€‰è´­ä¾æ®</p><ul><li>ä»·æ ¼</li><li>æ€§èƒ½</li><li>å†—ä½™</li></ul><p>1.1.1 ç”Ÿäº§ç¯å¢ƒè´Ÿè½½å‡è¡¡ç³»ç»Ÿæ¶æ„è®¾å¤‡é€‰è´­æ–¹æ¡ˆ</p><p>   è´Ÿè½½å‡è¡¡ï¼š<br>   LVS1 DELL  R610 1U CPU E5<em>2 8G * 2/4  ç¡¬ç›˜ SAS 146 * 2  RAID1<br>   LVS2 DELL  R610 1U CPU E5</em>2 8G * 2/4  ç¡¬ç›˜ SAS 146 * 2  RAID1</p><p>1.1.2 Webå±‚ç¡¬ä»¶é€‰æ‹©RAID</p><p>   wwwä¸»ç«™1 ä¸šåŠ¡<em>2 DELL R730 2U CPU E5 * 2 8G(16G/32G) SAS 300G * 2  RAID0<br>   wwwä¸»ç«™2 ä¸šåŠ¡</em>2 DELL R730 2U CPU E5 * 2 8G(16G/32G) SAS 300G * 2  RAID0</p><p>1.1.3 æ•°æ®åº“å±‚ç¡¬ä»¶ä»¥åŠRAID</p><p>  Mysqlä¸»åº“1-1  DELL R730 2U CPU E5<em>2 8/16/32 SAS 300G * 6 RAID10(å…¼é¡¾å†—ä½™/é€Ÿåº¦ï¼‰<br>  Mysqlä¸»åº“1-2  DELL R730 2U CPU E5</em>2 8/16/32 SAS 300G * 6 RAID10(å…¼é¡¾å†—ä½™/é€Ÿåº¦ï¼‰<br>  Mysqlä»åº“1-1  DELL R730 2U CPU E5<em>2 8/16/32 SAS 300G * 6 RAID0/5<br>  Mysqlä»åº“1-2  DELL R730 2U CPU E5</em>2 8/16/32 SAS 300G * 6 RAID0/5<br>  Mysqlä»åº“2-1  DELL R730 2U CPU E5<em>2 8/16/32 SAS 300G * 6 RAID0/5<br>  Mysqlä»åº“2-2  DELL R730 2U CPU E5</em>2 8/16/32 SAS 300G * 6 RAID0/5</p><p>1.1.4 å­˜å‚¨å±‚ç¡¬ä»¶ä»¥åŠRAID</p><p>DELL R610 E5 * 2 16/32G SAS 10K 2T * 6 ä¸åšRAIDäº¤å‰å¤‡ä»½/ RAID5<br>DELL R730 E5 * 2 16/32G SAS 10K 2T * 6 RAID5æŠ˜ä¸­æ–¹æ¡ˆ</p><p>å¤‡ä»½æœåŠ¡å™¨ä¸€èˆ¬è€ƒè™‘å®¹é‡å’Œå†—ä½™ï¼Œå¯¹æ€§èƒ½è¦æ±‚ä¸é«˜ã€‚</p><p>1.1.5 NFSç¡¬ä»¶ä»¥åŠRAID</p><p>NFS1 DELL R730 E5 8G * 2 SAS 15K  600G * 6  RAID10/RAID5/RAID0<br>NFS2 DELL R730 E5 8G * 2 SAS 15K  600G * 6  RAID10/RAID5/RAID0    </p><p>1.1.6 GFSã€MFSåˆ†å¸ƒå¼å­˜å‚¨</p><p>NFS1 DELL R730 E5 8G * 2 SAS 15K  600G * 6  RAID10/RAID5/RAID0<br>NFS2 DELL R730 E5 8G * 2 SAS 15K  600G * 6  RAID10/RAID5/RAID0   </p><p>1.1.7 ç›‘æ§ç®¡ç†/ç½‘å…³å±‚ç¡¬ä»¶ä»¥åŠRAID</p><p>DELL R610/R430 E5*1 8/16G 146 SAS * 2 RAID1</p><p>1.1.8 ç½‘ç»œè®¾å¤‡</p><p>å…¨åƒå…†è®¾å¤‡/ç½‘çº¿<br>åä¸º H3C  CISCO DLINK </p><div class="note grey"><p>éƒ½éœ€è¦å¸¦æœ‰è¿œç¨‹ç®¡ç†å¡ 4+1</p></div><h2 id="Redisæ­å»º"><a href="#Redisæ­å»º" class="headerlink" title="Redisæ­å»º"></a>Redisæ­å»º</h2><p>ä¸»æœºè§„åˆ’ï¼š</p><table><thead><tr><th>åºå·</th><th>ä¸»æœºåç§°</th><th>è§’è‰²</th><th>æ•°é‡</th><th>IPå†…ç½‘</th><th>IPå¤–ç½‘</th><th>ç«¯å£</th><th>è½¯ä»¶</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>1</td><td>Redis-Master-01</td><td>Node01</td><td>1</td><td>10.0.0.1</td><td></td><td>6379</td><td>Centos7.7</td><td>â€“</td></tr><tr><td>1</td><td>Redis-Master-02</td><td>Node02</td><td>1</td><td>10.0.0.2</td><td></td><td>6379</td><td>Centos7.7</td><td>â€“</td></tr><tr><td>1</td><td>Redis-Master-03</td><td>Node03</td><td>1</td><td>10.0.0.3</td><td></td><td>6379</td><td>Centos7.7</td><td>â€“</td></tr><tr><td>1</td><td>Redis-slave-01</td><td>slave01</td><td>1</td><td>10.0.0.4</td><td></td><td>6389</td><td>Centos7.7</td><td>â€“</td></tr><tr><td>1</td><td>Redis-slave-02</td><td>slave02</td><td>1</td><td>10.0.0.5</td><td></td><td>6389</td><td>Centos7.7</td><td>â€“</td></tr><tr><td>1</td><td>Redis-slave-03</td><td>slave03</td><td>1</td><td>10.0.0.6</td><td></td><td>6389</td><td>Centos7.7</td><td>â€“</td></tr></tbody></table><p><br><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bind 10.0.0.1</span><br><span class="line">port 6379</span><br><span class="line">pidfile &#x2F;var&#x2F;run&#x2F;redis_7000.pid</span><br><span class="line">cluster-enabled yes</span><br><span class="line">daemonize yes</span><br><span class="line">cluster-config-file  nodes-63679.conf </span><br><span class="line">appendonly yes</span><br></pre></td></tr></table></figure><h3 id="ESå®‰è£…"><a href="#ESå®‰è£…" class="headerlink" title="ESå®‰è£…"></a>ESå®‰è£…</h3><p>cd /etc/yum.repos.d/<br>vim elasticsearcg.repo<br>yum makecache &amp;&amp; yum install -y elasticsearch</p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
          <category> é›†ç¾¤éƒ¨ç½² </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼å’ŒåŸåˆ™</title>
      <link href="/2020/06/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%8E%9F%E5%88%99/"/>
      <url>/2020/06/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<p>åˆ›å»ºè½¯ä»¶åº”ç”¨ç¨‹åºæ—¶ä¸ºäº†æ»¡è¶³ä¸æ–­å˜åŒ–å’Œå‘å±•çš„éœ€æ±‚ï¼Œä¸€ä¸ªæˆåŠŸçš„åº”ç”¨ç¨‹åºåº”è¯¥æä¾›ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥æ‰©å±•å®ƒä»¥æ»¡è¶³ä¸æ–­å˜åŒ–çš„æœŸæœ›ã€‚</p><h2 id="SOLIDè®¾è®¡åŸåˆ™"><a href="#SOLIDè®¾è®¡åŸåˆ™" class="headerlink" title="SOLIDè®¾è®¡åŸåˆ™"></a>SOLIDè®¾è®¡åŸåˆ™</h2><h3 id="å•ä¸€èŒè´£åŸåˆ™"><a href="#å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™"></a>å•ä¸€èŒè´£åŸåˆ™</h3><p>æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªåŸå› å¼•èµ·ç±»çš„å˜æ›´ã€‚</p><p>é—®é¢˜ï¼š<br>Class IUser è´Ÿè´£ä¸¤ä¸ªä¸åŒçš„èŒè´£,èŒè´£1ç»´æŠ¤Userçš„å±æ€§(id, name, age)ï¼ŒèŒè´£2ç»´æŠ¤DBæ“ä½œï¼ˆsave/update/delete/findï¼‰.<br>å½“ç”±äºèŒè´£1éœ€æ±‚å‘ç”Ÿæ”¹å˜è¦å¢åŠ ä¸€ä¸ªsexçš„æ—¶å€™ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´åŸæœ¬è¿è¡Œæ­£å¸¸çš„èŒè´£2åŠŸèƒ½å‘ç”Ÿæ•…éšœã€‚</p><p>è§£å†³æ–¹æ³•ï¼š<br>å°†IUseræ‹†åˆ†ä¸º UserInfoå’ŒUserDaoã€‚</p><p>ä¼˜ç‚¹ï¼š<br>é™ä½ç±»çš„å¤æ‚æ€§ï¼Œä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ï¼›<br>æé«˜ç±»çš„å¯è¯»æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ï¼›<br>é™ä½å˜æ›´å¼•èµ·çš„é£é™©ï¼Œå½“ä¿®æ”¹ä¸€ä¸ªæ¥å£çš„åŠŸèƒ½æ—¶ï¼Œå¯ä»¥é™ä½å¯¹å…¶ä»–åŠŸèƒ½çš„å½±å“ã€‚</p><h3 id="å¼€é—­åŸåˆ™"><a href="#å¼€é—­åŸåˆ™" class="headerlink" title="å¼€é—­åŸåˆ™"></a>å¼€é—­åŸåˆ™</h3><p>ä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚<br>ä¹Ÿå°±æ˜¯è¯´é€šè¿‡æ‰©å±•æ¥å®ç°å˜åŒ–ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¿®æ”¹å·²æœ‰çš„ä»£ç æ¥å®ç°å˜åŒ–ã€‚</p><p>å¯ä»¥é€šè¿‡æŠ½è±¡çº¦æŸã€å°è£…å˜åŒ–æ¥å®ç°å¼€é—­åŸåˆ™ã€‚<br>é€šè¿‡æ¥å£æˆ–è€…æŠ½è±¡ç±»ä¸ºè½¯ä»¶å®ä½“å®šä¹‰ä¸€ä¸ªç›¸å¯¹ç¨³å®šçš„æŠ½è±¡å±‚ï¼Œè€Œå°†ç›¸åŒçš„å¯å˜å› ç´ å°è£…åœ¨ç›¸åŒçš„å…·ä½“å®ç°ç±»ä¸­ã€‚</p><h3 id="é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="é‡Œæ°æ›¿æ¢åŸåˆ™"></a>é‡Œæ°æ›¿æ¢åŸåˆ™</h3><p>æ´¾ç”Ÿç±»å‹å¿…é¡»å®Œå…¨å¯æ›¿ä»£å…¶åŸºç±»å‹ã€‚åœ¨è®¾è®¡æ¨¡å—å’Œç±»æ—¶ï¼Œå¿…é¡»ç¡®ä¿æ´¾ç”Ÿç±»å‹ä»è¡Œä¸ºçš„è§’åº¦æ¥çœ‹æ˜¯å¯æ›¿ä»£çš„ã€‚å½“æ´¾ç”Ÿç±»å‹è¢«å…¶çˆ¶ç±»æ›¿æ¢æ—¶ï¼Œå…¶ä½™ä»£ç å°±åƒå®ƒæ˜¯è‡ªç±»å‹é‚£æ ·ä½¿ç”¨å®ƒã€‚</p><ul><li>å­ç±»å¿…é¡»å®Œå…¨å®ç°çˆ¶ç±»çš„æ–¹æ³•</li><li>å­ç±»å¯ä»¥æœ‰è‡ªå·±çš„ä¸ªæ€§</li><li>è¦†ç›–æˆ–è€…å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œè¾“å…¥å‚æ•°å¯ä»¥è¢«æ”¾å¤§</li><li>è…¹æ³»æˆ–è€…å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œè¾“å‡ºç»“æœå¯ä»¥è¢«ç¼©å°</li></ul><h3 id="æ¥å£éš”ç¦»åŸåˆ™"><a href="#æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="æ¥å£éš”ç¦»åŸåˆ™"></a>æ¥å£éš”ç¦»åŸåˆ™</h3><p>å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–äºå®ƒæ‰€ä¸éœ€è¦çš„æ¥å£ã€‚æ¥å£éš”ç¦»åŸåˆ™å‡å°‘äº†ä»£ç è€¦åˆï¼Œä½¿è½¯ä»¶æ›´å¼ºå£®ï¼Œæ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚æ¥å£éš”ç¦»åŸåˆ™è¦æ±‚æ¥å£çš„å®šä¹‰å’Œè®¾è®¡å°½é‡çš„ç»†åŒ–ã€‚</p><ul><li>æ¥å£å°½é‡å°ï¼Œä½†æ˜¯è¦æœ‰é™åº¦ã€‚<br>å¯¹æ¥å£è¿›è¡Œç»†åŒ–å¯ä»¥æé«˜ç¨‹åºè®¾è®¡çš„çµæ´»æ€§ï¼Œä½†æ˜¯å¦‚æœè¿‡å°ï¼Œä¼šé€ æˆæ¥å£æ•°é‡è¿‡å¤šï¼Œä½¿è®¾è®¡å¤æ‚åŒ–ã€‚</li><li>ä¸ºä¾èµ–æ¥å£çš„ç±»å®šåˆ¶æœåŠ¡ï¼Œåªæš´éœ²ç»™è°ƒç”¨çš„ç±»å®ƒéœ€è¦çš„æ–¹æ³•ï¼Œä¸éœ€è¦çš„æ–¹æ³•éšè—èµ·æ¥ï¼Œåªæœ‰ä¸“æ³¨åœ°ä¸ºä¸€ä¸ªæ¨¡å—æä¾›å®šåˆ¶æœåŠ¡ï¼Œæ‰èƒ½å»ºç«‹æœ€å°ä¾èµ–å…³ç³»ã€‚</li><li>æé«˜å†…èšï¼Œå‡å°‘å¯¹å¤–äº¤äº’ã€‚ä½¿æ¥å£ç”¨æœ€å°‘çš„æ–¹æ³•å®Œæˆæœ€å¤šçš„äº‹æƒ…ã€‚</li></ul><h3 id="ä¾èµ–å€’ç½®åŸåˆ™"><a href="#ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="ä¾èµ–å€’ç½®åŸåˆ™"></a>ä¾èµ–å€’ç½®åŸåˆ™</h3><p>é«˜çº§æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½çº§æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚<br>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</p><ul><li>æ¨¡å—é—´çš„ä¾èµ–é€šè¿‡æŠ½è±¡å‘ç”Ÿï¼Œå®ç°ç±»ä¹‹é—´ä¸å‘ç”Ÿç›´æ¥çš„ä¾èµ–å…³ç³»ï¼Œå™¨ä¾èµ–å…³ç³»æ˜¯é€šè¿‡æ¥å£æˆ–è€…æŠ½è±¡ç±»äº§ç”Ÿã€‚</li><li>æ¥å£æˆ–è€…æŠ½è±¡ç±»ä¸ä¾èµ–å®ç°ç±»</li><li>å®ç°ç±»ä¾èµ–æ¥å£æˆ–è€…æŠ½è±¡ç±»</li></ul><h2 id="åˆ›å»ºå‹æ¨¡å¼-6-6"><a href="#åˆ›å»ºå‹æ¨¡å¼-6-6" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼(6/6)"></a>åˆ›å»ºå‹æ¨¡å¼(6/6)</h2><ul><li><a href="/2020/06/18/å•ä¾‹æ¨¡å¼">å•ä¾‹æ¨¡å¼</a></li><li><a href="/2020/06/19/å·¥å‚æ–¹æ³•æ¨¡å¼">å·¥å‚æ–¹æ³•æ¨¡å¼</a></li><li><a href="/2020/06/22/æŠ½è±¡å·¥å‚æ¨¡å¼">æŠ½è±¡å·¥å‚æ¨¡å¼</a></li><li><a href="/2020/06/23/å»ºé€ è€…æ¨¡å¼">å»ºé€ è€…æ¨¡å¼</a></li><li><a href="/2020/06/24/åŸå‹æ¨¡å¼">åŸå‹æ¨¡å¼</a></li><li><a href="/2020/06/24/å¯¹è±¡æ± æ¨¡å¼">å¯¹è±¡æ± æ¨¡å¼</a></li></ul><h2 id="è¡Œä¸ºå‹æ¨¡å¼-12-12"><a href="#è¡Œä¸ºå‹æ¨¡å¼-12-12" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼(12/12)"></a>è¡Œä¸ºå‹æ¨¡å¼(12/12)</h2><ul><li><a href="/2020/06/28/ç­–ç•¥æ¨¡å¼/">ç­–ç•¥æ¨¡å¼</a></li><li><a href="/2020/06/29/çŠ¶æ€æ¨¡å¼/">çŠ¶æ€æ¨¡å¼</a></li><li><a href="/2020/06/30/è®¿é—®è€…æ¨¡å¼/">è®¿é—®è€…æ¨¡å¼</a> </li><li><a href="/2020/07/01/è¿­ä»£å™¨æ¨¡å¼/">è¿­ä»£å™¨æ¨¡å¼</a></li><li><a href="/2020/07/02/è´£ä»»é“¾æ¨¡å¼/">è´£ä»»é“¾æ¨¡å¼</a></li><li><a href="/2020/07/02/æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼/">æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</a></li><li><a href="/2020/07/03/å‘½ä»¤æ¨¡å¼/">å‘½ä»¤æ¨¡å¼</a></li><li><a href="/2020/07/04/å¤‡å¿˜å½•æ¨¡å¼/">å¤‡å¿˜å½•æ¨¡å¼</a></li><li><a href="/2020/07/05/è§£é‡Šå™¨æ¨¡å¼/">è§£é‡Šå™¨æ¨¡å¼</a></li><li><a href="/2020/07/07/è§‚å¯Ÿè€…æ¨¡å¼/">è§‚å¯Ÿè€…æ¨¡å¼</a></li><li><a href="/2020/07/06/ä¸­ä»‹è€…æ¨¡å¼/">ä¸­ä»‹è€…æ¨¡å¼</a></li><li><a href="/2020/07/06/ç©ºå¯¹è±¡æ¨¡å¼/">ç©ºå¯¹è±¡æ¨¡å¼</a></li></ul><h2 id="ç»“æ„å‹æ¨¡å¼-7-7"><a href="#ç»“æ„å‹æ¨¡å¼-7-7" class="headerlink" title="ç»“æ„å‹æ¨¡å¼(7/7)"></a>ç»“æ„å‹æ¨¡å¼(7/7)</h2><ul><li><a href="/2020/06/28/ä»£ç†æ¨¡å¼/">ä»£ç†æ¨¡å¼</a></li><li><a href="/2020/07/01/ç»„åˆæ¨¡å¼/">ç»„åˆæ¨¡å¼</a></li><li><a href="/2020/07/08/è£…é¥°å™¨æ¨¡å¼/">è£…é¥°å™¨æ¨¡å¼</a></li><li><a href="/2020/07/09/æ¡¥æ¥æ¨¡å¼/">æ¡¥æ¥æ¨¡å¼</a></li><li><a href="/2020/07/10/é€‚é…å™¨æ¨¡å¼/">é€‚é…å™¨æ¨¡å¼</a> </li><li><a href="/2020/07/11/é—¨é¢æ¨¡å¼/">é—¨é¢æ¨¡å¼</a></li><li><a href="/2020/07/12/äº«å…ƒæ¨¡å¼/">äº«å…ƒæ¨¡å¼</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
          <category> è®¾è®¡åŸåˆ™ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
            <tag> è®¾è®¡åŸåˆ™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨JVMå‚æ•°</title>
      <link href="/2020/06/17/%E5%B8%B8%E7%94%A8JVM%E5%8F%82%E6%95%B0/"/>
      <url>/2020/06/17/%E5%B8%B8%E7%94%A8JVM%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>HotSpot è™šæ‹Ÿæœºå¸¸ç”¨é…ç½®</p><table><thead><tr><th>é…ç½®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-Xms1g</td><td>æœ€å°å †å†…å­˜</td></tr><tr><td>-Xmx4g</td><td>æœ€å¤§å †å†…å­˜</td></tr><tr><td>-XX:+UseG1GC</td><td>ä½¿ç”¨G1åƒåœ¾å›æ”¶å™¨</td></tr><tr><td>-Xss256k</td><td>æ¯ä¸ªçº¿ç¨‹æ ˆå¤§å°256k</td></tr><tr><td>-XX:MetaspaceSize=256m</td><td>å…ƒæ•°æ®åŒºå¤§å°256M</td></tr><tr><td>-XX:MaxMetaspaceSize=256m</td><td>å…ƒæ•°æ®åŒºæœ€å¤§256M</td></tr><tr><td>-XX:MaxGCPauseMillis=500</td><td>GCæœ€å¤§åœé¡¿æ¯«ç§’æ•°</td></tr><tr><td>-XX:+DisableExplicitGC</td><td>ç¦ç”¨ä»£ç ä¸­æ˜¾å¼è°ƒç”¨GCï¼ŒSystem.gc()å°†ä¼šå¤±æ•ˆ</td></tr><tr><td>-XX:+UnlockExperimentalVMOptions</td><td>è§£é”å®éªŒå‚æ•°</td></tr><tr><td>-XX:+UseStringDeduplication</td><td>GCçš„åŒæ—¶åšé‡å¤å­—ç¬¦ä¸²æ¶ˆé™¤ï¼Œåªç”¨äºG1</td></tr><tr><td>-XX:InitiatingHeapOccupancyPercent=60</td><td>å¯åŠ¨å¹¶å‘GCå‘¨æœŸæ—¶çš„å †å†…å­˜å ç”¨ç™¾åˆ†æ¯”. G1ä¹‹ç±»çš„åƒåœ¾æ”¶é›†å™¨ç”¨å®ƒæ¥è§¦å‘å¹¶å‘GCå‘¨æœŸ,åŸºäºæ•´ä¸ªå †çš„ä½¿ç”¨ç‡,è€Œä¸åªæ˜¯æŸä¸€ä»£å†…å­˜çš„ä½¿ç”¨æ¯”. å€¼ä¸º 0 åˆ™è¡¨ç¤ºâ€ä¸€ç›´æ‰§è¡ŒGCå¾ªç¯â€. é»˜è®¤å€¼ä¸º 45.</td></tr><tr><td>-XX:ParallelGCThreads=8</td><td>è®¾ç½®åƒåœ¾æ”¶é›†å™¨åœ¨å¹¶è¡Œé˜¶æ®µä½¿ç”¨çš„çº¿ç¨‹æ•°,é»˜è®¤å€¼éšJVMè¿è¡Œçš„å¹³å°ä¸åŒè€Œä¸åŒ.</td></tr><tr><td>-XX:G1MixedGCCountTarget=4</td><td>è®¾ç½®åœ¨æ ‡è®°å‘¨æœŸå®Œæˆä¹‹åæ··åˆæ”¶é›†çš„æ•°é‡ï¼Œä»¥ç»´æŒold regionï¼ˆä¹Ÿå°±æ˜¯è€å¹´ä»£ï¼‰ä¸­ï¼Œæœ€å¤šæœ‰G1MixedGCLiveThresholdPercentçš„å­˜æ´»å¯¹è±¡ã€‚é»˜è®¤å€¼ä¸º8ï¼Œæ··åˆæ”¶é›†çš„æ•°é‡å°†ç»´æŒåœ¨è¿™ä¸ªå€¼ä¹‹å†…ã€‚ï¼ˆJVM build &gt; 23ï¼‰</td></tr><tr><td>-XX:MaxTenuringThreshold=7</td><td>å¹´è€ä»£çš„æœ€å¤§ä¸´ç•Œå€¼(tenuring threshold). é»˜è®¤å€¼ä¸º 15.</td></tr><tr><td>-XX:+UseGCLogFileRotation</td><td>æ»šåŠ¨è®°å½•GCæ—¥å¿—æ–‡ä»¶</td></tr><tr><td>-XX:NumberOfGCLogFiles=5</td><td>GCæ—¥å¿—æ–‡ä»¶æ•°é‡ä¸º5ä¸ª</td></tr><tr><td>-XX:GCLogFileSize=64M</td><td>å•ä¸ªGCæ—¥å¿—æ–‡ä»¶å¤§å°64M</td></tr><tr><td>-Xloggc:/app/data/logs/gc-<code>date +%Y%m%d-%H-%M</code>.log</td><td>GCæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç›®å½•å’Œåç§°</td></tr><tr><td>-XX:+PrintGCDetails</td><td>æ‰“å°GCè¯¦æƒ…</td></tr><tr><td>-XX:+PrintGCDateStamps</td><td>æ‰“å°GCæ—¶æ—¶é—´æˆ³</td></tr><tr><td>-XX:+PrintHeapAtGC</td><td>GCæ—¶æ‰“å°å †ä¿¡æ¯</td></tr><tr><td>-XX:+PrintAdaptiveSizePolicy</td><td>è‡ªé€‚åº”å¤§å°ç­–ç•¥ï¼Œæ¯æ¬¡ GC åä¼šé‡æ–°è®¡ç®— Edenã€From å’Œ To åŒºçš„å¤§å°ï¼Œè®¡ç®—ä¾æ®æ˜¯ GC è¿‡ç¨‹ä¸­ç»Ÿè®¡çš„ GC æ—¶é—´ã€ååé‡ã€å†…å­˜å ç”¨é‡ã€‚</td></tr><tr><td>-XX:+UseFastAccessorMethods</td><td></td></tr><tr><td>-XX:SoftRefLRUPolicyMSPerMB=0</td><td>softly reachable objects will remain alive for some amount of time after the last time they were referenced. The default value is one second of lifetime per free megabyte in the heap</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> è°ƒä¼˜ </tag>
            
            <tag> å‚æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨ç›‘æ§ä¸æ•…éšœå¤„ç†å·¥å…·</title>
      <link href="/2020/06/16/%E5%B8%B8%E7%94%A8%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/"/>
      <url>/2020/06/16/%E5%B8%B8%E7%94%A8%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h2 id="å‘½ä»¤è¡Œå·¥å…·"><a href="#å‘½ä»¤è¡Œå·¥å…·" class="headerlink" title="å‘½ä»¤è¡Œå·¥å…·"></a>å‘½ä»¤è¡Œå·¥å…·</h2><h3 id="jps"><a href="#jps" class="headerlink" title="jps"></a>jps</h3><p>åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºè¿›ç¨‹ï¼Œå¹¶æ˜¾ç¤ºè™šæ‹Ÿæœºæ‰§è¡Œä¸»ç±»åç§°ä»¥åŠè¿™äº›è¿›ç¨‹çš„æœ¬åœ°è™šæ‹Ÿå”¯ä¸€IDï¼ˆä¸æ“ä½œç³»ç»Ÿè¿›ç¨‹IDä¸€è‡´ï¼‰ã€‚</p><blockquote><p>jps [option] [hostid]</p></blockquote><table><thead><tr><th>é€‰é¡¹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>-q</td><td>åªè¾“å‡ºlvmidï¼Œçœç•¥ä¸»ç±»çš„åç§°</td></tr><tr><td>-m</td><td>è¾“å‡ºè™šæ‹Ÿæœºå¯åŠ¨æ—¶ä¼ é€’ç»™ä¸»ç±»mainï¼ˆï¼‰çš„å‚æ•°</td></tr><tr><td>-l</td><td>è¾“å‡ºä¸»ç±»çš„å…¨åï¼Œå¦‚æœæ˜¯jaråŒ…ï¼Œåˆ™è¾“å‡ºjarè·¯å¾„</td></tr><tr><td>-v</td><td>è¾“å‡ºè™šæ‹Ÿæœºå¯åŠ¨æ—¶çš„jvmå‚æ•°</td></tr></tbody></table><h3 id="jstat"><a href="#jstat" class="headerlink" title="jstat"></a>jstat</h3><p>ç”¨äºç›‘è§†è™šæ‹Ÿæœºå„ç§è¿è¡ŒçŠ¶æ€ä¿¡æ¯çš„å‘½ä»¤è¡Œå·¥å…·ã€‚<br>æ˜¾ç¤ºæœ¬åœ°æˆ–è€…è¿œç¨‹è™šæ‹Ÿæœºè¿›ç¨‹ä¸­çš„ç±»åŠ è½½ã€å†…å­˜ã€åƒåœ¾æ”¶é›†ã€å³æ—¶ç¼–è¯‘ç­‰è¿è¡Œæ—¶æ•°æ®ã€‚</p><blockquote><p>jstat [option vimid [interval[s|ms] [count]]]<br>[protocal:][//]lvmid[@hostname[:port]/servername]</p></blockquote><table><thead><tr><th>é€‰é¡¹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>-class</td><td>ç›‘è§†ç±»åŠ è½½ã€å¸è½½æ•°é‡ã€æ€»ç©ºé—´ä»¥åŠç±»è£…è½½è€—è´¹çš„æ—¶é—´</td></tr><tr><td>-gc</td><td>ç›‘è§†Javaå †çŠ¶å†µï¼ŒåŒ…æ‹¬Edenã€Survivorã€è€å¹´ä»£ã€æ°¸ä¹…ä»£çš„å®¹é‡ï¼Œå·²ç”¨ç©ºé—´ï¼Œåƒåœ¾æ”¶é›†æ—¶é—´</td></tr><tr><td>-gccapacity</td><td>ç›‘è§†å†…å®¹ä¸-gcåŸºæœ¬ç›¸åŒï¼Œä½†è¾“å‡ºä¸»è¦å…³æ³¨javaå †å„ä¸ªåŒºåŸŸä½¿ç”¨åˆ°æœ€å¤§æœ€å°ç©ºé—´</td></tr><tr><td>-gcutil</td><td>ç›‘è§†å†…å®¹ä¸-gcåŸºæœ¬ç›¸åŒï¼Œä½†è¾“å‡ºä¸»è¦å…³æ³¨å·²ä½¿ç”¨ç©ºé—´å æ€»ç©ºé—´çš„ç™¾åˆ†æ¯”</td></tr><tr><td>-gccause</td><td>ä¸-gcutilåŠŸèƒ½ä¸€æ ·ï¼Œä¼šé¢å¤–è¾“å‡ºå¯¼è‡´ä¸Šä¸€æ¬¡åƒåœ¾æ”¶é›†äº§ç”Ÿçš„åŸå› </td></tr><tr><td>-gcnew</td><td>ç›‘è§†æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†æƒ…å†µ</td></tr><tr><td>-gcnewcapacity</td><td>ç›‘è§†å†…å®¹ä¸-gcnewåŸºæœ¬ç›¸åŒï¼Œè¾“å‡ºä¸»è¦å…³æ³¨ä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´</td></tr><tr><td>-gcold</td><td>ç›‘è§†è€å¹´ä»£åƒåœ¾æ”¶é›†çŠ¶å†µ</td></tr><tr><td>-gcoldcapacity</td><td>ä¸-gcoldç›¸åŒï¼Œè¾“å‡ºä¸»è¦å…³æ³¨ä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´</td></tr><tr><td>-gcpermcapacity</td><td>è¾“å‡ºæ°¸ä¹…ä»£ä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´</td></tr><tr><td>-compiler</td><td>è¾“å‡ºå³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘è¿‡çš„æ–¹æ³•ã€è€—æ—¶ç­‰ä¿¡æ¯</td></tr><tr><td>-printcompilation</td><td>è¾“å‡ºå·²ç»è¢«å³æ—¶ç¼–è¯‘çš„æ–¹æ³•</td></tr></tbody></table><p>æ¯éš”1sæŸ¥è¯¢ä¸€æ¬¡2105çš„gcæƒ…å†µï¼ŒæŸ¥è¯¢10æ¬¡ã€‚<br>jstat -gc 2105 1000 10</p><p>jstat -gcutil 2105</p><table><thead><tr><th>S0</th><th>S1</th><th>E</th><th>O</th><th>P</th><th>YGC</th><th>YGCT</th><th>FGC</th><th>FGCT</th><th>GCT</th></tr></thead><tbody><tr><td>0.00</td><td>0.00</td><td>6.20</td><td>41.42</td><td>47.20</td><td>16</td><td>0.105</td><td>3</td><td>0.472</td><td>0.577</td></tr></tbody></table><h3 id="jinfo"><a href="#jinfo" class="headerlink" title="jinfo"></a>jinfo</h3><p>å®æ—¶æŸ¥çœ‹å’Œè°ƒæ•´è™šæ‹Ÿæœºå„é¡¹å‚æ•°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Usage:</span><br><span class="line">    jinfo [option] &lt;pid&gt;</span><br><span class="line">        (to connect to running process)</span><br><span class="line">    jinfo [option] &lt;executable &lt;core&gt;</span><br><span class="line">        (to connect to a core file)</span><br><span class="line">    jinfo [option] [server_id@]&lt;remote server IP or hostname&gt;</span><br><span class="line">        (to connect to remote debug server)</span><br><span class="line"></span><br><span class="line">where &lt;option&gt; is one of:</span><br><span class="line">    -flag &lt;name&gt;         to print the value of the named VM flag</span><br><span class="line">    -flag [+|-]&lt;name&gt;    to enable or disable the named VM flag</span><br><span class="line">    -flag &lt;name&gt;&#x3D;&lt;value&gt; to set the named VM flag to the given value</span><br><span class="line">    -flags               to print VM flags</span><br><span class="line">    -sysprops            to print Java system properties</span><br><span class="line">    &lt;no option&gt;          to print both of the above</span><br><span class="line">    -h | -help           to print this help message</span><br></pre></td></tr></table></figure><h3 id="jmap"><a href="#jmap" class="headerlink" title="jmap"></a>jmap</h3><p>ç”¨äºç”Ÿæˆå †è½¬å‚¨å¿«ç…§ï¼ŒæŸ¥è¯¢finalizeæ‰§è¡Œé˜Ÿåˆ—ã€Javaå †å’Œæ–¹æ³•åŒºçš„è¯¦ç»†ä¿¡æ¯ï¼ˆç©ºé—´ä½¿ç”¨ç‡ã€å½“å‰ä½¿ç”¨æ”¶é›†å™¨ç±»å‹ï¼‰</p><p>ç”Ÿæˆå †è½¬å‚¨æ–‡ä»¶çš„æ–¹å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-XX:+HeapDumpOnOutOfMemoryError åœ¨è™šæ‹Ÿæœºå†…å­˜æº¢å‡ºå¼‚å¸¸å‡ºç°åè‡ªåŠ¨ç”Ÿæˆå †è½¬å‚¨å¿«ç…§æ–‡ä»¶ã€‚</span><br><span class="line">-XX:HeapDumpOnCtrlBreak ä½¿ç”¨ctrl+Break ç”Ÿæˆå †è½¬å‚¨å¿«ç…§æ–‡ä»¶</span><br><span class="line">kill -3 pid  ç”Ÿæˆå †è½¬å‚¨å¿«ç…§æ–‡ä»¶</span><br><span class="line">jmap -dump:format&#x3D;b,file&#x3D;heap.dump 3120</span><br></pre></td></tr></table></figure><table><thead><tr><th>é€‰é¡¹</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>-dump</td><td>ç”Ÿæˆjavaå †è½¬å‚¨å¿«ç…§ï¼Œæ ¼å¼ä¸º-dump:[live,]format=b,file=<filename>,liveå­å‚æ•°è¯´æ˜æ˜¯å¦åªdumpå‡ºå­˜æ´»å¯¹è±¡</filename></td></tr><tr><td>-finalizerinfo</td><td>æ˜¾ç¤ºå†F-Queueä¸­ç­‰å¾…Finalizerçº¿ç¨‹æ‰§è¡Œfinalizeæ–¹æ³•çš„å¯¹è±¡ã€‚åªæœ‰åœ¨Linuxå¹³å°æœ‰æ•ˆ</td></tr><tr><td>-heap</td><td>æ˜¾ç¤ºJavaå †è¯¦ç»†ä¿¡æ¯ï¼Œä½¿ç”¨å›æ”¶å™¨ç±»å‹ã€å‚æ•°é…ç½®ã€åˆ†ä»£çŠ¶å†µï¼Œåªåœ¨Linuxå¹³å°ä¸‹æœ‰æ•ˆ</td></tr><tr><td>-histo</td><td>æ˜¾ç¤ºå †ä¸­å¯¹è±¡ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»ã€å®ä¾‹æ•°é‡ã€åˆè®¡å®¹é‡</td></tr><tr><td>-permstat</td><td>åœ¨ä»¥ClassLoaderä¸ºç»Ÿè®¡å£å¾„æ˜¾ç¤ºæ°¸ä¹…ä»£å†…å­˜çŠ¶æ€ã€‚åªåœ¨Linuxä¸‹æœ‰æ•ˆ</td></tr><tr><td>-F</td><td>å½“è™šæ‹Ÿæœºè¿›ç¨‹å¯¹-dumpé€‰é¡¹æ²¡æœ‰å“åº”æ—¶ï¼Œå¯ä»¥ä½¿ç”¨-Få¼ºåˆ¶ç”Ÿæˆdumpå¿«ç…§ï¼Œåªåœ¨Linuxä¸‹æœ‰æ•ˆ</td></tr></tbody></table><h3 id="jhat"><a href="#jhat" class="headerlink" title="jhat"></a>jhat</h3><p>ç”¨äºåˆ†æjmapç”Ÿæˆçš„å †è½¬å‚¨å¿«ç…§ã€‚ </p><blockquote><p>jhat heap.dump</p></blockquote><p>jhatåŠŸèƒ½ç›¸å¯¹ç®€é™‹ï¼Œåˆ†æå·¥ä½œè€—æ—¶ä¸”è€—è´¹ç¡¬ä»¶èµ„æºï¼Œä¸€èˆ¬ä¸åœ¨æœ¬æœºä½¿ç”¨ã€‚<br>æ›¿ä»£æ–¹æ¡ˆï¼šVisualVMã€Eclipse Memory Analyzerã€IBM HeapAnalyzerã€‚</p><h3 id="jstack"><a href="#jstack" class="headerlink" title="jstack"></a>jstack</h3><p>ç”Ÿæˆè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ã€‚ç›®çš„æ˜¯å®šä½çº¿ç¨‹å‡ºç°é•¿æ—¶é—´åœé¡¿çš„åŸå› ï¼Œå¦‚çº¿ç¨‹é—´æ­»é”ã€æ­»å¾ªç¯ã€è¯·æ±‚å¤–éƒ¨èµ„æºå¯¼è‡´çš„é•¿æ—¶é—´æŒ‚èµ·ç­‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Usage:</span><br><span class="line">    jstack [-l] &lt;pid&gt;</span><br><span class="line">        (to connect to running process)</span><br><span class="line">    jstack -F [-m] [-l] &lt;pid&gt;</span><br><span class="line">        (to connect to a hung process)</span><br><span class="line">    jstack [-m] [-l] &lt;executable&gt; &lt;core&gt;</span><br><span class="line">        (to connect to a core file)</span><br><span class="line">    jstack [-m] [-l] [server_id@]&lt;remote server IP or hostname&gt;</span><br><span class="line">        (to connect to a remote debug server)</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">    -F  to force a thread dump. Use when jstack &lt;pid&gt; does not respond (process is hung)</span><br><span class="line">    -m  to print both java and native frames (mixed mode)</span><br><span class="line">    -l  long listing. Prints additional information about locks</span><br><span class="line">    -h or -help to print this help message</span><br></pre></td></tr></table></figure><h2 id="é«˜çº§å·¥å…·"><a href="#é«˜çº§å·¥å…·" class="headerlink" title="é«˜çº§å·¥å…·"></a>é«˜çº§å·¥å…·</h2><h3 id="JConsole"><a href="#JConsole" class="headerlink" title="JConsole"></a>JConsole</h3><p>åŸºäºJMXçš„å¯è§†åŒ–ç›‘è§†ã€ç®¡ç†å·¥å…·ã€‚</p><h3 id="JHSDB"><a href="#JHSDB" class="headerlink" title="JHSDB"></a>JHSDB</h3><p>åŸºäºæœåŠ¡æ€§ä»£ç†å®ç°çš„è¿›ç¨‹å¤–è°ƒè¯•å·¥å…·ã€‚æœåŠ¡æ€§ä»£ç†æ˜¯HotSpotè™šæ‹Ÿæœºä¸­ä¸€ç»„ç”¨äºæ˜ å°„Javaè™šæ‹Ÿæœºè¿è¡Œä¿¡æ¯çš„ã€ä¸»è¦åŸºäºJavaè¯­è¨€å®ç°çš„APIé›†åˆã€‚<br><img src="/2020/06/16/%E5%B8%B8%E7%94%A8%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/jhsdb.jpeg" alt="JCMD å’ŒJHSDBå·¥å…·å¯¹æ¯”"></p><h3 id="VisualVM"><a href="#VisualVM" class="headerlink" title="VisualVM"></a>VisualVM</h3><p>å¤šåˆä¸€æ•…éšœå¤„ç†å·¥å…·ï¼Œä¸éœ€è¦è¢«ç›‘è§†çš„ç¨‹åºåŸºäºç‰¹æ®ŠAgentæ‰§è¡Œï¼Œé€šç”¨æ€§å¼ºï¼Œå¯¹åº”ç”¨ç¨‹åºçš„å®é™…æ€§èƒ½å½±å“è¾ƒå°ï¼Œå¯ä»¥ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚</p><h3 id="Java-Mission-Control"><a href="#Java-Mission-Control" class="headerlink" title="Java Mission Control"></a>Java Mission Control</h3><p>å¯æŒç»­åœ¨çº¿ç›‘æ§å·¥å…·ã€‚</p><h3 id="arthas"><a href="#arthas" class="headerlink" title="arthas"></a>arthas</h3><p>é˜¿é‡Œå·´å·´æä¾›çš„æ€§èƒ½åˆ†æå·¥å…·<br><a href="https://alibaba.github.io/arthas/" target="_blank" rel="noopener">https://alibaba.github.io/arthas/</a></p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> å¸¸ç”¨å·¥å…· </tag>
            
            <tag> æ•…éšœæ’æŸ¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LinuxæŸ¥çœ‹Swap</title>
      <link href="/2020/06/12/Linux%E6%9F%A5%E7%9C%8BSwap/"/>
      <url>/2020/06/12/Linux%E6%9F%A5%E7%9C%8BSwap/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"># Get current swap usage for all running processes</span><br><span class="line"># Erik Ljungstrom 27&#x2F;05&#x2F;2011</span><br><span class="line">SUM&#x3D;0</span><br><span class="line">OVERALL&#x3D;0</span><br><span class="line">for DIR in &#96;find &#x2F;proc&#x2F; -maxdepth 1 -type d | egrep &quot;^&#x2F;proc&#x2F;[0-9]&quot;&#96; ;</span><br><span class="line">do</span><br><span class="line">    PID&#x3D;&#96;echo $DIR | cut -d &#x2F; -f 3&#96;</span><br><span class="line">    PROGNAME&#x3D;&#96;ps -p $PID -o comm --no-headers&#96;</span><br><span class="line">    for SWAP in &#96;grep Swap $DIR&#x2F;smaps 2&gt;&#x2F;dev&#x2F;null| awk &#39;&#123; print $2 &#125;&#39;&#96;</span><br><span class="line">        do</span><br><span class="line">            let SUM&#x3D;$SUM+$SWAP</span><br><span class="line">        done</span><br><span class="line">    echo &quot;PID&#x3D;$PID - Swap used: $SUM - ($PROGNAME )&quot;</span><br><span class="line">    let OVERALL&#x3D;$OVERALL+$SUM</span><br><span class="line">        SUM&#x3D;0</span><br><span class="line">done</span><br><span class="line">echo &quot;Overall swap used: $OVERALL&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> VIM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> swap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼IDç”Ÿæˆå™¨</title>
      <link href="/2020/06/11/%E5%88%86%E5%B8%83%E5%BC%8FID/"/>
      <url>/2020/06/11/%E5%88%86%E5%B8%83%E5%BC%8FID/</url>
      
        <content type="html"><![CDATA[<h3 id="Centos-ç®€å•ä¼˜åŒ–"><a href="#Centos-ç®€å•ä¼˜åŒ–" class="headerlink" title="Centos ç®€å•ä¼˜åŒ–"></a>Centos ç®€å•ä¼˜åŒ–</h3><h5 id="å®‰è£…åŸºæœ¬å·¥å…·"><a href="#å®‰è£…åŸºæœ¬å·¥å…·" class="headerlink" title="å®‰è£…åŸºæœ¬å·¥å…·"></a>å®‰è£…åŸºæœ¬å·¥å…·</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget vim net-tools lrzsz</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤UUID"><a href="#åˆ é™¤UUID" class="headerlink" title="åˆ é™¤UUID"></a>åˆ é™¤UUID</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim ifcfg-ens33</span><br><span class="line">vim ifcfg-eth0</span><br><span class="line">vim em1</span><br></pre></td></tr></table></figure><h4 id="é…ç½®é™æ€IP"><a href="#é…ç½®é™æ€IP" class="headerlink" title="é…ç½®é™æ€IP"></a>é…ç½®é™æ€IP</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IPADDR&#x3D;10.0.0.130</span><br><span class="line">GATEWAY&#x3D;10.0.0.2</span><br><span class="line">NETMASK&#x3D;255.255.255.0</span><br><span class="line">DNS1&#x3D;10.0.0.2</span><br><span class="line">DNS2&#x3D;1.2.4.8</span><br></pre></td></tr></table></figure><h4 id="å…³é—­é˜²ç«å¢™ä»¥åŠNetworkManagerå’ŒSELINX"><a href="#å…³é—­é˜²ç«å¢™ä»¥åŠNetworkManagerå’ŒSELINX" class="headerlink" title="å…³é—­é˜²ç«å¢™ä»¥åŠNetworkManagerå’ŒSELINX"></a>å…³é—­é˜²ç«å¢™ä»¥åŠNetworkManagerå’ŒSELINX</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line">systemctl stop NetworkManager</span><br><span class="line">systemctl disable NetworkManager</span><br></pre></td></tr></table></figure><h4 id="æ›¿æ¢YUMæº"><a href="#æ›¿æ¢YUMæº" class="headerlink" title="æ›¿æ¢YUMæº"></a>æ›¿æ¢YUMæº</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum clean all &amp;&amp; yum makecache</span><br><span class="line">cd &#x2F;etc&#x2F;yum.repos.d&#x2F;</span><br><span class="line">mv CentOS-Base.repo CentOS-Base.repo.bak</span><br><span class="line">vim CentOS-Base.repo</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–è¯‘ä¸ä¼˜åŒ–</title>
      <link href="/2020/06/11/%E7%BC%96%E8%AF%91%E4%B8%8E%E4%BC%98%E5%8C%96/"/>
      <url>/2020/06/11/%E7%BC%96%E8%AF%91%E4%B8%8E%E4%BC%98%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h2><ul><li>å‰ç«¯ç¼–è¯‘å™¨ï¼š JDKçš„Javac ã€EclipseJDTä¸­çš„å¢é‡å¼ç¼–è¯‘å™¨ï¼ˆECJï¼‰</li><li>å³æ—¶ç¼–è¯‘å™¨ï¼šHotSpotè™šæ‹Ÿæœºçš„C1\c2ç¼–è¯‘å™¨ã€Graalç¼–è¯‘å™¨</li><li>æå‰ç¼–è¯‘å™¨ï¼šJDKçš„Jaotcã€GNU Compiler for Java, Excelsisor JET.</li></ul><h3 id="å‰ç«¯ç¼–è¯‘å™¨"><a href="#å‰ç«¯ç¼–è¯‘å™¨" class="headerlink" title="å‰ç«¯ç¼–è¯‘å™¨"></a>å‰ç«¯ç¼–è¯‘å™¨</h3><p>ç¼–è¯‘è¿‡ç¨‹åˆ†ä¸º1ä¸ªå‡†å¤‡è¿‡ç¨‹å’Œ3ä¸ªå¤„ç†è¿‡ç¨‹ï¼š<br>1ï¼‰åˆå§‹åŒ–æ’å…¥å¼æ³¨è§£å¤„ç†å™¨<br>2ï¼‰è§£æä¸å¡«å……ç¬¦å·è¡¨</p><ul><li><p>è¯­æ³•ã€è¯æ³•åˆ†æ<br>è¯æ³•åˆ†ææ˜¯å°†æºä»£ç çš„å­—ç¬¦æµè½¬å˜ä¸ºæ ‡è®°é›†åˆçš„è¿‡ç¨‹ï¼Œå•ä¸ªå­—ç¬¦æ˜¯ç¨‹åºç¼–å†™çš„æœ€å°å…ƒç´ ï¼Œä½†æ ‡è®°æ‰æ˜¯ç¼–è¯‘æ—¶çš„æœ€å°å…ƒç´ ã€‚å…³é”®å­—ã€å˜é‡åã€å­—é¢é‡ã€è¿ç®—ç¬¦éƒ½å¯ä»¥ä½œä¸ºæ ‡è®°ã€‚</p><p>è¯­æ³•åˆ†ææ—¶æ ¹æ®æ ‡è®°åºåˆ—æ„é€ æŠ½è±¡è¯­æ³•æ ‘çš„è¿‡ç¨‹ï¼ŒæŠ½è±¡è¯­æ³•æ ‘æ˜¯ç”¨æ¥æè¿°ç¨‹åºä»£ç è¯­æ³•ç»“æ„çš„æ ‘å½¢è¡¨ç¤ºæ–¹å¼ï¼ŒæŠ½è±¡è¯­æ³•æ ‘çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä»£è¡¨ç¨‹åºä»£ç ä¸­çš„ä¸€ä¸ªè¯­æ³•ç»“æ„ã€‚ä¾‹å¦‚åŒ…ã€ç±»å‹ã€ä¿®é¥°ç¬¦ã€è¿ç®—ç¬¦ã€æ¥å£ã€è¿”å›å€¼ã€ä»£ç æ³¨é‡Šç­‰ã€‚</p><p>ç»è¿‡è¯æ³•å’Œè¯­æ³•åˆ†æç”Ÿæˆè¯­æ³•æ ‘ä»¥åï¼Œç¼–è¯‘å™¨åç»­çš„æ“ä½œéƒ½å»ºç«‹åœ¨æŠ½è±¡è¯­æ³•æ ‘ä¹‹ä¸Šã€‚</p></li><li><p>å¡«å……ç¬¦å·è¡¨<br>ç¬¦å·è¡¨æ˜¯ä¸€ç»„ç¬¦å·åœ°å€å’Œç¬¦å·ä¿¡æ¯æ„æˆçš„æ•°æ®ç»“æ„ï¼Œç¬¦å·è¡¨ä¸­æ‰€ç™»è®°çš„ä¿¡æ¯åœ¨ç¼–è¯‘çš„ä¸åŒé˜¶æ®µéƒ½è¦è¢«ç”¨åˆ°ã€‚å¦‚ï¼Œåœ¨è¯­ä¹‰åˆ†æè¿‡ç¨‹ä¸­ï¼Œç¬¦å·è¡¨æ‰€ç™»è®°çš„å†…å®¹å°†ç”¨äºè¯­ä¹‰æ£€æŸ¥å’Œäº§ç”Ÿä¸­é—´ä»£ç ï¼Œåœ¨ç›®æ ‡ä»£ç ç”Ÿæˆé˜¶æ®µï¼Œå¯¹ç¬¦å·åè¿›è¡Œåœ°å€åˆ†é…æ—¶ï¼Œç¬¦å·è¡¨æ˜¯åœ°å€è§£æåˆ†é…çš„ç›´æ¥ä¾æ®ã€‚</p></li></ul><p>3ï¼‰æ³¨è§£å¤„ç†å™¨<br>  æ’å…¥å¼æ³¨è§£å¤„ç†å™¨å¯ä»¥æå‰è‡³ç¼–è¯‘æœŸå¯¹ä»£ç ä¸­çš„ç‰¹å®šæ³¨è§£è¿›è¡Œå¤„ç†ï¼Œä»è€Œå½±å“åˆ°å‰ç«¯ç¼–è¯‘å™¨ï¼ˆjavacï¼‰çš„å·¥ä½œè¿‡ç¨‹ã€‚</p><p>  å¦‚æœåœ¨å¤„ç†æ³¨è§£æœŸé—´å¯¹è¯­æ³•æ ‘è¿›è¡Œè¿‡ä¿®æ”¹ï¼Œç¼–è¯‘å™¨å°†å›åˆ°è§£æä»¥åŠå¡«å……ç¬¦å·è¡¨çš„è¿‡ç¨‹é‡æ–°å¤„ç†ï¼ŒçŸ¥é“æ‰€æœ‰æ’å…¥å¼æ³¨è§£å¤„ç†å™¨éƒ½æ²¡æœ‰å†å¯¹è¯­æ³•æ ‘è¿›è¡Œä¿®æ”¹ä½ç½®ï¼Œæ¯æ¬¡å¾ªç¯ç§°ä¸ºä¸€ä¸ªè½®æ¬¡ã€‚</p><p>4ï¼‰è¯­ä¹‰åˆ†æä¸å­—èŠ‚ç ç”Ÿæˆ</p><p>è¯­ä¹‰åˆ†æè¿‡ç¨‹åˆ†ä¸ºæ ‡æ³¨æ£€æŸ¥å’Œæ•°æ®ä»¥åŠæ§åˆ¶æµåˆ†æä¸¤ä¸ªæ­¥éª¤ã€‚</p><p>åœ¨ç»è¿‡è¯­æ³•åˆ†æåï¼Œç¼–è¯‘å™¨è·å¾—äº†ç¨‹åºä»£ç çš„æŠ½è±¡è¯­æ³•æ ‘è¡¨ç¤ºï¼ŒæŠ½è±¡è¯­æ³•æ ‘èƒ½å¤Ÿè¡¨ç¤ºä¸€ä¸ªç»“æ„æ­£ç¡®çš„æºç¨‹åºï¼Œä½†æ— æ³•ä¿è¯æºç¨‹åºçš„è¯­ä¹‰æ˜¯ç¬¦åˆé€»è¾‘çš„ã€‚è€Œè¯­ä¹‰åˆ†æçš„ä¸»è¦ä»»åŠ¡åˆ™æ˜¯å¯¹ç»“æ„ä¸Šæ­£ç¡®çš„æºç¨‹åºè¿›è¡Œä¸Šä¸‹æ–‡ç›¸å…³æ€§è´¨çš„æ£€æŸ¥ï¼Œè­¬å¦‚è¿›è¡Œç±»å‹æ£€æŸ¥ã€æ§åˆ¶æµæ£€æŸ¥ã€æ•°æ®æµæ£€æŸ¥ç­‰ç­‰ã€‚</p><ul><li><p>æ ‡æ³¨æ£€æŸ¥<br>æ£€æŸ¥çš„å†…å®¹åŒ…æ‹¬å˜é‡æ˜¯ç”¨é’±æ˜¯å¦å·²ç»è¢«å£°æ˜ã€å˜é‡ä¸èµ‹å€¼ä¹‹é—´çš„æ•°æ®ç±»å‹æ˜¯å¦èƒ½å¤ŸåŒ¹é…ç­‰ç­‰ã€‚<br>å¸¸é‡æŠ˜å ï¼šint a = 1 + 1 ; ==&gt;  int a = 2;</p></li><li><p>æ•°æ®æµä»¥åŠæ§åˆ¶æµåˆ†æ<br>æ•°æ®æµåˆ†æä»¥åŠæ§åˆ¶æµåˆ†ææ˜¯å¯¹ç¨‹åºä¸Šä¸‹æ–‡é€»è¾‘æ›´è¿›ä¸€æ­¥çš„éªŒè¯ï¼Œå®ƒå¯ä»¥æ£€æŸ¥å‡ºè¯¸å¦‚ç¨‹åºå±€éƒ¨å˜é‡åœ¨ä½¿ç”¨å‰æ˜¯å¦æœ‰èµ‹å€¼ã€æ–¹æ³•çš„æ¯æ¡è·¯å¾„æ˜¯å¦éƒ½æœ‰è¿”å›å€¼ã€æ˜¯å¦æ‰€æœ‰çš„å—æ£€æŸ¥å¼‚å¸¸éƒ½è¢«æ­£ç¡®å¤„ç†äº†ç­‰é—®é¢˜ã€‚<br>ç¼–è¯‘å™¨çš„æ•°æ®ä»¥åŠæ§åˆ¶æµåˆ†æä¸ç±»åŠ è½½æ—¶çš„æ•°æ®ä»¥åŠæ§åˆ¶æµåˆ†æçš„ç›®çš„åŸºæœ¬å“ˆæ¡‘ä¸€è‡´ï¼Œä½†æ˜¯æ ¡éªŒèŒƒå›´æœ‰æ‰€åŒºåˆ«ã€‚</p></li><li><p>è§£è¯­æ³•ç³–<br>Javaè¯­è¨€çš„è¯­æ³•ç³–åŒ…å«æ³›å‹ã€å˜é•¿å‚æ•°ã€è‡ªåŠ¨è£…ç®±æ‹†ç®±ç­‰ï¼ŒJavaè™šæ‹Ÿæœºåœ¨è¿è¡Œæ—¶å¹¶ä¸çŸ¥èŠ‚æ”¯æŒè¿™äº›è¯­æ³•ï¼Œå®ƒä»¬åœ¨ç¼–è¯‘é˜¶æ®µè¢«è¿˜åŸå›åŸå§‹çš„åŸºç¡€è¯­æ³•ç»“æ„ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºè§£è¯­æ³•ç³–ã€‚</p></li><li><p>å­—èŠ‚ç ç”Ÿæˆ</p><p>å­—èŠ‚ç ç”Ÿæˆé˜¶æ®µéœ€è¦æŠŠå‰é¢å“¥å“¥æ­¥éª¤ç”Ÿæˆçš„ä¿¡æ¯è½¬åŒ–æˆå­—èŠ‚ç æŒ‡ä»¤å†™åˆ°ç£ç›˜ä¸­å¤–ï¼Œè¿˜è¦è¿›è¡Œå°‘é‡çš„ä»£ç æ·»åŠ å’Œè½¬æ¢å·¥ä½œã€‚<br>å¦‚å®ä¾‹æ„é€ å™¨&lt;init&gt;()æ–¹æ³•å’Œ&lt;cinit&gt;()æ–¹æ³•çš„æ·»åŠ ã€‚<br>å¦‚æœç”¨æˆ·ä»£ç ä¸­æ²¡æœ‰æä¾›ä»»ä½•æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†ä¼šæ·»åŠ ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„ã€å¯è®¿é—®æ€§ä¸å½“å‰ç±»å‹ä¸€è‡´çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªå·¥ä½œåœ¨å¡«å……ç¬¦å·è¡¨é˜¶æ®µå·²ç»å®Œæˆã€‚</p><p>ç¼–è¯‘å™¨ä¼šæŠŠè¯­å¥å—ã€å˜é‡å˜é‡åˆå§‹åŒ–ã€è°ƒç”¨çˆ¶ç±»çš„å®ä¾‹æ„é€ å™¨æ–¹ç­‰æ“ä½œæ”¶æ•›åˆ°&lt;init&gt;()å’Œ&lt;cinit&gt;()æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”ä¿è¯æ— è®ºæºç ä¸­å‡ºç°çš„é¡ºåºå¦‚ä½•ï¼Œéƒ½ä¸€å®šæ˜¯æŒ‰å…ˆæ‰§è¡Œçˆ¶ç±»çš„å®ä¾‹æ„é€ å™¨ï¼Œç„¶ååˆå§‹åŒ–å˜é‡ï¼Œæœ€åæ‰§è¡Œè¯­å¥å—çš„é¡ºåºæ‰§è¡Œï¼Œ</p></li></ul><p><img src="/2020/06/11/%E7%BC%96%E8%AF%91%E4%B8%8E%E4%BC%98%E5%8C%96/javac.jpeg" alt></p><h3 id="è¯­æ³•ç³–"><a href="#è¯­æ³•ç³–" class="headerlink" title="è¯­æ³•ç³–"></a>è¯­æ³•ç³–</h3><p>æ³›å‹ã€è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ã€éå†å¾ªç¯ã€å˜é•¿å‚æ•°å’Œæ¡ä»¶ç¼–è¯‘ã€å†…éƒ¨ç±»ã€æšä¸¾ç±»ã€æ–­è¨€ã€æ•°å€¼ç›´é¢é‡ã€æšä¸¾å’Œå­—ç¬¦ä¸²çš„switchã€try with resourceï¼Œ lambdaç­‰ã€‚</p><h4 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h4><p>ç±»å‹æ“¦é™¤</p><h4 id="è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±å’Œå¾ªç¯éå†"><a href="#è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±å’Œå¾ªç¯éå†" class="headerlink" title="è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±å’Œå¾ªç¯éå†"></a>è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±å’Œå¾ªç¯éå†</h4><p>1ï¼‰å¤§äº127çš„å€¼ä¸ä¼šè‡ªåŠ¨æ‹†ç®±<br>2ï¼‰æ²¡æœ‰é‡åˆ°è¿ç®—ç¬¦çš„æƒ…å†µä¸‹ä¸ä¼šè‡ªåŠ¨æ‹†ç®±<br>3ï¼‰equalsæ–¹æ³•ä¸å¤„ç†æ•°æ®è½¬å‹</p><h4 id="å˜é•¿å‚æ•°"><a href="#å˜é•¿å‚æ•°" class="headerlink" title="å˜é•¿å‚æ•°"></a>å˜é•¿å‚æ•°</h4><h3 id="æ¡ä»¶ç¼–è¯‘"><a href="#æ¡ä»¶ç¼–è¯‘" class="headerlink" title="æ¡ä»¶ç¼–è¯‘"></a>æ¡ä»¶ç¼–è¯‘</h3><p>Javaç¼–è¯‘å™¨å°†æ‰€æœ‰ç¼–è¯‘ä½†æ„¿çš„è¯­æ³•æ ‘é¡¶çº§èŠ‚ç‚¹è¾“å…¥åˆ°å¾…å¤„ç†åˆ—è¡¨åå†è¿›è¡Œç¼–è¯‘ï¼Œå› æ­¤å„ä¸ªæ–‡ä»¶ä¹‹é—´å¯ä»¥äº’ç›¸æä¾›ç¬¦å·ä¿¡æ¯ã€‚</p><p>æ ¹æ®æ¡ä»¶ä¸­å¸ƒå°”å€¼å¸¸é‡å€¼çš„çœŸå‡ï¼Œç¼–è¯‘å™¨å°†æŠŠåˆ†æ”¯ä¸­ä¸æˆç«‹çš„ä»£ç å—æ¶ˆé™¤æ‰ã€‚</p><h2 id="åç«¯ç¼–è¯‘"><a href="#åç«¯ç¼–è¯‘" class="headerlink" title="åç«¯ç¼–è¯‘"></a>åç«¯ç¼–è¯‘</h2><p>å½“ç¨‹åºéœ€è¦è¿…é€Ÿå¯åŠ¨å’Œæ‰§è¡Œçš„æ—¶å€™ï¼Œè§£é‡Šå™¨å¯ä»¥é¦–å…ˆå‘æŒ¥ä½œç”¨ï¼Œçœå»ç¼–è¯‘çš„æ—¶é—´ï¼Œç«‹å³è¿è¡Œã€‚<br>å½“ç¨‹åºè¿è¡Œç¯å¢ƒä¸­å†…å­˜èµ„æºé™åˆ¶è¾ƒå¤§ï¼Œå¯ä»¥ä½¿ç”¨è§£é‡Šæ‰§è¡ŒèŠ‚çº¦å†…å­˜ã€‚<br>å½“ç¨‹åºå¯åŠ¨ä»¥åï¼Œç¼–è¯‘å™¨é€æ¸å‘æŒ¥ä½œç”¨ï¼ŒæŠŠè¶Šæ¥è¶Šå¤šçš„ä»£ç ç¼–è¯‘æˆæœ¬åœ°ä»£ç ï¼Œå‡å°‘è§£é‡Šå™¨çš„ä¸­é—´æŸè€—ï¼Œè·å¾—æ›´é«˜çš„æ•ˆç‡ã€‚</p><h3 id="å³æ—¶ç¼–è¯‘å™¨"><a href="#å³æ—¶ç¼–è¯‘å™¨" class="headerlink" title="å³æ—¶ç¼–è¯‘å™¨"></a>å³æ—¶ç¼–è¯‘å™¨</h3><p>å³æ—¶ç¼–è¯‘å™¨å°†è¿è¡Œæ¯”è¾ƒé¢‘ç¹çš„ä»£ç å—æˆ–è€…æ–¹æ³•ç¼–è¯‘æˆæœ¬åœ°æœºå™¨å—ï¼Œå¹¶ä¸”å¯¹è¿™æ®µä»£ç è¿›è¡Œä¼˜åŒ–ã€‚</p><p>åœ¨Hotspotä¸­å†…ç½®äº†2ä¸ªå³æ—¶ç¼–è¯‘å™¨ Client Compilerã€ Server Compilerã€‚ è™šæ‹Ÿæœºä¼šæ ¹æ®è‡ªèº«ç‰ˆæœ¬ä¸å®¿ä¸»æœºçš„ç¡¬ä»¶æ€§èƒ½è‡ªåŠ¨é€‰æ‹©è¿è¡Œæ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-client æˆ–è€… -Server æ¥å¼ºåˆ¶æŒ‡å®šè™šæ‹Ÿæœºè¿è¡Œåœ¨å®¢æˆ·ç«¯æ¨¡å¼æˆ–è€…æœåŠ¡ç«¯æ¨¡å¼ã€‚</p><p>è§£é‡Šæ¨¡å¼(Interperted Mode)ï¼š-Xint<br>ç¼–è¯‘æ¨¡å¼(Compiled Mode): -Xcomp<br>æ··åˆæ¨¡å¼(Mixed Mode): -Xmixed (é»˜è®¤)</p><p>ç¼–è¯‘å™¨ç¼–è¯‘æœ¬åœ°ä»£ç éœ€è¦å ç”¨ç¨‹åºè¿è¡Œæ—¶é—´ï¼Œä½äº†æ‰“åˆ°å“åº”é€Ÿåº¦ä¸è¿è¡Œæ•ˆç‡ä¹‹é—´æ‰“åˆ°æœ€ä½³å¹³è¡¡ï¼ŒHotSpotåœ¨ç¼–è¯‘å­ç³»ç»Ÿä¸­åŠ å…¥äº†åˆ†å±‚ç¼–è¯‘çš„åŠŸèƒ½ã€‚åˆ†å±‚ç¼–è¯‘æ ¹æ®ç¼–è¯‘å™¨ç¼–è¯‘ã€ä¼˜åŒ–çš„è§„æ¨¡ä¸è€—æ—¶ï¼Œåˆ’åˆ†å‡ºä¸åŒçš„ç¼–è¯‘å±‚æ¬¡ï¼š<br>ç¬¬0å±‚ï¼Œç¨‹åºæ˜¥è§£é‡Šæ‰§è¡Œï¼Œå¹¶ä¸”è§£é‡Šå™¨ä¸å¼€å¯æ€§èƒ½ç›‘æ§ã€‚<br>ç¬¬ä¸€å±‚ï¼šä½¿ç”¨å®¢æˆ·ç«¯ç¼–è¯‘å™¨å°†å­—èŠ‚ç ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç ï¼Œè¿›è¡Œç®€å•å¯é çš„ç¨³å®šä¼˜åŒ–ï¼Œä¸å¼€å¯æ€§èƒ½ç›‘æ§åŠŸèƒ½ã€‚<br>ç¬¬äºŒå±‚ï¼šä½¿ç”¨å®¢æˆ·ç«¯ç¼–è¯‘å™¨æ‰§è¡Œï¼Œä»…å¼€å¯æ–¹æ³•ä»¥åŠå›è¾¹æ¬¡æ•°ç»Ÿè®¡ç­‰ä¼˜å…ˆçš„æ€§èƒ½ç›‘æ§åŠŸèƒ½ã€‚<br>ç¬¬ä¸‰å±‚ï¼šä½¿ç”¨å®¢æˆ·ç«¯ç¼–è¯‘å™¨æ‰§è¡Œï¼Œå¼€å¯å…¨éƒ¨æ€§èƒ½ç›‘æ§ï¼Œé™¤äº†ç¬¬2å±‚çš„ç—›å°±ä¹‹å¤–ï¼Œè¿˜ä¼šæ”¶é›†å¦‚åˆ†æ”¯è·³è½¬ã€è™šæ–¹æ³•è°ƒç”¨ç‰ˆæœ¬ç­‰å…¨éƒ¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚<br>ç¬¬å››å±‚ï¼šä½¿ç”¨æœåŠ¡ç«¯ç¼–è¯‘å™¨å°†å­—èŠ‚ç ç¼–è¯‘ä¸ºæœ¬åœ°ä»£ç ï¼ŒæœåŠ¡ç«¯ç¼–è¯‘å™¨ä¼šå¯ç”¨æ›´å¤šç¼–è¯‘è€—æ—¶æ›´é•¿çš„ä¼˜åŒ–ï¼Œè¿˜ä¼šæ ¹æ®æ€§èƒ½ç›‘æ§ä¿¡æ¯è¿›è¡Œä¸€äº›ä¸å¯é çš„æ¿€è¿›ä¼˜åŒ–ã€‚</p><p>å®æ–½åˆ†å±‚ç¼–è¯‘åï¼Œ è§£é‡Šå™¨ã€å®¢æˆ·ç«¯ç¼–è¯‘å™¨å’ŒæœåŠ¡ç«¯ç¼–è¯‘å™¨å°±ä¼šåŒæ—¶å·¥ä½œï¼Œçƒ­ç‚¹ä»£ç éƒ½å¯èƒ½ä¼šè¢«å¤šæ¬¡ç¼–è¯‘ï¼Œç”¨å®¢æˆ·ç«¯ç¼–è¯‘å™¨è·å¾—æ›´é«˜çš„ç¼–è¯‘é€Ÿåº¦ï¼Œç”¨æœåŠ¡ç«¯ç¼–è¯‘å™¨æ¥è·å–æ›´å¥½çš„ç¼–è¯‘è´¨é‡ï¼Œåœ¨è§£é‡Šæ‰§è¡Œçš„æ—¶å€™ä¹Ÿæ— éœ€é¢å¤–æ‰¿æ‹…æ‰‹æœºæ€§èƒ½ç›‘æ§ä¿¡æ¯çš„ä»»åŠ¡ï¼Œè€Œåœ¨æœåŠ¡ç«¯ç¼–è¯‘å™¨é‡‡ç”¨é«˜å¤æ‚åº¦çš„ä¼˜åŒ–ç®—æ³•æ—¶ï¼Œ å®¢æˆ·ç«¯ç¼–è¯‘å™¨å¯å…ˆé‡‡ç”¨ç®€å•ä¼˜åŒ–æ¥ä¸ºå®ƒäº‰å–æ›´å¤šçš„ç¼–è¯‘æ—¶é—´ã€‚</p><h4 id="ç¼–è¯‘å¯¹è±¡ä¸è§¦å‘æ¡ä»¶"><a href="#ç¼–è¯‘å¯¹è±¡ä¸è§¦å‘æ¡ä»¶" class="headerlink" title="ç¼–è¯‘å¯¹è±¡ä¸è§¦å‘æ¡ä»¶"></a>ç¼–è¯‘å¯¹è±¡ä¸è§¦å‘æ¡ä»¶</h4><p>è¢«ç¼–è¯‘çš„çƒ­ç‚¹ä»£ç æœ‰ï¼šè¢«å¤šæ¬¡è°ƒç”¨çš„æ–¹æ³•å’Œè¢«å¤šæ¬¡æ‰§è¡Œçš„å¾ªç¯ä½“ã€‚è¿™ä¸¤ç§æƒ…å†µç¼–è¯‘çš„ç›®æ ‡å¯¹è±¡éƒ½æ˜¯æ•´ä¸ªæ–¹æ³•ä½“ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„å¾ªç¯ä½“ã€‚</p><h4 id="åŸºäºé‡‡æ ·çš„çƒ­ç‚¹æ¢æµ‹"><a href="#åŸºäºé‡‡æ ·çš„çƒ­ç‚¹æ¢æµ‹" class="headerlink" title="åŸºäºé‡‡æ ·çš„çƒ­ç‚¹æ¢æµ‹"></a>åŸºäºé‡‡æ ·çš„çƒ­ç‚¹æ¢æµ‹</h4><p>å‘¨æœŸæ€§çš„æ£€æŸ¥çº¿ç¨‹çš„è°ƒç”¨æ ˆé¡¶ï¼Œå¦‚æœå‘ç°æŸä¸ªæ–¹æ³•ç»å¸¸å‡ºç°åœ¨æ ˆé¡¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±æ˜¯çƒ­ç‚¹æ–¹æ³•ã€‚<br>ä¼˜ç‚¹ï¼šç®€å•é«˜æ•ˆï¼Œå®¹æ˜“è·å–æ–¹æ³•çš„è°ƒç”¨å…³ç³»<br>ç¼ºç‚¹ï¼šä¸èƒ½ç²¾ç¡®ç¡®è®¤æ–¹æ³•çš„å¿ç¹ï¼Œå®¹æ˜“å—åˆ°çº¿ç¨‹é˜»å¡æˆ–è€…å¤–ç•Œå› ç´ å½±å“æ‰°ä¹±çƒ­ç‚¹æ¢æµ‹ã€‚</p><h4 id="åŸºäºè®¡æ•°å™¨çš„çƒ­ç‚¹æ¢æµ‹"><a href="#åŸºäºè®¡æ•°å™¨çš„çƒ­ç‚¹æ¢æµ‹" class="headerlink" title="åŸºäºè®¡æ•°å™¨çš„çƒ­ç‚¹æ¢æµ‹"></a>åŸºäºè®¡æ•°å™¨çš„çƒ­ç‚¹æ¢æµ‹</h4><p>ä¸ºæ¯ä¸ªæ–¹æ³•å»ºç«‹è®¡æ•°å™¨ï¼Œç»Ÿè®¡æ–¹æ³•çš„æ‰§è¡Œæ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡ä¸€å®šçš„é˜ˆå€¼å°±è®¤ä¸ºå®ƒæ˜¯çƒ­ç‚¹æ–¹æ³•ã€‚<br>ä¼˜ç‚¹ï¼šç»“æœç²¾ç¡®ä¸¥è°¨<br>ç¼ºç‚¹ï¼šæ¯ä¸ªæ–¹æ³•å»ºç«‹å¹¶ç»´æŠ¤è®¡æ•°å™¨ï¼Œä¸èƒ½ç›´æ¥è·å–åˆ°æ–¹æ³•çš„è°ƒç”¨å…³ç³»ã€‚<br>HotSpotä¸ºæ¯ä¸ªæ–¹æ³•å‡†å¤‡äº†ä¸¤ç±»è®¡æ•°å™¨ï¼šæ–¹æ³•è°ƒç”¨è®¡æ•°å™¨å’Œå›è¾¹è®¡æ•°å™¨ï¼ˆåœ¨å¾ªç¯è¾¹ç•Œå¾€å›è·³ï¼‰,å½“è°ƒç”¨æ¬¡æ•°è¶…è¿‡è®¾å®šçš„é˜ˆå€¼ï¼Œå°±ä¼šè§¦å‘å³æ—¶ç¼–è¯‘ã€‚<br>-XX:CompileThreshold æ¥è®¾å®šè§¦å‘å³æ—¶ç¼–è¯‘çš„é˜ˆå€¼ã€‚<br>é»˜è®¤è®¾ç½®ä¸‹ï¼Œæ–¹æ³•è°ƒç”¨è®¡æ•°å™¨ç»Ÿè®¡çš„æ˜¯ç›¸å¯¹æ‰§è¡Œç“¶ç»¿ï¼Œå½“ä¸€ä¸ªæ—¶é—´æ®µå†…è°ƒç”¨æ¬¡æ•°ä¸è¶³ä»¥æäº¤å³æ—¶ç¼–æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨è®¡æ•°å™¨å°±ä¼šè¢«å‡åŠï¼ˆè¡°å‡ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨-XX:-UseCounterDecayå…³é—­çƒ­åº¦è¡°å‡ã€‚å¯ä»¥è®¾ç½®-XX:CounterHalfLifeTimeè®¾ç½®åŠè¡°å‘¨æœŸçš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ã€‚</p><p>å½“æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¯¥æ–¹æ³•æ˜¯å¦è¢«å³ä½¿ç¼–è¯‘å™¨ç¼–è¯‘è¿‡ï¼Œæ˜¯åˆ™ä¼˜å…ˆä½¿ç”¨ç¼–è¯‘åçš„ç‰ˆæœ¬æ‰§è¡Œï¼Œå¦åˆ™å°†æ–¹æ³•è°ƒç”¨çš„è®¡æ•°å™¨åŠ ä¸€ï¼Œç„¶ååˆ¤æ–­æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨ä¸å›è¾¹è®¡æ•°å™¨å€¼ä¹‹å’Œæ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼Œè¶…è¿‡åˆ™åƒå³æ—¶ç¼–è¯‘å™¨æäº¤è¯¥æ–¹æ³•çš„ä»£ç ç¼–è¯‘è¯·æ±‚ã€‚<br>å¦‚æœæ²¡æœ‰åšè¿‡ä»»ä½•è®¾ç½®ï¼Œæ‰§è¡Œå¼•æ“é»˜è®¤ä¸ä¼šåŒæ­¥ç­‰å¾…ç¼–è¯‘è¯·æ±‚å®Œæˆï¼Œè€Œæ˜¯ç»§ç»­è¿›å…¥è§£é‡Šå™¨æŒ‰ç…§è§£é‡Šæ–¹å¼æ‰§è¡Œå­—èŠ‚ç ï¼Œç›´åˆ°æäº¤çš„è¯·æ±‚è¢«å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘å®Œæˆã€‚å½“ç¼–è¯‘å·¥ä½œå®Œæˆåï¼Œè¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨å…¥å£åœ°å€ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æ”¹å†™æˆæ–°å€¼ï¼Œä¸‹æ¬¡è°ƒç”¨è¯¥æ–¹æ³•æ—¶å°±ä¼šä½¿ç”¨å·²ç¼–è¯‘ç‰ˆæœ¬ã€‚</p><p><img src="/2020/06/11/%E7%BC%96%E8%AF%91%E4%B8%8E%E4%BC%98%E5%8C%96/comp.jpeg" alt="æ–¹æ³•è°ƒç”¨è®¡æ•°å™¨ è§¦å‘å³æ—¶ç¼–è¯‘"></p><p>å›è¾¹è®¡æ•°å™¨ï¼šç»Ÿè®¡ä¸€ä¸ªæ–¹æ³•ä¸­å¾ªç¯ä½“ä»£ç æ‰§è¡Œçš„æ¬¡æ•°ï¼Œåœ¨å­—èŠ‚ç ä¸­é‡åˆ°æ§åˆ¶æµå‘åè·³è½¬çš„æŒ‡ä»¤ç§°ä¸ºâ€œå›è¾¹â€,å›è¾¹è®¡æ•°å™¨çš„ç›®çš„æ˜¯ä¸ºäº†è§¦å‘æ ˆä¸Šçš„æ›¿æ¢ç¼–è¯‘ã€‚å›è¾¹è®¡æ•°å™¨æ²¡æœ‰çƒ­åº¦è¡°å‡è¿‡ç¨‹ã€‚</p><h3 id="ç¼–è¯‘è¿‡ç¨‹"><a href="#ç¼–è¯‘è¿‡ç¨‹" class="headerlink" title="ç¼–è¯‘è¿‡ç¨‹"></a>ç¼–è¯‘è¿‡ç¨‹</h3><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–¹æ³•è°ƒç”¨äº§ç”Ÿçš„æ ‡å‡†ç¼–è¯‘è¯·æ±‚å’Œæ ˆä¸Šæ›¿æ¢ç¼–è¯‘è¯·æ±‚ï¼Œåœ¨è™šæ‹Ÿæœºç¼–è¯‘å™¨æœªå®Œæˆç¼–è¯‘ä¹‹å‰ï¼Œéƒ½å°†æŒ‰ç…§è§£é‡Šæ–¹å¼æ‰§è¡Œä»£ç ï¼Œç¼–è¯‘åŠ¨ä½œåœ¨åå°çš„ç¼–è¯‘çº¿ç¨‹å®Œæˆã€‚<br>è®¾ç½®-XX:-BackgroundCompilationç¦æ­¢åå°ç¼–è¯‘ï¼Œç¦æ­¢åè§¦å‘å³æ—¶ç¼–è¯‘æ¡ä»¶æ—¶ï¼Œæ‰§è¡Œçº¿ç¨‹å‘è™šæ‹Ÿæœºæäº¤ç¼–è¯‘è¯·æ±‚åä¸€è‡´é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°ç¼–è¯‘è¿‡ç¨‹å®Œæˆåå†å¼€å§‹æ‰§è¡Œç¼–è¯‘å™¨è¾“å‡ºçš„æœ¬åœ°ä»£ç ã€‚</p><p>æœåŠ¡ç«¯ç¼–è¯‘å™¨æ•ˆç‡è¾ƒä½ï¼Œä½†æ˜¯ç¼–è¯‘é€Ÿåº¦è¿œè¶…ä¼ ç»Ÿçš„é™æ€ä¼˜åŒ–ç¼–è¯‘å™¨ï¼Œç›¸å¯¹äºå®¢æˆ·ç«¯ç¼–è¯‘å™¨ç¼–è¯‘è¾“å‡ºçš„ä»£ç è´¨é‡æœ‰å¾ˆå¤§çš„æäº¤ï¼Œå¯ä»¥å¤§å¹…é™ä½æœ¬åœ°ä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œä»è€ŒæŠµæ¶ˆæ‰é¢å¤–çš„ç¼–è¯‘æ°´é—´å¼€é”€ã€‚</p><h3 id="å³æ—¶ç¼–è¯‘çš„ç¼ºç‚¹"><a href="#å³æ—¶ç¼–è¯‘çš„ç¼ºç‚¹" class="headerlink" title="å³æ—¶ç¼–è¯‘çš„ç¼ºç‚¹"></a>å³æ—¶ç¼–è¯‘çš„ç¼ºç‚¹</h3><p>1ï¼‰å ç”¨ç¨‹åºè¿è¡Œæ—¶é—´<br>2ï¼‰å ç”¨ç¨‹åºè¿ç®—èµ„æº</p><h2 id="æå‰ç¼–è¯‘å™¨"><a href="#æå‰ç¼–è¯‘å™¨" class="headerlink" title="æå‰ç¼–è¯‘å™¨"></a>æå‰ç¼–è¯‘å™¨</h2><p>æå‰ç¼–è¯‘å™¨çš„åˆ†æ”¯ï¼š<br>ä¸ä¼ ç»ŸCã€C++ç¼–è¯‘å™¨ç±»ä¼¼ï¼Œåœ¨ç¨‹åºè¿è¡Œä¹‹å‰æŠŠç¨‹åºä»£ç ç¼–è¯‘æˆæœºå™¨ç çš„é™æ€ç¿»è¯‘å·¥ä½œï¼›<br>æŠŠåŸæœ¬å³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶è¦åšçš„ç¼–è¯‘å·¥ä½œæå‰åšå¥½å¹¶ä¿å­˜ä¸‹æ¥ï¼Œä¸‹æ¬¡è¿è¡Œåˆ°è¿™äº›ä»£ç æ—¶ç›´æ¥åŠ è½½è¿›æ¥ä½¿ç”¨ã€‚</p><h2 id="ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯"><a href="#ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯" class="headerlink" title="ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯"></a>ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯</h2><h3 id="æ–¹æ³•å†…è”"><a href="#æ–¹æ³•å†…è”" class="headerlink" title="æ–¹æ³•å†…è”"></a>æ–¹æ³•å†…è”</h3><p>æœ€é‡è¦çš„ä¼˜åŒ–æŠ€æœ¯ä¹‹ä¸€ã€‚</p><h3 id="é€ƒé€¸åˆ†æ"><a href="#é€ƒé€¸åˆ†æ" class="headerlink" title="é€ƒé€¸åˆ†æ"></a>é€ƒé€¸åˆ†æ</h3><p>æœ€å‰æ²¿çš„ä¼˜åŒ–æŠ€æœ¯ä¹‹ä¸€ã€‚</p><ul><li><p>æ ˆä¸Šåˆ†é…<br>æ”¯æŒæ–¹æ³•é€ƒé€¸ï¼Œä½†ä¸æ”¯æŒçº¿ç¨‹é€ƒé€¸</p></li><li><p>æ ‡é‡æ›¿æ¢<br>å¦‚æœä¸€ä¸ªæ•°æ®å·²ç»æ— æ³•åœ¨åˆ†è§£ä¸ºæ›´å°çš„æ•°æ®è¡¨ç¤ºæ—¶ï¼ˆåŸå§‹æ•°æ®ç±»å‹ï¼‰ï¼Œè¿™äº›æ•°æ®å°±å¯ä»¥ç§°ä¸ºæ ‡é‡ã€‚<br>æ ‡é‡æ›¿æ¢å°±æ˜¯å°†ç”¨åˆ°çš„æˆå‘˜å˜é‡æ¢å¤ä¸ºåŸå§‹ç±»å‹æ¥è®¿é—®çš„è¿‡ç¨‹ã€‚<br>åŠ å…¥é€ƒé€¸åˆ†æå¯ä»¥è¯æ˜ä¸€ä¸ªå¯¹è±¡ä¸ä¼šè¢«æ–¹æ³•å¤–éƒ¨è®¿é—®ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡å¯ä»¥è¢«æ‹†æ•£ï¼Œé‚£ä¹ˆç¨‹åºçœŸæ­£æ‰§è¡Œçš„æ—¶å€™å¯èƒ½ä¸å»åˆ›å»ºè¿™ä¸ªå¯¹è±¡ï¼Œè€Œæ”¹ä¸ºç›´æ¥åˆ›å»ºå®ƒçš„è‹¥å¹²ä¸ªè¢«è¿™ä¸ªçš„æ–¹æ³•ä½¿ç”¨çš„æˆå‘˜å˜é‡æ¥æ›¿ä»£ï¼Œæˆå‘˜å˜é‡å­˜å‚¨åœ¨æ ˆä¸Šã€‚</p><p>åŒæ­¥æ¶ˆé™¤ï¼šå¦‚æœé€ƒé€¸åˆ†æèƒ½å¤Ÿç¡®å®šä¸€ä¸ªå˜é‡ä¸ä¼šé€ƒé€¸å‡ºçº¿ç¨‹ï¼Œæ— æ³•è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡çš„è¯»å†™è‚¯å®šä¸ä¼šæœ‰ç«äº‰ï¼Œå¯¹è¿™ä¸ªå˜é‡çš„åŒæ­¥æªæ–½ä¹Ÿå¯ä»¥å®‰å…¨åœ°æ¶ˆé™¤æ‰ã€‚</p></li></ul><h3 id="å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤"><a href="#å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤" class="headerlink" title="å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤"></a>å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤</h3><p>è¯­è¨€æ— å…³çš„ç»å…¸ä¼˜åŒ–æŠ€æœ¯ã€‚å¦‚æœä¸€ä¸ªè¡¨è¾¾å¼Eä¹‹å‰å·²ç»è¢«è®¡ç®—è¿‡ï¼Œå¹¶ä¸”ä»å…ˆå‰çš„è®¡ç®—åˆ°ç°åœ¨Eä¸­æ‰€æœ‰å˜é‡çš„å€¼éƒ½æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆEçš„è¿™æ¬¡å‡ºç°å°±ç§°ä¸ºå…¬å…±å­è¡¨è¾¾å¼ã€‚</p><h3 id="æ•°ç»„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤"><a href="#æ•°ç»„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤" class="headerlink" title="æ•°ç»„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤"></a>æ•°ç»„è¾¹ç•Œæ£€æŸ¥æ¶ˆé™¤</h3><p>è¯­è¨€ç›¸å…³çš„ç»å…¸ä¼˜åŒ–æŠ€æœ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> ç¼–è¯‘ </tag>
            
            <tag> ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…å­˜åˆ†é…ä¸å›æ”¶</title>
      <link href="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/"/>
      <url>/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/</url>
      
        <content type="html"><![CDATA[<p>JavaæŠ€æœ¯ä½“ç³»çš„è‡ªåŠ¨å†…å­˜ç®¡ç†æœ€æ ¹æœ¬ç›®æ ‡æ˜¯è‡ªåŠ¨åŒ–åœ°ç»™å¯¹è±¡åˆ†é…å†…å­˜ä»¥åŠè‡ªåŠ¨å›æ”¶åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜ã€‚<br>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹å¹¶æœªè§„å®šæ–°å¯¹è±¡çš„åˆ›å»ºå’Œå­˜å‚¨ç»†èŠ‚ï¼Œè¿™å–å†³äºè™šæ‹Ÿæœºå½“å‰ä½¿ç”¨çš„æ˜¯å“ªç§åƒåœ¾æ”¶é›†å™¨ï¼Œä»¥åŠè™šæ‹Ÿæœºä¸­ä¸å†…å­˜ç›¸å…³çš„å‚æ•°è®¾å®šã€‚</p><h2 id="HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡çš„åˆ†é…åŸåˆ™"><a href="#HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡çš„åˆ†é…åŸåˆ™" class="headerlink" title="HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡çš„åˆ†é…åŸåˆ™"></a>HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡çš„åˆ†é…åŸåˆ™</h2><h4 id="å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…"><a href="#å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…" class="headerlink" title="å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…"></a>å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…</h4><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£EdenåŒºä¸­åˆ†é…ã€‚ å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡minorGCã€‚<br>å½“survivoråŒºçš„ç©ºé—´æ— æ³•å­˜æ”¾EdenåŒºçš„å¯¹è±¡æ—¶ï¼Œå°±ä¼šé€šè¿‡æ‹…ä¿æœºåˆ¶æå‰è½¬ç§»åˆ°è€å¹´ä»£å»ã€‚</p><p>-Xms:20M å †å†…å­˜åˆå§‹å€¼20M<br>-Xmx:20M å †å†…å­˜æœ€å¤§20M<br>-Xmn10M  æ–°ç”Ÿä»£å ç”¨10Mï¼ˆå‰©ä¸‹çš„10Mç•™ç»™è€å¹´ä»£ï¼‰<br>-XX:SurvivorRatio=8 å†³å®šäº†æ–°ç”Ÿä»£EdenåŒºä¸ä¸€ä¸ªSurvivoråŒºçš„ç©ºé—´æ¯”ä¾‹æ˜¯8:1:1</p><h4 id="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"><a href="#å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£" class="headerlink" title="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"></a>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</h4><p>å¤§å¯¹è±¡æ˜¯éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„Javaå¯¹è±¡ï¼Œå¦‚å¾ˆé•¿çš„å­—ç¬¦ä¸²æˆ–è€…å…ƒç´ æ•°é‡å¾ˆå¤šçš„æ•°ç»„ã€‚</p><p>åœ¨åˆ†é…ç©ºé—´æ—¶ï¼Œå¦‚æœå¯¹è±¡æ¯”è¾ƒå¤§ï¼Œå°±ä¼šæå‰è§¦å‘åƒåœ¾æ”¶é›†ï¼Œä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´æ‰èƒ½å­˜æ”¾è¯¥å¯¹è±¡ï¼Œ å½“å¤åˆ¶å¯¹è±¡æ—¶å¤§å¯¹è±¡æ„å‘³ç€é«˜é¢çš„å†…å­˜å¤åˆ¶å¼€é”€ã€‚</p><p>-XX:PretenureSizeThreshold=3145728 ï¼ˆå¤§äº3Mçš„å¯¹è±¡ä¼šç›´æ¥åˆ†é…åˆ°è€å¹´ä»£ä¸­ï¼‰<br>è¯¥å‚æ•°åªå¯¹Serialå’ŒParNewä¸¤æ¬¾æ”¶é›†å™¨æœ‰æ•ˆã€‚</p><h4 id="é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"><a href="#é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£" class="headerlink" title="é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"></a>é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</h4><p>å†…å­˜å›æ”¶æ—¶å¿…é¡»å†³ç­–é‚£äº›å­˜æ´»å¯¹è±¡åº”è¯¥å­˜æ”¾åœ¨æ–°ç”Ÿä»£ï¼Œå“ªäº›å­˜æ´»å¯¹è±¡å­˜æ”¾åœ¨è€å¹´ä»£ã€‚<br>è™šæ‹Ÿæœºä¸ºæ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„ï¼ˆAgeï¼‰å­˜å‚¨åœ¨å¯¹è±¡å¤´é‡ã€‚</p><p>å¯¹è±¡é€šå¸¸åœ¨EdenåŒºè¯ç”Ÿï¼Œå¦‚æœç»è¿‡ä¸€æ¬¡MinorGCåä»ç„¶å­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢«Survivorå®¹çº³çš„è¯ï¼Œä¼šè¢«ç§»åŠ¨åˆ°Survivorç©ºé—´ï¼Œå¹¶ä¸”å°†å¯¹è±¡çš„å¹´é¾„è®¾ç½®ä¸º1å²ã€‚å¯¹è±¡åœ¨Survivorä¸­æ¯ç»è¿‡ä¸€æ¬¡MinorGCï¼ŒAgeå¢åŠ 1ï¼Œ å½“å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­ã€‚<br>å¯ä»¥é€šè¿‡-XX:MaxTenuringThresholdè®¾ç½®ï¼ˆé»˜è®¤ä¸º15æ¬¡ï¼‰ã€‚</p><h4 id="åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"><a href="#åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š" class="headerlink" title="åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"></a>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</h4><p>å¦‚æœåœ¨Survivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äºSurvivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–è€…ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— éœ€ç­‰åˆ°-XX:MaxTenuringThresholdä¸­è¦æ±‚çš„å¹´é¾„ã€‚</p><p>ä¹Ÿå°±æ˜¯å½“å‰Survivorç©ºé—´å¤§å°ä¸º1Mï¼Œæœ‰ä¸¤ä¸ªAge=1ä¸”å¤§å°ä¸º256kçš„å¯¹è±¡æ—¶ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å°±ä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚</p><h4 id="ç©ºé—´åˆ†é…æ‹…ä¿"><a href="#ç©ºé—´åˆ†é…æ‹…ä¿" class="headerlink" title="ç©ºé—´åˆ†é…æ‹…ä¿"></a>ç©ºé—´åˆ†é…æ‹…ä¿</h4><p>åœ¨å‘ç”ŸMinorGCä¹‹å‰ï¼Œè™šæ‹Ÿæœºå¿…é¡»å…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ã€‚<br>å¦‚æœæ¡ä»¶æˆç«‹ï¼Œé‚£ä¹ˆè¿™æ¬¡MinorGCæ—¶å®‰å…¨çš„ï¼›ï¼›<br>å¦‚æœä¸æˆç«‹ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæŸ¥çœ‹-XX:HandlerPromotionFailureå‚æ•°çš„è®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥<br>   å¦‚æœå…è®¸æ‹…ä¿å¤±è´¥ï¼Œç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡ä»Šç”Ÿåˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°<br>      å¤§äºï¼Œå°è¯•è¿›è¡Œä¸€æ¬¡MinorGCï¼›<br>      å°äºï¼Œæˆ–è€…-XX:HandlePromotionFailureä¸å…è®¸å†’é™©ï¼Œåˆ™å˜æ›´ä¸ºFullGCã€‚</p><p>åœ¨JDK6 Update24ä¹‹åçš„è§„åˆ™å˜ä¸ºåªè¦è€å¹´ä»£çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£æ€»å¤§å°æˆ–è€…å†æ¬¡æ™‹å‡çš„å¹³å‡å¤§å°ï¼Œå°±ä¼šè¿›è¡ŒMinorGCï¼Œå¦åˆ™å°±è¿›è¡ŒFullGcã€‚-XX:HandlePromotionFailureå‚æ•°ä¸åœ¨ç”Ÿæ•ˆã€‚</p><h2 id="åƒåœ¾çš„å›æ”¶"><a href="#åƒåœ¾çš„å›æ”¶" class="headerlink" title="åƒåœ¾çš„å›æ”¶"></a>åƒåœ¾çš„å›æ”¶</h2><ul><li>å“ªäº›å†…å­˜éœ€è¦å›æ”¶</li><li>ä»€ä¹ˆæ—¶å€™å›æ”¶</li><li>å¦‚ä½•å›æ”¶</li></ul><h4 id="å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²æ­»"><a href="#å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²æ­»" class="headerlink" title="å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²æ­»"></a>å¦‚ä½•åˆ¤æ–­å¯¹è±¡å·²æ­»</h4><ul><li>å¼•ç”¨è®¡æ•°å™¨</li><li>å¯è¾¾æ€§åˆ†æç®—æ³•ï¼ˆå›ºå®šå¯ä½œä¸ºGCRootçš„å¯¹è±¡æœ‰ï¼‰<ul><li>åœ¨è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ï¼Œè­¬å¦‚æ¯ä¸ªçº¿ç¨‹èƒŒè°ƒç”¨çš„æ–¹æ³•å †æ ˆä¸­ä½¿ç”¨çš„å‚æ•°ã€å±€éƒ¨å˜é‡ã€ä¸´æ—¶å˜é‡</li><li>åœ¨æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼Œå¦‚Javaç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡</li><li>åœ¨æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œå¦‚å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å¼•ç”¨</li><li>åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIå¼•ç”¨çš„å¯¹è±¡</li><li>Javaè™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨ï¼Œå¦‚åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„Classå¯¹è±¡ï¼Œä¸€äº›å¸¸é©»çš„å¼‚å¸¸å¯¹è±¡ï¼Œç³»ç»Ÿç±»åŠ è½½å™¨</li><li>æ‰€æœ‰èƒŒåŒæ­¥é”æŒæœ‰çš„å¯¹è±¡</li><li>åæ˜ Javaè™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„JMXBeanã€JVMTIä¸­æ³¨å†Œçš„å›è°ƒã€æœ¬åœ°ä»£ç ç¼“å­˜ç­‰ã€‚</li></ul></li></ul><h4 id="å¯¹è±¡çš„å¼•ç”¨"><a href="#å¯¹è±¡çš„å¼•ç”¨" class="headerlink" title="å¯¹è±¡çš„å¼•ç”¨"></a>å¯¹è±¡çš„å¼•ç”¨</h4><ul><li>å¼ºå¼•ç”¨ï¼Œå¦‚Object obj = new Object(); æ— è®ºä»»ä½•æƒ…å†µä¸‹ï¼Œåªè¦å¼ºå¼•ç”¨å…³ç³»å­˜åœ¨ï¼Œåƒåœ¾æ”¶é›†å™¨å°±æ°¸è¿œä¸ä¼šå›æ”¶æ‰èƒŒå¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>è½¯å¼•ç”¨ï¼Œæè¿°æœ‰ç”¨ä½†éå¿…é¡»çš„å¯¹è±¡ï¼Œè¢«è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡åœ¨ç³»ç»Ÿå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå‰ä¼šæŠŠè¿™äº›å¯¹è±¡ä¾‹å¦‚å›æ”¶èŒƒå›´å†…è¿›è¡ŒäºŒæ¬¡å›æ”¶ã€‚ï¼ˆSoftReferenceï¼‰</li><li>å¼±å¼•ç”¨ï¼Œæè¿°éå¿…é¡»å¯¹è±¡ï¼Œè¢«å¼±å¼•ç”¨çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å‘ç”Ÿä½ç½®ã€‚æ— è®ºå†…å­˜æ˜¯å¦è¶³å¤Ÿï¼Œéƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚</li><li>è™šå¼•ç”¨ï¼Œä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå¯¹å…¶ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“ï¼Œä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨æ¥å–å¾—ä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„æ—¶ä¸ºäº†èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶å—åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼ˆNIOç”¨çš„RdirectMemoryï¼‰</li></ul><h2 id="åƒåœ¾æ”¶é›†å™¨ç®—æ³•"><a href="#åƒåœ¾æ”¶é›†å™¨ç®—æ³•" class="headerlink" title="åƒåœ¾æ”¶é›†å™¨ç®—æ³•"></a>åƒåœ¾æ”¶é›†å™¨ç®—æ³•</h2><h4 id="åˆ†ä»£æ”¶é›†ç†è®º"><a href="#åˆ†ä»£æ”¶é›†ç†è®º" class="headerlink" title="åˆ†ä»£æ”¶é›†ç†è®º"></a>åˆ†ä»£æ”¶é›†ç†è®º</h4><p>å»ºç«‹åœ¨ä¸¤ä¸ªåˆ†ä»£å‡è¯´ä¸Šï¼š<br>1ï¼‰å¼±åˆ†ä»£å‡è¯´ï¼Œç»å¤§æ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„ã€‚<br>2ï¼‰å¼ºåˆ†ä»£å‡è¯´ï¼Œç»è¿‡è¶Šå¤šæ¬¡æ”¶é›†è¿‡ç¨‹çš„å¯¹è±¡æœˆéš¾æ¶ˆäº¡ã€‚<br>3ï¼‰ï¼ˆæ¨ç†å‡è¯´ï¼‰è·¨ä»£å¼•ç”¨å‡è¯´ï¼Œè·¨ä»£å¼•ç”¨ç›¸å¯¹äºåŒä»£æ¥è¯´ä»…å æå°‘æ•°ã€‚</p><h5 id="åˆ†ä»£æ”¶é›†åŒºåŸŸ"><a href="#åˆ†ä»£æ”¶é›†åŒºåŸŸ" class="headerlink" title="åˆ†ä»£æ”¶é›†åŒºåŸŸ"></a>åˆ†ä»£æ”¶é›†åŒºåŸŸ</h5><ul><li>éƒ¨åˆ†æ”¶é›†ï¼ˆPartial GCï¼‰<ul><li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC/ Yong GCï¼‰</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC / Old GCï¼‰ï¼ˆåªæœ‰CMSä¼šå•ç‹¬å›æ”¶è€å¹´ä»£ï¼‰</li><li>æ··åˆæ”¶é›†(Mixed GC)ï¼Œç›®å‰åªæœ‰GCå­˜åœ¨æ··åˆå›æ”¶è¡Œä¸ºã€‚</li></ul></li><li>æ•´å †æ”¶é›†(Full GC)</li></ul><h4 id="æ ‡è®°æ¸…é™¤ç®—æ³•"><a href="#æ ‡è®°æ¸…é™¤ç®—æ³•" class="headerlink" title="æ ‡è®°æ¸…é™¤ç®—æ³•"></a>æ ‡è®°æ¸…é™¤ç®—æ³•</h4><p>æ ‡è®°éœ€è¦è¢«å›æ”¶çš„å¯¹è±¡åï¼Œå›æ”¶æ‰æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ï¼›<br>æˆ–è€…æ ‡è®°ä¸éœ€è¦è¢«å›æ”¶çš„å¯¹è±¡ï¼ŒåŒä¸€å›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚</p><p>ç¼ºç‚¹ï¼š<br>ä¸ç¨³å®šï¼Œæ ‡è®°æ¸…é™¤çš„æ€§èƒ½éšç€å¯¹è±¡çš„å¢å¤šè€Œé™ä½ï¼›<br>ç©ºé—´ç¢ç‰‡åŒ–é—®é¢˜ï¼Œè‚¯èƒ½ä¼šå¯¼è‡´åœ¨åˆ†é…è¾ƒå¤§å¯¹è±¡æ—¶æ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­ç©ºé—´å†…å­˜ä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/ms.jpeg" alt="mark-sweep"></p><h4 id="æ ‡è®°å¤åˆ¶ç®—æ³•"><a href="#æ ‡è®°å¤åˆ¶ç®—æ³•" class="headerlink" title="æ ‡è®°å¤åˆ¶ç®—æ³•"></a>æ ‡è®°å¤åˆ¶ç®—æ³•</h4><p>ä¸ºäº†è§£å†³æ ‡è®°æ¸…é™¤ç®—æ³•é¢å¯¹å¤§é‡å¯å›æ”¶å¯¹è±¡æ—¶æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ã€‚</p><p>ä¼˜ç‚¹ï¼šåªéœ€è¦å¤åˆ¶å°‘æ•°å­˜æ´»å¯¹è±¡ï¼Œç®€å•é«˜æ•ˆ<br>ç¼ºç‚¹ï¼šæµªè´¹å†…å­˜ç©ºé—´ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/mc.jpeg" alt="mark-copy"></p><p>æ ¹æ®å¼±åˆ†ä»£å‡è¯´ï¼Œä»¥åŠå®é™…æƒ…å†µï¼Œå¤§éƒ¨åˆ†çš„å¯¹è±¡åœ¨ç¬¬ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶å°±ä¼šè¢«å›æ”¶ï¼Œå› æ­¤å¹¶ä¸éœ€è¦æŒ‰ç…§1:1çš„æ¯”ä¾‹æ¥åˆ’åˆ†æ–°ç”Ÿä»£çš„å†…å­˜ç©ºé—´ã€‚<br>å†…å­˜è¢«åˆ†ä¸ºè¾ƒå¤§çš„EdenåŒºå’Œè¾ƒå°çš„ä¸¤ä¸ªSurvivoråŒºåŸŸï¼ŒHotSpoté»˜è®¤æ¯”ä¾‹æ˜¯8:1:1ã€‚<br>æ‰“ç»™ä½ Survivorç©ºé—´ä¸è¶³å®¹çº³ä¸€æ¬¡MinorGCåå­˜æ´»çš„å¯¹æˆé‚£ä¸ªæ—¶ï¼Œå°±éœ€è¦ä¾èµ–å…¶ä»–å†…å­˜åŒºåŸŸè¿›è¡Œåˆ†é…æ‹…ä¿ã€‚</p><h4 id="æ ‡è®°æ•´ç†ç®—æ³•"><a href="#æ ‡è®°æ•´ç†ç®—æ³•" class="headerlink" title="æ ‡è®°æ•´ç†ç®—æ³•"></a>æ ‡è®°æ•´ç†ç®—æ³•</h4><p>æ ¹æ®è€å¹´ä»£å¯¹è±¡çš„å­˜äº¡ç‰¹å¾ä»¥åŠå¼ºåˆ†ä»£å‡è¯´æå‡ºçš„ç®—æ³•ã€‚<br>å°†æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡å‘å†…å­˜ç©ºé—´çš„ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/mark-compact.jpeg" alt="mark-compact"></p><p>ååé‡ï¼šèµ‹å€¼å™¨å’Œæ”¶é›†å™¨çš„æ•ˆç‡æ€»å’Œã€‚<br>å¦‚æœåœ¨æ¸…ç†æ—¶ç§»åŠ¨ï¼Œå¿…ç„¶ä¼šå½±å“åˆ°å¯¹è±¡å›æ”¶çš„æ•ˆç‡ã€‚<br>å¦‚æœæ¸…ç†æ—¶ä¸ç§»åŠ¨ï¼Œå¿…ç„¶ä¼šå½±å“åˆ°å¯¹è±¡åˆ†é…çš„æ•ˆç‡ã€‚</p><h2 id="å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨"><a href="#å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨"></a>å¸¸è§çš„åƒåœ¾æ”¶é›†å™¨</h2><h4 id="Serial-SerialOld"><a href="#Serial-SerialOld" class="headerlink" title="Serial / SerialOld"></a>Serial / SerialOld</h4><p>Serialæ”¶é›†å™¨æ˜¯æœ€å¤è€çš„æ”¶é›†å™¨ï¼Œä½¿ç”¨æ ‡è®°æ‹·è´ç®—æ³•ï¼Œåœ¨è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸã€‚<br>ä¼˜ç‚¹ï¼šåœ¨å†…å­˜è¾ƒå°çš„æ¡Œé¢åº”ç”¨æˆ–è€…Clientæ¨¡å¼ä¸‹ï¼Œé¢å¤–å†…å­˜æ¶ˆè€—æœ€å°ï¼Œç®€å•é«˜æ•ˆã€‚</p><p>SerialOldåŒæ ·æ˜¯å•çº¿ç¨‹æ”¶é›†èµ·ï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ã€‚å½“CMSæ”¶é›†èµ·å‘ç”Ÿå¤±è´¥æ—¶ä¼šè½¬ä¸ºSerialOldå·¥ä½œã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/serialGC.jpeg" alt="Serial GC"></p><h4 id="PS-PO"><a href="#PS-PO" class="headerlink" title="PS / PO"></a>PS / PO</h4><p>Paralle Scavenge/ Paralle Old çš„ç›®æ ‡æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§çš„ååé‡ã€‚</p><p>ParalleScavenge åŒæ ·æ˜¯åŸºäºæ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¹¶å‘æ”¶é›†ï¼Œ<br>ååé‡ = ï¼ˆè¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ï¼‰/(è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´+è¿è¡Œåƒåœ¾æ”¶é›†æ—¶é—´)<br>-XX:MaxGCPauseMillis æ§åˆ¶æœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´<br>-XX:GCTimeRatio æ§åˆ¶åƒåœ¾æ”¶é›†æ—¶é—´å æ€»æ—¶é—´çš„æ¯”ç‡<br>-XX:+UseAdaptiveSizePolicy å°±ä¸éœ€è¦äººå·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ŒEdenäºSurvivorçš„æ¯”ä¾‹ï¼Œä»¥åŠæ™‹å‡è€å¹´ä»£çš„å¤§å°ï¼Œè™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ã€‚</p><p>ParalleOld æ”¶é›†è€å¹´ä»£ï¼ŒåŸºäºæ ‡è®°æ•´ç†ç®—æ³•ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/pspo.jpeg" alt="Paralle Scavenge / Paralle Old"></p><h4 id="ParNew-CMS"><a href="#ParNew-CMS" class="headerlink" title="ParNew / CMS"></a>ParNew / CMS</h4><p>ParNewæ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹å¹¶è¡Œç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šæ¡çº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†ä¹‹å¤–ï¼Œå…¶ä½™è¡Œä¸ºä¸Serialæ”¶é›†èµ·å®Œå…¨ä¸€è‡´ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/ParNewSerialOld.jpeg" alt="ParNew / SerialOld"></p><p>CMDæ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®çš„çš„æ”¶é›†å™¨ã€‚ç¬¦åˆå¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´å°½å¯èƒ½çŸ­ï¼Œä»¥ç»™ç”¨æˆ·å¸¦æ¥è‰¯å¥½äº¤äº’ä½“éªŒçš„éœ€æ±‚ã€‚ä»–æ˜¯ä¸€ç§æ ‡è®°-æ¸…é™¤ç®—æ³•å®ç°çš„ã€‚<br>åŒ…å«å››ä¸ªæ­¥éª¤ï¼š<br>1ï¼‰åˆå§‹æ ‡è®°<br>2ï¼‰å¹¶å‘æ ‡è®°<br>3ï¼‰é‡æ–°æ ‡è®°<br>4ï¼‰å¹¶å‘æ¸…é™¤</p><p>å…¶ä¸­åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°è¿™ä¸¤ä¸ªæ­¥éª¤ä»éœ€è¦STWã€‚<br>åˆå§‹æ ‡è®°ä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹GC Rootsèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ã€é€Ÿåº¦å¾ˆå¿«ï¼›<br>å¹¶å‘æ ‡è®°é˜¶æ®µå°±æ˜¯ä»GC Rootsçš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹è€—æ—¶é•¿ï¼Œä½†ä¸éœ€è¦åœé¡¿ç”¨æˆ·çº¿ç¨‹ï¼Œå¯ä»¥ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸€èµ·å¹¶å‘è¿è¡Œï¼›<br>é‡æ–°æ ‡è®°ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„éƒ¨åˆ†ï¼Œè¿™ä¸ªé˜¶æ®µæ¯”åˆå§‹æ ‡è®°è€—æ—¶ç¨é•¿ï¼›<br>å¹¶å‘æ¸…é™¤ï¼Œæ¸…ç†åˆ é™¤æ‰æ ‡è®°é˜¶æ®µåˆ¤æ–­å·²ç»æ­»äº¡çš„å¯¹è±¡ï¼Œä¸éœ€è¦ç§»åŠ¨å“¦å­˜æ´»å¯¹è±¡ï¼Œå› æ­¤è¿™ä¸ªé˜¶æ®µä¹Ÿæ˜¯ä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶å¹¶å‘ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/cms.jpeg" alt="CMS"></p><p>CMSç¼ºç‚¹ï¼š<br>1ï¼‰ è€—CPUèµ„æº<br>2ï¼‰ æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œç”±äºé¢„ç•™çš„å†…å­˜æ— æ³•åˆ†é…æ–°å¯¹è±¡æ—¶ï¼Œæœ‰å¯èƒ½å‡ºç°å›æ”¶å¤±è´¥è€Œå¯¼è‡´é€€åŒ–åˆ°Serial Oldçš„æ¨¡å¼æ”¶é›†ã€‚<br>3ï¼‰åˆ†é…å ç”¨å¤§ç©ºé—´çš„å¯¹è±¡æ—¶ï¼Œä¼šå‡ºç°è€å¹´ä»£è¿˜æœ‰å¾ˆå¤šå‰©ä½™ç©ºé—´ï¼Œä½†æ˜¯æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´åˆ†é…å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘FullGCã€‚<br>æä¾›äº†ä¸¤ä¸ªå‚æ•°ä¼˜åŒ–ï¼Œä½†æ˜¯JDK1.9ä¹‹åå·²ç»åºŸå¼ƒï¼š<br>-XX:UseCMS-CompactAtFullCollection ä¸å¾—ä¸è¿›è¡ŒFullGCæ—¶å¼€å¯å†…å­˜ç¢ç‰‡çš„åˆå¹¶æ•´ç†ã€‚<br>-XX:CMSFullGCsBefore-Compactionï¼Œè¦æ±‚CMSæ”¶é›†å™¨åœ¨æ‰§è¡Œè¿‡è‹¥å¹²æ¬¡ä¸æ•´ç†ç©ºé—´çš„FullGCä¹‹åï¼Œä¸‹ä¸€æ¬¡è¿›å…¥FullGCå‰è¿›è¡Œç¢ç‰‡æ•´ç†ã€‚</p><h4 id="Garbage-First"><a href="#Garbage-First" class="headerlink" title="Garbage First"></a>Garbage First</h4><p>G1æ—¶ä¸€æ¬¾ä¸»è¦é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ã€‚</p><p>åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºMæ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´å¤§æ¦‚ç‡ä¸è¶…è¿‡Næ¯«ç§’è¿™æ ·çš„ç›®æ ‡ã€‚</p><p>G1é¢å‘å †å†…å­˜ä»»ä½•éƒ¨åˆ†æ¥ç»„æˆå›æ”¶é›†ï¼ˆCollectionSetï¼‰è¿›è¡Œå›æ”¶ï¼Œè¡¡é‡æ ‡å‡†ä¸å†æ˜¯å®ƒå±äºå“ªä¸ªåˆ†ä»£ï¼Œè€Œæ˜¯å“ªå—å†…å­˜ä¸­å­˜æ”¾çš„åƒåœ¾æ•°é‡æœ€å¤šï¼Œå›æ”¶æ”¶ç›Šæœ€å¤§ï¼Œè¿™å°±æ˜¯G1æ”¶é›†å™¨çš„MixedGCæ¨¡å¼ã€‚</p><p>G1æŠŠè¿ç»­çš„Javaå †å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œæ¯ä¸ªRegionéƒ½å¯ä»¥æ ¹æ®éœ€è¦æ‰®æ¼” æ–°ç”Ÿä»£çš„Edenç©ºé—´Survivorç©ºé—´ï¼Œæˆ–è€…è€å¹´ä»£ç©ºé—´ã€‚æ”¶é›†å™¨èƒ½å¤Ÿå¯¹ä¸åŒè§’è‰²çš„Regioné‡‡ç”¨ä¸åŒçš„=ç­–ç•¥å–å¤„ç†ï¼Œè¿™æ ·æ— è®ºæ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡è¿˜æ˜¯å­˜æ´»äº†ä¸€æ®µæ—¶é—´ã€ç»è¿‡å¤šæ¬¡æ”¶é›†çš„æ—§å¯¹è±¡éƒ½èƒ½è·å¾—å¾ˆå¥½çš„æ”¶é›†å†ç†¬è¿‡ã€‚</p><p>Regionä¸­æœ‰ä¸€ç±»HumongousåŒºåŸŸä¸“é—¨å­˜æ”¾å¤§å¯¹è±¡ã€‚ G1è®¤ä¸ºåªè¦å¤§å°è¶…è¿‡äº†ä¸€ä¸ªRegionå®¹é‡çš„ä¸€èˆ¬çš„å¯¹è±¡å°±å¯ä»¥åˆ¤å®šä¸ºå¤§å¯¹è±¡ã€‚æ¯ä¸ªRegionçš„å¤§å°å¯ä»¥é€šè¿‡å‚æ•°-XX:G1HeapRegionSizeè®¾å®šï¼Œå–å€¼èŒƒå›´1MBï½32MBï¼Œä¸”åº”ä¸º2çš„Næ¬¡å¹‚ã€‚é‚£äº›è¶…è¿‡äº†æ•´ä¸ªRegionå®¹é‡çš„è¶…çº§å¤§å¯¹è±¡ï¼Œä¼šè¢«å­˜æ”¾åœ¨Nä¸ªè¿ç»­çš„HumongousRegionä¹‹ä¸­ï¼ŒG1çš„å¤§å¤šæ•°è¡Œä¸ºéƒ½æŠŠHumongousRegionä½œä¸ºè€å¹´ä»£çš„ä¸€éƒ¨åˆ†è¿›è¡Œçœ‹å¾…ã€‚</p><p>Gå› ä¸ºå°†Regionä½œä¸ºå•è¯å›æ”¶çš„æœ€å°å•å…ƒï¼Œæ‰€ä»¥å¯ä»¥å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ã€‚<br>æ¯æ¬¡æ ¹æ®ç”¨æˆ·è®¾ç½®çš„åœé¡¿æ—¶é—´-XX:MaxGCPauseMillisï¼Œ ä¼˜å…ˆå¤„ç†å›æ”¶ä»·å€¼æ”¶ç›Šæœ€å¤§çš„é‚£äº›Regionã€‚<br>è¿™ç§ä½¿ç”¨Regionåˆ’åˆ†å†…å­˜ç©ºé—´ï¼Œä»¥åŠå…·æœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼ï¼Œä¿è¯äº†G1æ”¶é›†å™¨åœ¨æ‚ é—²çš„æ—¶é—´å†…è·å–å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/G1Region.jpeg" alt="G1 Region"></p><h5 id="éœ€è¦è§£å†³çš„é—®é¢˜"><a href="#éœ€è¦è§£å†³çš„é—®é¢˜" class="headerlink" title="éœ€è¦è§£å†³çš„é—®é¢˜"></a>éœ€è¦è§£å†³çš„é—®é¢˜</h5><p>1ï¼‰è·¨Regionå¼•ç”¨çš„å¯¹è±¡ï¼š æ¯ä¸ªRegionéƒ½ç»´æŠ¤è‡ªå·±çš„è®°å¿†é›†é¿å…å…¨å †ä½œä¸ºGCRootsæ‰«æï¼Œ è¿™äº›è®°å¿†é›†ä¼šè®°å½•ä¸‹åˆ«çš„RegionæŒ‡å‘è‡ªå·±çš„æŒ‡é’ˆï¼Œå¹¶æ ‡è®°è¿™äº›æŒ‡é’ˆåˆ†åˆ«åœ¨å“ªäº›å¡é¡µçš„èŒƒå›´ä¹‹å†…ã€‚<br>G1çš„è®°å¿†é›†æ˜¯ä¸€ç§Hashè¡¨ï¼ŒKeyæ—¶åˆ«çš„Regionçš„èµ·å§‹åœ°å€ï¼ŒValueæ—¶ä¸€ä¸ªé›†åˆï¼Œé‡Œé¢å­˜å‚¨çš„å…ƒç´ æ—¶å¡è¡¨çš„ç´¢å¼•å·ã€‚è¿™ç§åŒå‘çš„å¡è¡¨ç»“æ„è®°å½•äº†æˆ‘æŒ‡å‘è°å’Œè°æŒ‡å‘äº†æˆ‘ï¼Œå› æ­¤G1åªå°‘éœ€è¦è€—è´¹å¤§çº¦10%ï½20%çš„é¢å¤–å†…å­˜æ¥ç»´æŒæ”¶é›†å·¥ä½œã€‚</p><p>2ï¼‰åœ¨å¹¶å‘é˜¶æ®µå¦‚ä½•ä¿è¯æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹äº’ä¸å¹²æ‰°åœ°è¿è¡Œï¼Ÿ<br>ç”¨æˆ·çº¿ç¨‹åœ¨æ”¹å˜å¯¹è±¡å¼•ç”¨å…³ç³»çš„æ—¶å€™ï¼Œå¿…é¡»ä¿è¯ä¸èƒ½æ‰“ç ´åŸæœ¬çš„å¯¹è±¡å›¾ç»“æ„ï¼Œå¯¼è‡´æ¯”é˜¿å‰ç»“æœå‡ºç°é”™è¯¯ï¼Œ<br>CMSä½¿ç”¨å¢é‡æ›´æ–°ç®—æ³•ï¼ŒG1ä½¿ç”¨åŸå§‹å¿«ç…§ç®—æ³•æ¥å®ç°ã€‚</p><p>åƒåœ¾æ”¶é›†å¯¹ç”¨æˆ·çº¿ç¨‹çš„å½±å“è¿˜ä½“ç°åœ¨å›æ”¶è¿‡ç¨‹ä¸­å¿ƒçª—å·å¯¹è±¡çš„å†…å­˜åˆ†é…ä¸Šï¼Œç¨‹åºè¦ç»§ç»­è¿è¡Œå°±è‚¯å®šä¼šæŒç»­æœ‰æ–°å¯¹è±¡å‘—åˆ›å»ºï¼ŒG1ä½æ¯ä¸ªRegionè®¾è®¡äº†ä¸¤ä¸ªåä¸ºTAMSï¼ˆTOp at Mark Startï¼‰çš„æŒ‡é’ˆï¼ŒæŠŠRegionä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´åˆ’åˆ†å‡ºæ¥ç”¨äºå¹¶å‘å›æ”¶è¿‡ç¨‹ä¸­çš„æ–°å¯¹è±¡åˆ†é…ï¼Œå¹¶å‘å›æ”¶æ—¶å¿ƒåˆ†é…çš„å¯¹è±¡åœ°å€éƒ½å¿…é¡»è¦åœ¨è¿™ä¸¤ä¸ªæŒ‡é’ˆä½ç½®ä»¥ä¸Šã€‚G1æ”¶é›†å™¨é»˜è®¤åœ¨è¿™ä¸ªåœ°å€ä»¥ä¸Šçš„å¯¹è±¡æ—¶è¢«éšå¼æ ‡è®°è¿‡çš„ï¼Œä¸çº³å…¥å›æ”¶èŒƒå›´ã€‚å¦‚æœå†…å­˜å›æ”¶çš„é€Ÿåº¦èµ¶ä¸ä¸Šå†…å­˜åˆ†é…çš„é€Ÿåº¦ï¼ŒG1æ”¶é›†å™¨ä¹Ÿè¦è¢«è¿«å†»ç»“ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œï¼Œå¯¼è‡´FullGCè€Œäº§ç”Ÿé•¿æ—¶é—´çš„STWã€‚</p><p>3ï¼‰å¦‚ä½•å»ºç«‹å¯é çš„åœé¡¿æ¨¡å‹<br>G1çš„åœé¡¿é¢„æµ‹æ¨¡å‹æ—¶ä»¥è¡°å‡å‡å€¼ä¸ºç†è®ºåŸºç¡€å®ç°çš„ï¼Œåœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­ï¼ŒG1æ”¶é›†å™¨ä¼šè®°å½•æ¯ä¸ªRegionçš„å›æ”¶è€—æ—¶ã€æ¯ä¸ªRegionè®°å¿†é›†é‡Œçš„è„å¡æ•°é‡ç­‰å„ä¸ªå¯ä»¥æµ‹é‡çš„æ­¥éª¤è¯è´¹çš„æˆæœ¬ï¼Œå¹¶åˆ†æå¾—å‡ºå¹³å‡å€¼ï¼Œæ ‡å‡†åå·®ã€å¯è¡Œåº¦ç­‰ç»Ÿè®¡ä¿¡æ¯ï¼Œè¡°å‡å¹³å‡å€¼æ—¶æ¯”æ™®é€šçš„å¹³å‡å€¼æ›´å®¹æ˜“å—åˆ°æ–°æ•°æ®çš„å½±å“ï¼Œå¹³å‡å€¼æ›´å®¹æ˜“å—åˆ°æ–°æ•°æ®çš„å½±å“ï¼Œå¹³å‡å€¼ä»£è¡¨æ•´ä½“å¹³å‡çŠ¶æ€ï¼Œè¡°å‡å‡å€¼ä»£è¡¨æœ€è¿‘çš„å¹³å‡çŠ¶æ€ã€‚ Regionçš„ç»Ÿè®¡çŠ¶æ€è¶Šæ–°è¶Šèƒ½å†³å®šå™¨å›æ”¶çš„ä»·å€¼ã€‚é€šè¿‡è¿™äº›ä¿¡æ¯é¢„æµ‹ç°åœ¨å¼€å§‹å›æ”¶çš„è¯ï¼Œå“ªäº›regionç»„æˆå›æ”¶é›†é‡‡å¯ä»¥åœ¨ä¸è¶…è¿‡æœŸæœ›åœé¡¿æ—¶é—´çš„çº¦æŸä¸‹è·å¾—æœ€é«˜çš„æ”¶ç›Šã€‚</p><h4 id="G1çš„å›æ”¶æ­¥éª¤"><a href="#G1çš„å›æ”¶æ­¥éª¤" class="headerlink" title="G1çš„å›æ”¶æ­¥éª¤"></a>G1çš„å›æ”¶æ­¥éª¤</h4><h5 id="åˆå§‹æ ‡è®°"><a href="#åˆå§‹æ ‡è®°" class="headerlink" title="åˆå§‹æ ‡è®°"></a>åˆå§‹æ ‡è®°</h5><p> åªæ ‡è®°ä¸€ä¸‹GCRootsèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹TAMSæŒ‡é’ˆçš„å€¼ï¼Œè®©ä¸‹ä¸€ä¸ªé˜¶æ®µçš„ç”¨æˆ·çº¿ç¨‹å¹¶å‘è¿è¡Œæ—¶ï¼Œèƒ½æ­£ç¡®æ»´åœ¨å¯ç”¨çš„Regionä¸­åˆ†é…æ–°å¯¹è±¡ã€‚è¿™ä¸ªé˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯è€—æ—¶çŸ­ï¼Œè€Œä¸”æ˜¯å€Ÿç”¨è¿›è¡ŒMinorGCçš„æ—¶å€™åŒæ­¥å®Œæˆï¼Œæ‰€ä»¥G1æ”¶é›†å™¨åœ¨è¿™ä¸ªé˜¶æ®µå®é™…å¹¶æ²¡æœ‰é¢å¤–çš„åœé¡¿ã€‚</p><h5 id="å¹¶å‘æ ‡è®°"><a href="#å¹¶å‘æ ‡è®°" class="headerlink" title="å¹¶å‘æ ‡è®°"></a>å¹¶å‘æ ‡è®°</h5><p>ä»GCRootså¼€å§‹å¯¹å¯¹å­çº¢å¯¹è±¡è¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œé€’å½’æ‰«ææ•´ä¸ªå †é‡Œçš„å¯¹è±¡å›¾ï¼Œæ‰¾å‡ºè¦å›æ”¶çš„å¯¹è±¡ï¼Œè¿™ä¸ªé˜¶æ®µè€—æ—¶è¾ƒé•¿ï¼Œä½†æ˜¯å¯ä»¥å’Œç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œå½“å¯¹è±¡å›¾æ‰«æå®Œæˆä»¥åï¼Œè¿˜è¦é‡æ–°å¤„ç†SATBè®°å½•ä¸‹çš„åœ¨å¹¶å‘æ—¶æœ‰å¼•ç”¨å˜åŠ¨çš„å¯¹è±¡ã€‚</p><h5 id="æœ€ç»ˆæ ‡è®°"><a href="#æœ€ç»ˆæ ‡è®°" class="headerlink" title="æœ€ç»ˆæ ‡è®°"></a>æœ€ç»ˆæ ‡è®°</h5><p>å¯¹ç”¨æˆ·çº¿ç¨‹åšå¦å¤–ä¸€ä¸ªçŸ­æš‚çš„æš‚åœï¼Œç”¨äºå¤„ç†å¹¶å‘é˜¶æ®µç»“æŸåä»é—ç•™ä¸‹æ¥çš„æœ€åé‚£å°‘é‡çš„SATBè®°å½•ã€‚</p><h5 id="ç­›é€‰å›æ”¶"><a href="#ç­›é€‰å›æ”¶" class="headerlink" title="ç­›é€‰å›æ”¶"></a>ç­›é€‰å›æ”¶</h5><p>è´Ÿè´£æ›´æ–°Regionçš„ç»Ÿè®¡æ•°æ®ï¼Œå¯¹å“¥å“¥Regionçš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©ä»»æ„å¤šä¸ªRegionæ„æˆå›æ”¶é›†ï¼Œç„¶åæŠŠå†³å®šå›æ”¶çš„é‚£ä¸€éƒ¨åˆ†Regionçš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ç©ºçš„Regionä¸­ï¼Œå†æ¸…ç†æ‰æ•´ä¸ªæ—§çš„Regionçš„å…¨éƒ¨ç©ºé—´ï¼Œå¯¹å­˜æ´»å¯¹è±¡ç§»åŠ¨æ—¶å¿…é¡»æš‚åœç”¨æˆ·çº¿ç¨‹ï¼Œä½†æ˜¯ç”±å¤šæ¡çº¿ç¨‹å®Œæˆçš„ã€‚</p><p><img src="/2020/06/10/%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6/g1.jpeg" alt="G1"></p><p>G1ä»æ•´ä½“ä¸Šæ¥çœ‹æ˜¯åŸºäºæ ‡è®°æ•´ç†ç®—æ³•ï¼Œä½†ä»å±€éƒ¨æ¥çœ‹æ—¶åŸºäºæ ‡è®°å¤åˆ¶ç®—æ³•ã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸¤ç§ç®—æ³•æ„å‘³ç€G1å†ä¸æ€§æœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ï¼Œåƒåœ¾æ”¶é›†å®Œæˆä¹‹åèƒ½æä¾›è§„æ•´çš„å¯ç”¨å†…å­˜ã€‚è¿™ç§ç‰¹æ€§æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œï¼Œåœ¨ç¨‹åºä¸ºå¤§å¯¹è±¡åˆ†é…å†…å­˜æ—¶ä¸å®¹æ˜“å› æ— æ³•æ‰¾åˆ°è¿ç»­å†…å­˜ç©ºé—´è€Œæå‰è§¦å‘é™ä¸€æ¬¡æ”¶é›†ã€‚</p><p>G1ä½äº†åƒåœ¾æ”¶é›†äº§ç”Ÿçš„å†…å­˜å ç”¨ä»¥åŠé¢å¤–çš„æ‰§è¡Œå‰¯åœ¨éƒ½æ¯”CMSæã€‚<br>å†…å­˜å ç”¨æ˜¯ç”±äºåŒå‘å¡è¡¨å ç”¨ç©ºé—´å¤§ã€‚CMsåªè®°å½•äº†è€å¹´ä»£åˆ°æ–°ç”Ÿä»£çš„å¡è¡¨è®°å½•ã€‚</p><p>è´Ÿè½½ï¼šCMSç”¨å†™åå±éšœç»´æŠ¤æ›´æ–°å¡è¡¨ï¼›<br>G1é™¤äº†ä½¿ç”¨å†™åå±éšœç»´æŠ¤å¡è¡¨å¤–ï¼Œä½äº†å®ç°åŸå§‹å¿«ç…§æœç´¢ï¼ˆSATBï¼‰ç®—æ³•ï¼Œè¿˜éœ€è¦ä½¿ç”¨å†™å‰å±éšœæ¥è·Ÿè¸ªå¹¶å‘å‰çš„æŒ‡é’ˆå˜åŒ–ã€‚ åŸå§‹å¿«ç…§æœç´¢èƒ½å¤Ÿå‡å°‘å¹¶å‘æ ‡è®°å’Œé‡æ–°æ ‡è®°é˜¶æ®µçš„æ¶ˆè€—ï¼Œé¿å…CMSé‚£æ ·åœ¨æœ€ç»ˆæ ‡è®°é˜¶æ®µåœé¡¿æ—¶é—´è¿‡é•¿çš„ç¼ºç‚¹ã€‚</p><p>CMSçš„å†™å±éšœæ˜¯åŒæ­¥æ“ä½œï¼ŒG1ä½¿ç”¨çš„æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒæŠŠå†™å‰å±éšœå’Œå†™åå±éšœä¸­è¦åšçš„äº‹æƒ…éƒ½æ”¾åœ¨é˜Ÿåˆ—é‡Œï¼Œå†å¼‚æ­¥å¤„ç†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> å†…å­˜åˆ†é… </tag>
            
            <tag> GC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿ç¨‹å’Œå¹¶å‘</title>
      <link href="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/"/>
      <url>/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p>ç›®å‰çº¿ç¨‹æ˜¯javaä¸­è¿›è¡Œå¤„ç†å™¨èµ„æºè°ƒåº¦çš„æœ€åŸºæœ¬å•ä½ã€‚ï¼ˆLoomé¡¹ç›®æ­£åœ¨å°è¯•æ”¹å˜çº¿ç¨‹è¿™ä¸€é‡é‡çº§çš„å®ç°ï¼‰</p><p>å®ç°çº¿ç¨‹çš„æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§ï¼š</p><ol><li>ä½¿ç”¨å†…æ ¸çº¿ç¨‹1:1å®ç°ï¼›<br>å†…æ ¸ç³»ç»Ÿå°±æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ”¯æŒçš„çº¿ç¨‹ï¼Œè¿™ç§çº¿ç¨‹ç”±å†…æ ¸æ¥å®Œæˆçº¿ç¨‹åˆ‡æ¢ï¼Œå†…æ ¸é€šè¿‡æ“çºµè°ƒåº¦å™¨å¯¹çº¿ç¨‹è¿›è¡Œè°ƒåº¦ï¼Œå¹¶è´Ÿè´£å°†çº¿ç¨‹çš„ä»»åŠ¡æ˜ å°„åˆ°å„ä¸ªå¤„ç†å™¨ä¸Šã€‚</li></ol><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/1.1.jpeg" alt="å†…æ ¸çº¿ç¨‹"></p><ol start="2"><li>ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹1:nå®ç°ï¼›</li></ol><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/1.n.jpeg" alt="ç”¨æˆ·çº¿ç¨‹"></p><ol start="3"><li>ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹ä»·è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°ï¼ˆnï¼šMå®ç°ï¼‰</li></ol><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/m.n.jpeg" alt="æ··åˆå®ç°"></p><h2 id="Javaçº¿ç¨‹çš„å®ç°"><a href="#Javaçº¿ç¨‹çš„å®ç°" class="headerlink" title="Javaçº¿ç¨‹çš„å®ç°"></a>Javaçº¿ç¨‹çš„å®ç°</h2><p>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­æ²¡æœ‰é™å®šä½¿ç”¨å“ªç§çº¿ç¨‹æ¨¡å‹æ¥å®ç°ï¼Œä¸»æµå¹³å°ä¸Šçš„ä¸»æµå•†ç”¨Javaè™šæ‹Ÿæœºçº¿ç¨‹æ¨¡å‹æ™®ééƒ½ç»™äºˆæ“ä½œç³»ç»ŸåŸç”Ÿçº¿ç¨‹æ¨¡å‹æ¥å®ç°ï¼ˆ1:1çš„çº¿ç¨‹æ¨¡å‹ï¼‰</p><h2 id="Javaçº¿ç¨‹è°ƒåº¦"><a href="#Javaçº¿ç¨‹è°ƒåº¦" class="headerlink" title="Javaçº¿ç¨‹è°ƒåº¦"></a>Javaçº¿ç¨‹è°ƒåº¦</h2><p>çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡ç³»ç»Ÿä¸ºçº¿ç¨‹åˆ†é…å¤„ç†å™¨ä½¿ç”¨æƒçš„è¿‡ç¨‹ï¼Œè°ƒåº¦æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼š</p><ul><li>ååŒå¼çº¿ç¨‹è°ƒåº¦<br>çº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ç”±çº¿ç¨‹æœ¬èº«æ¥æ§åˆ¶ï¼Œçº¿ç¨‹æŠŠè‡ªå·±çš„å·¥ä½œæ‰§è¡Œå®Œä¹‹åï¼ŒåŒå¿—ç³»ç»Ÿåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ã€‚</li><li>æŠ¢å å¼çº¿ç¨‹è°ƒåº¦<br>æ¯ä¸ªçº¿ç¨‹ç”±ç³»ç»Ÿæ¥åˆ†é…æ‰§è¡Œæ—¶é—´ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ç”±çº¿ç¨‹æœ¬èº«æ¥å†³å®šã€‚<br>Javaå¯ä»¥ä½¿ç”¨thread.yield()æ–¹æ³•ä¸»åŠ¨è®©å‡ºæ‰§è¡Œæ—¶é—´ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¸»åŠ¨è·å–æ‰§è¡Œæ—¶é—´ã€‚</li></ul><h2 id="çº¿ç¨‹çš„ä¼˜å…ˆçº§"><a href="#çº¿ç¨‹çš„ä¼˜å…ˆçº§" class="headerlink" title="çº¿ç¨‹çš„ä¼˜å…ˆçº§"></a>çº¿ç¨‹çš„ä¼˜å…ˆçº§</h2><p>æˆ‘ä»¬å¹¶ä¸èƒ½åœ¨ç¨‹åºä¸­é€šè¿‡ä¼˜å…ˆçº§æ¥å®Œå…¨å‡†ç¡®åˆ¤æ–­ä¸€ç»„çŠ¶æ€éƒ½ä¸ºReadyçš„çº¿ç¨‹å…ˆæ‰§è¡Œå“ªä¸€ä¸ªï¼Ÿ</p><h2 id="çŠ¶æ€è½¬æ¢"><a href="#çŠ¶æ€è½¬æ¢" class="headerlink" title="çŠ¶æ€è½¬æ¢"></a>çŠ¶æ€è½¬æ¢</h2><p>Javaè¯­è¨€å®šä¹‰äº†6ä¸­çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹ä¸­ï¼Œ ä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸”åªæœ‰ä¸€ç§çŠ¶æ€ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç‰¹å®šçš„æ–¹æ³•åœ¨ä¸åŒçŠ¶æ€ä¹‹é—´è½¬æ¢ã€‚</p><ul><li>æ–°å»ºï¼šnewï¼Œåˆ›å»ºåå°šæœªå¯åŠ¨çš„çº¿ç¨‹å¤„äºæ–°å»ºçŠ¶æ€ï¼›</li><li>è¿è¡Œï¼šrunnableï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿçº¿ç¨‹çŠ¶æ€ä¸­çš„Runningå’ŒReadyï¼Œ</li><li>ç­‰å¾…ï¼šWaitingï¼Œå¤„äºè¿™ç§çŠ¶æ€çš„çº¿ç¨‹ä¸ä¼šè¢«åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´ï¼Œå®ƒä»¬éœ€è¦è¢«å…¶ä»–çº¿ç¨‹æ˜¾ç¤ºå”¤é†’ã€‚<br>ä»¥ä¸‹æ–¹æ³•å¯ä»¥è®©çº¿ç¨‹æ— é™æœŸç­‰å¾…ï¼š<ul><li>æ²¡æœ‰è®¾ç½®timeoutå‚æ•°çš„Object.wait()æ–¹æ³•ï¼›</li><li>æ²¡æœ‰è®¾ç½®timeoutå‚æ•°çš„Thread.join()æ–¹æ³•ï¼›</li><li>LockSupport.part()æ–¹æ³•ï¼›</li></ul></li><li>é™æœŸç­‰å¾…ï¼šå¤„äºè¿™ç§çŠ¶æ€çš„çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´ï¼Œåœ¨ä¸€å®šæ—¶é—´åä¼šæœ‰ç³»ç»Ÿè‡ªåŠ¨å”¤é†’ã€‚<ul><li>Thread.sleep()</li><li>è®¾ç½®äº†Timeoutçš„Object.wait()</li><li>è®¾ç½®äº†Timeoutçš„Thread.join()</li><li>LockSupport.parkNanos();</li><li>LockSupport.parkUntil();</li></ul></li><li>é˜»å¡ï¼šBlockedï¼Œåœ¨ç¨‹åºç­‰å¾…è¿›å…¥åŒæ­¥åŒºåŸŸçš„æ—¶å€™ï¼Œçº¿ç¨‹å°†è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</li><li>ç»“æŸ: Terminatedï¼Œå·²ç»ˆæ­¢çº¿ç¨‹çš„çº¿ç¨‹çŠ¶æ€ï¼Œçº¿ç¨‹å·²ç»ç»“æŸæ‰§è¡Œã€‚</li></ul><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/ThreadState.jpeg" alt="çº¿ç¨‹çŠ¶æ€å›¾"></p><h2 id="çº¿ç¨‹å®‰å…¨"><a href="#çº¿ç¨‹å®‰å…¨" class="headerlink" title="çº¿ç¨‹å®‰å…¨"></a>çº¿ç¨‹å®‰å…¨</h2><p>å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœä¸ç”¨è€ƒè™‘è¿™äº›çº¿ç¨‹åœ¨è¿è¡Œæ—¶ç¯å¢ƒä¸‹çš„è°ƒåº¦å’Œäº¤æ›¿æ‰§è¡Œï¼Œä¹Ÿä¸éœ€è¦æ‰§è¡Œé¢å¤–çš„åŒæ­¥ï¼Œæˆ–è€…åœ¨è°ƒç”¨æ–¹è¿›è¡Œä»»ä½•å…¶ä»–çš„åè°ƒæ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºéƒ½å¯ä»¥è·å¾—æ­£ç¡®çš„ç»“æœï¼Œé‚£å°±ç§°è¿™ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>ä¹Ÿå°±æ˜¯ä»£ç æœ¬èº«å°è£…äº†æ‰€æœ‰å¿…è¦çš„æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µï¼Œä»¤è°ƒç”¨è€…æ— åºå…³å¿ƒå¤šçº¿ç¨‹ä¸‹çš„è°ƒç”¨é—®é¢˜ï¼Œæ›´æ— éœ€è‡ªå·±å®ç°ä»»ä½•æªæ–½æ¥ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ­£ç¡®è°ƒç”¨ã€‚</p><h4 id="ä¸å¯å˜"><a href="#ä¸å¯å˜" class="headerlink" title="ä¸å¯å˜"></a>ä¸å¯å˜</h4><p>åœ¨Javaè¯­è¨€ä¸­ï¼Œä¸å¯å˜å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ— è®ºæ˜¯å¯¹è±¡çš„æ–¹æ³•å®ç°è¿˜æ˜¯æ–¹æ³•çš„è°ƒç”¨è€…ï¼Œéƒ½ä¸éœ€è¦å†è¿›è¡Œä»»ä½•çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½ã€‚</p><p>åªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®çš„æ„å»ºå‡ºæ¥ï¼Œé‚£å…¶å¤–éƒ¨çš„å¯è§çŠ¶æ€æ°¸è¿œéƒ½ä¸ä¼šæ”¹å˜ï¼Œæ°¸è¿œéƒ½ä¸ä¼šçœ‹åˆ°ä»–åœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚</p><h4 id="ç»å¯¹çº¿ç¨‹å®‰å…¨"><a href="#ç»å¯¹çº¿ç¨‹å®‰å…¨" class="headerlink" title="ç»å¯¹çº¿ç¨‹å®‰å…¨"></a>ç»å¯¹çº¿ç¨‹å®‰å…¨</h4><p>ç»å¯¹çš„çº¿ç¨‹å®‰å…¨é™¤äº†å¯¹è±¡æœ¬èº«å¤–ï¼Œ è¿˜éœ€è¦åœ¨è°ƒç”¨ç«¯åšç›¸åº”çš„åŒæ­¥æªæ–½ã€‚</p><h4 id="ç›¸å¯¹çº¿ç¨‹å®‰å…¨"><a href="#ç›¸å¯¹çº¿ç¨‹å®‰å…¨" class="headerlink" title="ç›¸å¯¹çº¿ç¨‹å®‰å…¨"></a>ç›¸å¯¹çº¿ç¨‹å®‰å…¨</h4><p>ä¿è¯è¿™ä¸ªå¯¹è±¡åœ¨å•æ¬¡çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦è¿›è¡Œé¢å¤–çš„ä¿éšœæªæ–½ï¼Œä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šé¡ºåºçš„è¿ç»­è°ƒç”¨ï¼Œå°±å¯èƒ½éœ€è¦åœ¨è°ƒç”¨ç«¯ä½¿ç”¨é¢å¤–çš„åŒæ­¥æ‰‹æ®µæ¥ä¿è¯è°ƒç”¨çš„æ­£ç¡®æ€§ã€‚åœ¨Javaä¸­ï¼Œç›¸å¯¹çº¿ç¨‹å®‰å…¨çš„ç±»å‹æœ‰Vectorã€HashTableã€Collections.synchronizedCollection();</p><h4 id="çº¿ç¨‹å…¼å®¹"><a href="#çº¿ç¨‹å…¼å®¹" class="headerlink" title="çº¿ç¨‹å…¼å®¹"></a>çº¿ç¨‹å…¼å®¹</h4><p>å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œ ä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®çš„ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨ä½¿ç”¨ã€‚<br>Vectorã€HashTableã€ArrayListã€HashMapç­‰éƒ½æ˜¯çº¿ç¨‹å…¼å®¹çš„ã€‚</p><h4 id="çº¿ç¨‹å¯¹ç«‹"><a href="#çº¿ç¨‹å¯¹ç«‹" class="headerlink" title="çº¿ç¨‹å¯¹ç«‹"></a>çº¿ç¨‹å¯¹ç«‹</h4><p>å¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æŒæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ï¼Œä¸€ä¸ªå°è¯•å»ä¸­æ–­çº¿ç¨‹ã€ä¸€ä¸ªå°è¯•å»æ¢å¤çº¿ç¨‹ï¼Œåœ¨å¹¶å‘è¿›è¡Œçš„æƒ…å†µä¸‹ï¼Œæ— è®ºè°ƒç”¨æ—¶æ˜¯å¦è¿›è¡Œäº†åŒæ­¥ï¼Œç›®æ ‡çº¿ç¨‹éƒ½å­˜åœ¨æ€ç´¢çš„é£é™©ã€‚ï¼ˆThreadç±»çš„suspendå’Œresumeæ–¹æ³•ï¼‰ï¼Œå¸¸è§çš„å¯¹ç«‹æ“ä½œè¿˜æœ‰System.in() System.out()å’ŒSystem.runFinalizersOnExit();</p><h3 id="çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"><a href="#çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•" class="headerlink" title="çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"></a>çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•</h3><h4 id="äº’æ–¥åŒæ­¥"><a href="#äº’æ–¥åŒæ­¥" class="headerlink" title="äº’æ–¥åŒæ­¥"></a>äº’æ–¥åŒæ­¥</h4><p>ç”¨äº’æ–¥æ¥å®ç°åŒæ­¥ã€‚<br>åŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€æ¡çº¿ç¨‹ä½¿ç”¨ã€‚<br>äº’æ–¥æ˜¯å®ç°åŒæ­¥çš„ä¸€ç§æ‰‹æ®µï¼Œä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ã€äº’æ–¥é‡ï¼ˆMutexï¼‰å’Œä¿¡å·é‡ï¼ˆSemaphoreï¼‰éƒ½æ˜¯å¸¸è§çš„äº’æ–¥å®ç°æ–¹å¼ã€‚<br>å› æ­¤å®ƒé¢ä¸´çš„é—®é¢˜æ˜¯è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½å¼€é”€ï¼Œå› æ­¤ä¹Ÿå«é˜»å¡åŒæ­¥ã€‚<br>å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ã€‚</p><h5 id="synchronizedï¼ˆéå…¬å¹³é”ï¼‰"><a href="#synchronizedï¼ˆéå…¬å¹³é”ï¼‰" class="headerlink" title="synchronizedï¼ˆéå…¬å¹³é”ï¼‰"></a>synchronizedï¼ˆéå…¬å¹³é”ï¼‰</h5><h5 id="java-util-concurrent-locks-Lock"><a href="#java-util-concurrent-locks-Lock" class="headerlink" title="java.util.concurrent.locks.Lock"></a>java.util.concurrent.locks.Lock</h5><h5 id="ReentrantLockï¼ˆéå…¬å¹³é”ï¼‰"><a href="#ReentrantLockï¼ˆéå…¬å¹³é”ï¼‰" class="headerlink" title="ReentrantLockï¼ˆéå…¬å¹³é”ï¼‰"></a>ReentrantLockï¼ˆéå…¬å¹³é”ï¼‰</h5><p>  å¯é‡å…¥é”æ¯”synchronizedå¢åŠ äº†ä¸€äº›é«˜çº§åŠŸèƒ½ï¼š</p><ul><li>ç­‰å¾…å¯ä¸­æ–­<br>å½“æŒæœ‰é”çš„çº¿ç¨‹é•¿æœŸä¸é‡Šæ”¾æ‰€å¾—æ—¶å€™ï¼Œæ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹å¯ä»¥é€‰æ‹©æ”¾å¼ƒç­‰å¾…ï¼Œæ”¹ä¸ºå¤„ç†å…¶ä»–äº‹æƒ…ã€‚</li><li>å…¬å¹³é”<br>å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒä¸€ä¸ªé”çš„æ—¶å€™ï¼Œå¿…é¡»æŒ‰ç…§ç”³è¯·é”çš„æ—¶é—´é¡ºåºä¾æ¬¡è·å¾—é”ã€‚</li><li>é”ç»‘å®šå¤šä¸ªæ¡ä»¶<br>ä¸€ä¸ªReentrantLockå¯¹è±¡å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ªConditionå¯¹è±¡ï¼Œ å¤šæ¬¡è°ƒç”¨newCondition()å³å¯ã€‚</li></ul><h4 id="éé˜»å¡åŒæ­¥"><a href="#éé˜»å¡åŒæ­¥" class="headerlink" title="éé˜»å¡åŒæ­¥"></a>éé˜»å¡åŒæ­¥</h4><p>åŸºäºç¡¬ä»¶å†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆè¿›æ€§æ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®ï¼Œæ“ä½œæˆåŠŸï¼›<br>å¦‚æœå…±äº«æ•°æ®è¢«äº‰ç”¨ï¼Œäº§ç”Ÿå†²çªï¼Œé‚£ä¹ˆå†è¿›è¡Œå…¶ä»–çš„è¡¥å¿æªæ–½ï¼Œæœ€å¸¸ç”¨çš„è¡¥å¿æªæ–½å°±æ˜¯ä¸æ–­é‡è¯•ï¼Œç›´åˆ°æˆåŠŸã€‚<br>è¿™ç§æ–¹å¼ä¸éœ€è¦é˜»å¡çº¿ç¨‹ï¼Œå› æ­¤ä¹Ÿå«æ— é”ç¼–ç¨‹ã€‚<br>å¸¸ç”¨çš„å…·æœ‰åŸå­æ€§çš„ç¡¬ä»¶æ“ä½œå’Œå†²çªæ£€æµ‹æŒ‡ä»¤æœ‰ï¼š</p><ul><li>æµ‹è¯•å¹¶è®¾ç½®ï¼ˆTest-And-Setï¼‰</li><li>è·å–å¹¶å¢åŠ ï¼ˆFetch-And-Incrementï¼‰</li><li>äº¤æ¢ï¼ˆSwapï¼‰</li><li>æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆCompare And Swapï¼‰</li><li>åŠ è½½é“¾æ¥/æ¡ä»¶å­˜å‚¨ï¼ˆLoad-Linked/ Store-Conditionalï¼‰</li></ul><p>Javaä¸­æš´éœ²å‡ºæ¥çš„æ˜¯CASæŒ‡ä»¤ï¼Œå½“CASæŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œå½“ä¸”ä»…å½“å†…å­˜åœ°å€Vçš„å€¼ç¬¦åˆé¢„æœŸå€¼Aæ—¶ï¼Œå¤„ç†å™¨æ‰ä¼šç”¨æ–°çš„å€¼Bæ›´æ–°å†…å­˜åœ°å€Vçš„å€¼ï¼Œè¯¥è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œæ‰§è¡ŒæœŸé—´ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­ã€‚</p><p>CASå­˜åœ¨çš„ABAé—®é¢˜ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸ä¼šå½±å“ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§ï¼Œå¦‚æœéœ€è¦è§£å†³è¯¥é—®é¢˜ï¼Œä¼ ç»Ÿçš„äº’æ–¥åŒæ­¥å¯èƒ½ä¼šæ¯”åŸå­ç±»æ›´ä¸ºé«˜æ•ˆã€‚</p><h4 id="æ— åŒæ­¥æ–¹æ¡ˆ"><a href="#æ— åŒæ­¥æ–¹æ¡ˆ" class="headerlink" title="æ— åŒæ­¥æ–¹æ¡ˆ"></a>æ— åŒæ­¥æ–¹æ¡ˆ</h4><p>å¦‚æœå¯ä»¥è®©ä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®ï¼Œé‚£å®ƒè‡ªç„¶å°±ä¸éœ€è¦ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯å…¶æ­£ç¡®æ€§ï¼Œå› æ­¤ä¼šæœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><ul><li>å¯é‡å…¥ä»£ç <br>å¦‚æœä¸€ä¸ªæ–¹æ³•çš„è¿”å›ç»“æœæ˜¯å¯é¢„æµ‹çš„ï¼Œåªè¦è¾“å…¥äº†ç›¸åŒçš„æ•°æ®ï¼Œå°±å°±èƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œé‚£ä¹ˆå®ƒå°±æ»¡è¶³å¯é‡å…¥æ€§çš„è¦æ±‚ï¼Œå½“ç„¶ä»–å°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚<br>å¯é‡å…¥ä»£ç ä¸ä¾èµ–äºå…¨å±€å˜é‡ã€å­˜å‚¨åœ¨é˜Ÿä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æºï¼Œç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°é‡ä¼ å…¥ï¼Œæ¯”è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰ã€‚</li><li>çº¿ç¨‹æœ¬åœ°å­˜å‚¨<br>å¦‚æœä¸€æ®µä»£ç ä¸­ä½¿ç”¨çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«ï¼Œé‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚è¿™æ ·å°±å¯ä»¥æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨ä¸€ä¸ªçº¿ç¨‹ä¹‹å†…ã€‚<br>å¸¸è§çš„æœ‰ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼ˆWebäº¤äº’æ¨¡å‹ï¼‰ã€‚<br>ThreadLocalçš„ä½¿ç”¨ã€‚</li></ul><h2 id="é”ä¼˜åŒ–"><a href="#é”ä¼˜åŒ–" class="headerlink" title="é”ä¼˜åŒ–"></a>é”ä¼˜åŒ–</h2><h4 id="è‡ªæ—‹é”å’Œè‡ªé€‚åº”è‡ªæ—‹"><a href="#è‡ªæ—‹é”å’Œè‡ªé€‚åº”è‡ªæ—‹" class="headerlink" title="è‡ªæ—‹é”å’Œè‡ªé€‚åº”è‡ªæ—‹"></a>è‡ªæ—‹é”å’Œè‡ªé€‚åº”è‡ªæ—‹</h4><p>äº’æ–¥åŒæ­¥çš„æ—¶å€™éœ€è¦å¯¹çº¿ç¨‹è¿›è¡ŒæŒ‚èµ·å’Œæ¢å¤ï¼Œä½†æ˜¯æŒ‚èµ·å’Œæ¢å¤éœ€è¦é™·å…¥å†…æ ¸æ€æ¥å®Œæˆã€‚<br>å› æ­¤å½“ä¸€ä¸ªçº¿ç¨‹è·å–é”çš„æ—¶å€™ï¼Œå¦‚æœæš‚æ—¶æ²¡æœ‰è·å–åˆ°ï¼Œé‚£ä¹ˆè®©ä»–ç¨å¾®ç­‰ä¸€ä¼šå„¿ï¼Œä½†ä¸æ”¾å¼ƒå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´ï¼Œçœ‹çœ‹æŒæœ‰é”çš„çº¿ç¨‹æ˜¯å¦å¾ˆå¿«ä¼šé‡Šæ”¾é”ã€‚</p><p>å¦‚æœé”è¢«å ç”¨å¾ˆé•¿çš„æ—¶é—´ï¼Œé‚£ä¹ˆè‡ªæ—‹çš„çº¿ç¨‹åªä¼šç™½ç™½æ¶ˆè€—å¤„ç†å™¨èµ„æºã€‚å› æ­¤è‡ªæ—‹ç­‰å¾…æ—¶é—´å¿…é¡»æœ‰ä¸€å®šçš„é™åº¦ã€‚<br>å¦‚æœè‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ï¼Œä»ç„¶æ²¡æœ‰æˆåŠŸè·å¾—é”ï¼Œå°±åº”å½“ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼å»æŒ‚èµ·çº¿ç¨‹ã€‚</p><h5 id="è‡ªæ—‹é”çš„å®ç°"><a href="#è‡ªæ—‹é”çš„å®ç°" class="headerlink" title="è‡ªæ—‹é”çš„å®ç°"></a>è‡ªæ—‹é”çš„å®ç°</h5><p><a href="https://www.jianshu.com/p/824b2e4f1eed" target="_blank" rel="noopener">å‡ ç§è‡ªæ—‹é”çš„javaå®ç°</a><br><a href="https://www.jianshu.com/p/9d3660ad4358?utm_source=oschina-app" target="_blank" rel="noopener">è®¤çœŸçš„è®²ä¸€è®²ï¼šè‡ªæ—‹é”åˆ°åº•æ˜¯ä»€ä¹ˆ</a><br><a href="https://www.cnblogs.com/cxuanBlog/p/11679883.html" target="_blank" rel="noopener">çœ‹å®Œä½ å°±æ˜ç™½çš„é”ç³»åˆ—ä¹‹è‡ªæ—‹é”</a></p><h4 id="é”æ¶ˆé™¤"><a href="#é”æ¶ˆé™¤" class="headerlink" title="é”æ¶ˆé™¤"></a>é”æ¶ˆé™¤</h4><p>è™šæ‹Ÿæœºå³ä½¿ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶ï¼Œåˆ¤æ–­åˆ°ä¸€æ®µä»£ç ä¸­ï¼Œåœ¨å †ä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½ä¸ä¼šé€ƒé€¸å‡ºå»è¢«å…¶ä»–çº¿ç¨‹è®¿é—®åˆ°ï¼Œé‚£å°±å¯ä»¥æŠŠä»–ä»¬å½“ä½œæ ˆä¸Šçš„æ•°æ®å¯¹å¾…ï¼Œè®¤ä¸ºä»–ä»¬æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ¶ˆé™¤åŒæ­¥é”çš„è¿‡ç¨‹ã€‚</p><h4 id="é”ç²—åŒ–"><a href="#é”ç²—åŒ–" class="headerlink" title="é”ç²—åŒ–"></a>é”ç²—åŒ–</h4><p>å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„ï¼Œ å¯ä»¥æŠŠåŠ é”åŒæ­¥çš„èŒƒå›´æ‰©å±•åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚ </p><h4 id="è½»é‡çº§é”"><a href="#è½»é‡çº§é”" class="headerlink" title="è½»é‡çº§é”"></a>è½»é‡çº§é”</h4><p>åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œå‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”ä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ã€‚</p><p>Hotspotå¯¹è±¡å¤´åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š<br>1ï¼‰ç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«è¿è¡Œçš„æ•°æ®ï¼Œå¦‚å“ˆå¸Œå—ï¼ŒGCåˆ†ä»£å¹´é¾„ã€‚è¿™éƒ¨åˆ†æ•°æ®çš„é•¿åº¦åœ¨32ä½å’Œ64ä½çš„Javaè™šæ‹Ÿæœºä¸­åˆ†åˆ«å ç”¨32ä¸ªæˆ–è€…64æ¯”ç‰¹ã€‚è¿™éƒ¨åˆ†æ˜¯å®ç°è½»é‡çº§é”å’Œåå‘é”çš„å…³é”®ã€‚<br>2ï¼‰ç”¨äºå­˜å‚¨æŒ‡å‘æ–¹æ³•åŒºå¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼Œå¦‚æœæ˜¯æ•°ç»„å¯¹è±¡ï¼Œè¿˜ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„éƒ¨åˆ†å­˜å‚¨æ•°ç»„é•¿åº¦ã€‚</p><p>ç”±äºå¯¹è±¡å¤´ä¿¡æ¯æ˜¯ä¸å¯¹è±¡è‡ªèº«å®šä¹‰çš„æ•°æ®æ— å…³çš„é¢å¤–å­˜å‚¨æˆæœ¬ï¼Œè€ƒè™‘åˆ°Javaè™šæ‹Ÿæœºçš„ç©ºé—´ä½¿ç”¨æ•ˆç‡ï¼ŒMarkWordè¢«è®¾è®¡æˆä¸€ä¸ªéå›ºå®šçš„åŠ¨æ€æ•°æ®ç»“æ„ï¼Œä»¥ä¾¿åœ¨æå°çš„ç©ºé—´å†…å­˜å‚¨å°½é‡å¤šçš„ä¿¡æ¯ã€‚<br>å®ƒä¼šæ ¹æ®å¯¹è±¡çš„çŠ¶æ€æœç”¨è‡ªå·±çš„å­˜å‚¨ç©ºé—´ã€‚<br>åœ¨32ä½çš„Hotspotè™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡æœªè¢«é”å®šçš„çŠ¶æ€ä¸‹ï¼ŒMarkWordçš„32ä¸ªæ¯”ç‰¹ç©ºé—´æœ‰25ä¸ªæ¯”ç‰¹ç”¨äºå­˜å‚¨å¯¹è±¡çš„å“ˆå¸Œç ï¼Œ4ä¸ªæ¯”ç‰¹ç”¨äºå­˜å‚¨å¯¹è±¡åˆ†ä»£å¹´é¾„ï¼Œ2ä¸ªæ¯”ç‰¹ç”¨äºå­˜å‚¨é”æ ‡å¿—ä½ï¼Œè¿˜æœ‰1ä¸ªæ¯”ç‰¹è‚¡å®šä½0ï¼ˆè¡¨ç¤ºæœªè¿›å…¥åå‘æ¨¡å¼ï¼‰ã€‚å¯¹è±¡é™¤äº†è¿èƒŒé”å®šçš„æ­£å¸¸çŠ¶æ€å¤–ï¼Œè¿˜æœ‰è½»é‡çº§é”å®šã€é‡é‡çº§é”å®šã€GCæ ‡è®°ã€å¯åå‘ç­‰å‡ ç§çŠ¶æ€ã€‚</p><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/light_.jpeg" alt></p><p>å¦‚æœä»£ç å³å°†è¿›å…¥åŒæ­¥å—çš„æ—¶å€™ï¼Œå¦‚æœæ­¤åŒæ­¥å¯¹è±¡æ²¡æœ‰è¢«é”å®šï¼ˆæ ‡å¿—ä½ä½01ï¼‰ï¼Œè™šæ‹Ÿæœºé¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªåä¸ºé”è®°å½•ï¼ˆLockRecordï¼‰çš„ç©ºé—´,ç”¨äºå­˜å‚¨é”å¯¹è±¡ç›®å‰çš„MarkWordçš„æ‹·è´ã€‚</p><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/markword.jpeg" alt></p><p>ç„¶åè™šæ‹Ÿæœºå°†ä½¿ç”¨CASæ“ä½œå°è¯•æŠŠå¯¹è±¡çš„markwordæ›´æ–°ä¸ºæŒ‡å‘LockRecordçš„æŒ‡é’ˆã€‚å¦‚æœè¿™ä¸ªæ›´æ–°æˆåŠŸï¼Œé‚£ä¹ˆä»£è¡¨è¯¥çº¿ç¨‹æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œå¹¶ä¸”å¯¹åƒMarkWordçš„é”æ ‡å¿—ä½å°†è½¬å˜ä¸º00ï¼Œè¡¨ç¤ºæ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€ã€‚</p><p>å¦‚æœæ›´æ–°æ“ä½œå¤±è´¥ï¼Œæ„å‘³ç€è‡³å°‘å­˜åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸å½“å‰çº¿ç¨‹ç«äº‰è·å–è¯¥å¯¹è±¡çš„é”ã€‚è™šæ‹Ÿæœºé¦–å…ˆæ£€æŸ¥å¯¹è±¡çš„MarkWordæ˜¯å¦åªæƒ³å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœæ˜¯ï¼Œè¯´æ˜çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œé‚£ä¹ˆç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¯´æ˜è¿™ä¸ªå¯¹è±¡å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŠ¢å äº†ã€‚<br>å¦‚æœå‡ºç°ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹äº‰ç”¨åŒä¸€ä¸ªé”çš„æƒ…å†µï¼Œé‚£ä¹ˆè½»é‡çº§é”ä¸å†æœ‰æ•ˆï¼Œå¿…é¡»è¦è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œé”æ ‡å¿—çš„çŠ¶æ€å˜ä¸º10ï¼Œ æ­¤æ—¶Markwordä¸­å­˜å‚¨çš„å°±æ˜¯æŒ‡å‘é‡é‡çº§é”çš„æŒ‡é’ˆï¼Œåé¢ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿå¿…é¡»è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</p><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/light_lock.jpeg" alt></p><p>å®ƒçš„è§£é”è¿‡ç¨‹ä¹Ÿæ˜¯é€šè¿‡CASæ¥è¿›è¡Œçš„ï¼Œå¦‚æœå¯¹è±¡çš„MarkWordä»ç„¶æŒ‡å‘çº¿ç¨‹çš„é”è®°å½•ï¼Œé‚£å°±ç”¨CASæ“ä½œæŠŠå¯¹è±¡å½“å‰çš„MarkWordå’Œçº¿ç¨‹ä¸­å¤åˆ¶çš„DisplacedMarkWordæ›¿æ¢å›æ¥ï¼Œå¦‚æœæ›¿æ¢æˆåŠŸï¼Œè¯´æ˜è§£é”æˆåŠŸã€‚<br>æ›¿æ¢å¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è¿‡è·å–è¯¥é”ï¼Œéœ€è¦åœ¨é‡Šæ”¾é”çš„åŒæ—¶å”¤é†’è¢«æŒ‚èµ·çš„çº¿ç¨‹ã€‚</p><p>å¦‚æœæ²¡æœ‰ç«äº‰ï¼Œè½»é‡çº§é”èƒ½é€šè¿‡CASæ“ä½œæˆåŠŸé¿å…ä½¿ç”¨äº’æ–¥é‡çš„å¼€é”€ï¼›<br>å¦‚æœå­˜åœ¨ç«äº‰ï¼Œé™¤äº†äº’æ–¥é‡æœ¬èº«å¼€é”€å¤–ï¼Œè¿˜é¢å¤–å‘ç”Ÿäº†CASæ“ä½œçš„å¼€é”€ï¼Œå› æ­¤æ€§èƒ½æ›´å·®ã€‚</p><h4 id="åå‘é”"><a href="#åå‘é”" class="headerlink" title="åå‘é”"></a>åå‘é”</h4><p>ç”¨äºæ¶ˆé™¤æ•°æ®åœ¨æ— ç«äº‰æƒ…å†µä¸‹çš„åŒæ­¥ï¼Œè¿CASéƒ½å»æ‰äº†ï¼Œè¿›ä¸€æ­¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ã€‚<br>åå‘é”ä¼šåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹ï¼Œå¦‚æœåœ¨æ¥ä¸‹æ¥çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¯¥é”ä¸€è‡´æ²¡æœ‰è¢«å…¶ä»–çš„çº¿ç¨‹è·å–ï¼Œåˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹æ°¸è¿œä¸éœ€è¦å†åŒæ­¥ã€‚</p><p>å¦‚æœå½“å‰è™šæ‹Ÿæœºå¯ç”¨äº†åå‘é”ï¼Œé‚£ä¹ˆå½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å–çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ç½®ä¸º01ï¼ŒæŠŠåå‘æ¨¡å¼è®¾ç½®ä¸º1ï¼Œè¡¨ç¤ºè¿›å…¥åå‘æ¨¡å¼ã€‚<br>åŒæ—¶ä½¿ç”¨CASæ“ä½œæŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹IDè®°å½•åœ¨å¯¹è±¡çš„MarkWordä¸­ã€‚<br>å¦‚æœCASæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ˜¯ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œã€‚</p><p>ä¸€æ—¦å‡ºç°å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–è¿™ä¸ªé”çš„æƒ…å†µï¼Œåå‘æ¨¡å¼é©¬ä¸Šå®£å‘Šç»“æŸã€‚<br>æ ¹æ®é”å¯¹è±¡ç›®å‰æ˜¯å¦å¤„äºè¢«é”å®šçš„çŠ¶æ€å†³å®šæ˜¯å¦æ’¤é”€åå‘ï¼ˆæŠŠåå‘æ¨¡å¼è®¾ç½®ä¸º0ï¼‰ï¼Œæ’¤é”€åæ ‡å¿—ä½æ¢å¤åˆ°ä¸ºé”å®šæˆ–è€…è½»é‡çº§é”å®šçš„è½§è¾Šå°ï¼Œåç»­çš„åŒæ­¥æ“ä½œæŒ‰ç…§è½»é‡çº§é”æ‰§è¡Œã€‚</p><p><img src="/2020/06/08/%E7%BA%BF%E7%A8%8B%E5%92%8C%E5%B9%B6%E5%8F%91/pian.jpeg" alt="åå‘é”"></p><p>å½“è¿›å…¥åå‘çŠ¶æ€æ˜¯ï¼ŒMarkWordå¤§éƒ¨åˆ†çš„ç©ºé—´éƒ½ç”¨äºå­˜å‚¨æŒæœ‰é”çš„çº¿ç¨‹IDï¼Œè¿™éƒ¨åˆ†ç©ºé—´å ç”¨äº†åŸæœ‰å­˜å‚¨å¯¹è±¡Hashç çš„ä½ç½®ã€‚å½“ä¸€ä¸ªå¯¹è±¡å·²ç»è®¡ç®—è¿‡ä¸€æ¬¡ä¸€è‡´æ€§å“ˆå¸Œç åï¼Œå®ƒå°±å†ä¹Ÿæ— æ³•è¿›å…¥åå‘é”çŠ¶æ€ã€‚<br>å½“ä¸€ä¸ªå¯¹è±¡æ­£åœ¨å¤„äºåå‘é”çŠ¶æ€æ—¶ï¼Œå—åˆ°è®¡ç®—hashç çš„è¯·æ±‚æ—¶ï¼Œå®ƒçš„åå‘çŠ¶æ€ä¼šè¢«ç«‹å³æ’¤é”€ï¼Œå¹¶ä¸”é”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</p><p>åœ¨é‡é‡çº§é”çš„å®ç°ä¸­ï¼Œå¯¹è±¡å¤´æŒ‡å‘äº†é‡é‡çº§é”çš„ä½ç½®ï¼Œä»£è¡¨é‡é‡çº§é”çš„ObjectMonitorç±»ä¸­æœ‰å­—æ®µå¯ä»¥è®°å½•éåŠ é”çŠ¶æ€ä¸‹çš„MarkWorkï¼Œå…¶ä¸­è‡ªç„¶å¯ä»¥å­˜å‚¨åŸæ¥çš„å“ˆå¸Œç ã€‚</p><p>åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ï¼Œä½†å¦‚æœç¨‹åºä¸­å¤§å¤šæ•°çš„é”éƒ½æ€»æ˜¯è¢«å¤šä¸ªä¸åŒçš„çº¿ç¨‹è®¿é—®ï¼Œé‚£åå‘é”å°±æ˜¯å¤šä½™çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>IO-2</title>
      <link href="/2020/06/07/IO-2/"/>
      <url>/2020/06/07/IO-2/</url>
      
        <content type="html"><![CDATA[<p>å¤šè·¯å¤ç”¨å™¨ï¼š<br>select/poll/epoll</p><p>man 2 select </p><p>man 2 poll</p><p>2.é“¾è·¯å±‚ï¼Œ3ç½‘ç»œå±‚ï¼Œ4ä¼ è¾“å±‚<br>å°å­˜ã‚è®°å¿†</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å¸ƒå¼é”</title>
      <link href="/2020/06/06/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
      <url>/2020/06/06/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</url>
      
        <content type="html"><![CDATA[<p>1) å¯é‡å…¥é”<br>CAS<br>2ï¼‰åŒæ­¥ï¼š<br>3ï¼‰ä¿¡å·é‡<br>å…¬å¹³é”ã€éå…¬å¹³é”ã€è¯»å†™é”ã€è‡ªæ—‹é”<br>åˆ†å¸ƒå¼é”ï¼Œ æ‚²è§‚é”ã€ä¹è§‚é”, é”ç»­ç§Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å­—èŠ‚ç æ‰§è¡Œå¼•æ“</title>
      <link href="/2020/06/05/%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E/"/>
      <url>/2020/06/05/%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E/</url>
      
        <content type="html"><![CDATA[<p>å½“ä»£ç è¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶å­—èŠ‚ç ï¼Œç”±ClassloaderåŠ è½½åˆ°å†…å­˜ï¼Œç»è¿‡åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£é‡Šåå°†æ•°æ®è½¬åŒ–ä¸ºJVMå¯ä»¥æ¥å—çš„æ ¼å¼å­˜å‚¨åˆ°æ–¹æ³•åŒºï¼Œå¹¶åœ¨å †å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªClasså¯¹è±¡ï¼Œä½œä¸ºå¤–éƒ¨è®¿é—®çš„å…¥å£ã€‚<br>æ¥ä¸‹æ¥å°±ç”±å­—èŠ‚ç æ‰§è¡Œå¼•æ“æ¥è§£é‡Šæ‰§è¡Œä»£ç ã€‚</p><p>ã€ŠJavaã€‹è™šæ‹Ÿæœºè§„èŒƒä¸­è§„å®šäº†Javaè™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“çš„æ¦‚å¿µæ¨¡å‹ï¼Œè¾“å…¥å­—èŠ‚ç äºŒè¿›åˆ¶æµï¼Œè¾“å‡ºæ‰§è¡Œç»“æœã€‚</p><p>åœ¨ä¸åŒçš„è™šæ‹Ÿæœºå®ç°ä¸­ï¼Œæ‰§è¡Œå¼•æ“åœ¨æ‰§è¡Œå­—èŠ‚ç çš„æ—¶å€™ä¼šæœ‰ä¸¤ç§ï¼š</p><ul><li>è§£é‡Šæ‰§è¡Œï¼ˆSun Classic è™šæ‹Ÿæœºï¼‰</li><li>ç¼–è¯‘æ‰§è¡Œï¼ˆJrockitï¼‰</li><li>ä¸¤ç§å…¼å¤‡ (HotSpot)</li></ul><h2 id="è¿è¡Œæ—¶æ ˆå¸§ç»“æ„"><a href="#è¿è¡Œæ—¶æ ˆå¸§ç»“æ„" class="headerlink" title="è¿è¡Œæ—¶æ ˆå¸§ç»“æ„"></a>è¿è¡Œæ—¶æ ˆå¸§ç»“æ„</h2><p>æ ˆå¸§æ˜¯ç”¨äºæ”¯æŒè™šæ‹Ÿæœºæ–¹æ³•è¿›è¡Œè°ƒç”¨å’Œæ‰§è¡Œçš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªæ–¹æ³•ä»è°ƒç”¨å¼€å§‹åˆ°æ‰§è¡Œç»“æŸçš„è¿‡ç¨‹ï¼Œéƒ½å¯¹åº”ä¸€ä¸ªæ ˆå¸§ä»è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</p><p>æ ˆå¸§å­˜å‚¨äº†æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€è¿æ¥ã€æ–¹æ³•è¿”å›åœ°å€å’Œä¸€äº›é¢å¤–çš„é™„åŠ ä¿¡æ¯ã€‚</p><p><img src="/2020/06/05/%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E/stackframe.jpeg" alt="æ ˆå¸§"></p><p>æ ˆå¸§ä¸­éœ€è¦å¤šå¤§çš„å±€éƒ¨å˜é‡è¡¨ã€å¤šæ·±çš„æ“ä½œæ•°æ ˆåœ¨ç¼–è¯‘Javaçš„æ—¶å€™å°±å·²ç»è®¡ç®—å‡ºæ¥å­˜æ”¾åœ¨æ–¹æ³•è¡¨çš„Codeå±æ€§ä¸­ã€‚</p><h4 id="å±€éƒ¨å˜é‡è¡¨"><a href="#å±€éƒ¨å˜é‡è¡¨" class="headerlink" title="å±€éƒ¨å˜é‡è¡¨"></a>å±€éƒ¨å˜é‡è¡¨</h4><p>ç”¨äºå­˜æ”¾æ–¹æ³•å‚æ•°å’Œæ–¹æ³•å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡ã€‚</p><p>åœ¨ä»£ç è¢«ç¼–è¯‘æˆClassæ–‡ä»¶æ—¶ï¼Œåœ¨æ–¹æ³•çš„Codeå±æ€§ä¸­max_localsæ•°æ®é¡¹ä¸­ç¡®å®šäº†è¯¥æ–¹æ³•æ‰€éœ€è¦åˆ†é…çš„å±€éƒ¨å˜é‡è¡¨çš„æœ€å¤§å®¹é‡ã€‚å±€éƒ¨å˜é‡è¡¨çš„å®¹é‡ä»¥å˜é‡æ§½ï¼ˆVariable Slotï¼‰ä¸ºæœ€å°å•ä½ï¼Œæ¯ä¸ªå˜é‡æ§½åº”è¯¥å¯ä»¥å­˜æ”¾ä¸€ä¸ªbooleanã€byteã€charã€shortã€intã€floatã€referenceã€returnAddressè¿™8ç§ä¸è¶…è¿‡32ä½æ•°æ®ç±»å‹ï¼ˆå¯¹äºè¶…è¿‡32ä½çš„longå’Œdoubleï¼Œåˆ™ä½¿ç”¨ä¸¤ä¸ª32ä½çš„å˜é‡æ§½ï¼‰ã€‚</p><p>å¼•ç”¨ç±»å‹ï¼š</p><ul><li>é€šè¿‡å¼•ç”¨å¯ä»¥æ‰¾åˆ°è¿™ä¸ªå¯¹è±¡åœ¨å †ä¸­çš„æ•°æ®å­˜æ”¾çš„èµ·å§‹åœ°å€æˆ–è€…ç´¢å¼•ï¼›</li><li>æ‰¾åˆ°å¯¹è±¡æ‰€å±ç±»å‹åœ¨æ–¹æ³•åŒºä¸­çš„å­˜å‚¨ç±»å‹ï¼›</li></ul><p>returnAddressæ˜¯ä¸ºå­—èŠ‚ç æŒ‡ä»¤jsrã€jsr_w å’ŒretæœåŠ¡ï¼ŒæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œä¸€äº›jvmä½¿ç”¨è¿™å‡ æ¡æŒ‡ä»¤æ¥å®ç°å¼‚å¸¸å¤„ç†æ—¶çš„è·³è½¬ã€‚<br>ç°åœ¨å…¨éƒ¨æ”¹ä¸ºé‡‡ç”¨å¼‚å¸¸è¡¨æ¥ä»£æ›¿ã€‚</p><p>å½“ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒJavaè™šæ‹Ÿæœºä¼šä½¿ç”¨å±€éƒ¨å˜é‡è¡¨æ¥å®Œæˆå‚æ•°å€¼åˆ°å‚æ•°å˜é‡åˆ—è¡¨çš„ä¼ é€’è¿‡ç¨‹ï¼Œå¦‚æœæ˜¯å®ä¾‹æ–¹æ³•å±€éƒ¨å˜é‡è¡¨ç¬¬0ä½ç´¢å¼•çš„å˜é‡æ§½å­˜æ”¾çš„æ˜¯thisã€‚</p><blockquote><p>ä»¥æ°å½“çš„å˜é‡ä½œç”¨åŸŸæ¥æ§åˆ¶å˜é‡çš„å›æ”¶æ—¶é—´æ‰æ˜¯æœ€ä¼˜é›…çš„è§£å†³æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å®Œåå°±å°†å…¶å¼•ç”¨èµ‹äºˆnullï¼Œ å› ä¸ºè¿™ä»…ä»…æ˜¯åŸºäºè™šæ‹Ÿæœºçš„æ¦‚å¿µæ¨¡å‹å±‚é¢ä½œå‡ºçš„ä¼˜åŒ–ï¼Œè™šæ‹Ÿæœºçš„å…·ä½“å®ç°ä¸åŒï¼Œè§£é‡Šæ‰§è¡Œä¸ç¼–è¯‘æ‰§è¡Œç»“æœéƒ½ä¸åŒã€‚</p></blockquote><h4 id="æ“ä½œæ•°æ ˆ"><a href="#æ“ä½œæ•°æ ˆ" class="headerlink" title="æ“ä½œæ•°æ ˆ"></a>æ“ä½œæ•°æ ˆ</h4><p>ä¸€ä¸ªåå…¥å…ˆå‡ºçš„æ ˆï¼ŒåŒå±€éƒ¨å˜é‡è¡¨ä¸€æ ·ï¼Œæ“ä½œæ•°æ ˆçš„æœ€å¤§æ·±åº¦ä¹Ÿåœ¨ç¼–è¯‘çš„æ—¶å€™å°±è¢«å†™å…¥åˆ°Codeå±æ€§çš„max_stacksæ•°æ®é¡¹ä¸­ã€‚32ä½æ•°æ®ç±»å‹æ‰€å ç”¨çš„æ ˆå®¹é‡æ˜¯1ï¼Œ 64ä½æ•°æ®ç±»å‹æ‰€å çš„æ ˆå®¹é‡æ˜¯2.</p><p>é€šè¿‡å°†æ“ä½œæ•°å…¥æ ˆå‡ºæ ˆæ¥è¿›è¡Œç®—æœ¯è¿ç®—ï¼›<br>é€šè¿‡æ“ä½œæ•°æ ˆå°†æ–¹æ³•çš„å‚æ•°è¿›è¡Œä¼ é€’ï¼›</p><h4 id="åŠ¨æ€è¿æ¥"><a href="#åŠ¨æ€è¿æ¥" class="headerlink" title="åŠ¨æ€è¿æ¥"></a>åŠ¨æ€è¿æ¥</h4><p>æ¯ä¸ªæ ˆå¸§éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨ï¼ŒæŒæœ‰è¿™ä¸ªå¼•ç”¨æ—¶ä¸ºäº†æ”¯æŒæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­çš„åŠ¨æ€è¿æ¥ã€‚</p><p>Classæ–‡ä»¶çš„å¸¸é‡æ± ä¸­å­˜æœ‰å¤§é‡çš„ç¬¦å·å¼•ç”¨ï¼Œå­—èŠ‚ç ä¸­çš„æ–¹æ³•è°ƒç”¨æŒ‡ä»¤ä»¥å¸¸é‡æ± æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨ä½œä¸ºå‚æ•°ã€‚</p><p>è¿™äº›ç¬¦å·å¼•ç”¨ä¸€éƒ¨åˆ†åœ¨ç±»åŠ è½½é˜¶æ®µæˆ–è€…ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¼šè¢«è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ï¼›<br>å¦ä¸€éƒ¨åˆ†åœ¨æ¯æ¬¡è¿è¡ŒæœŸé—´éƒ½è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†ç§°ä¸ºåŠ¨æ€è¿æ¥ï¼›</p><h4 id="æ–¹æ³•è¿”å›åœ°å€"><a href="#æ–¹æ³•è¿”å›åœ°å€" class="headerlink" title="æ–¹æ³•è¿”å›åœ°å€"></a>æ–¹æ³•è¿”å›åœ°å€</h4><p>å½“ä¸€ä¸ªæ–¹æ³•é€€å‡ºä»¥åï¼Œå¿…é¡»è¿”å›åˆ°æœ€åˆæ–¹æ³•è¢«è°ƒç”¨æ—¶çš„ä½ç½®ï¼Œç¨‹åºæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œæ–¹æ³•è¿”å›æ—¶å¯èƒ½éœ€è¦åœ¨æ ˆå¸§ä¸­ä¿å­˜ä¸€äº›ä¿¡æ¯ï¼Œæ¥å¸®åŠ©æ¢å¤ä¸»è°ƒæ–¹æ³•çš„æ‰§è¡ŒçŠ¶æ€ã€‚</p><p>ä¸€ä¸ªæ–¹æ³•çš„é€€å‡ºæœ‰ä¸¤ç§æ–¹å¼ï¼š<br>ç¬¬ä¸€ç§æ˜¯æ‰§è¡Œå¼•æ“é‡åˆ°æ–¹æ³•è¿”å›çš„å­—èŠ‚ç æŒ‡ä»¤ï¼›ä¸»è°ƒæ–¹æ³•çš„PCè®¡æ•°å™¨çš„å€¼å°±å¯ä»¥ä½œä¸ºè¿”å›åœ°å€ã€‚<br>å¦ä¸€ç§æ˜¯é‡åˆ°äº†å¼‚å¸¸ï¼Œå¹¶ä¸”åœ¨æœ¬æ–¹æ³•çš„å¼‚å¸¸è¡¨ä¸­æ²¡æœ‰æœç´¢åˆ°åŒ¹é…çš„å¼‚å¸¸å¤„ç†å™¨å¯¼è‡´æ–¹æ³•é€€å‡ºï¼›</p><h2 id="æ–¹æ³•è°ƒç”¨"><a href="#æ–¹æ³•è°ƒç”¨" class="headerlink" title="æ–¹æ³•è°ƒç”¨"></a>æ–¹æ³•è°ƒç”¨</h2><p>æ–¹æ³•è°ƒç”¨é˜¶æ®µçš„ä»»åŠ¡æ˜¯ç¡®è®¤è¢«è°ƒç”¨æ–¹æ³•çš„ç‰ˆæœ¬ã€‚<br>Classæ–‡ä»¶çš„ç¼–è¯‘è¿‡ç¨‹ä¸åŒ…å«ä¼ ç»Ÿç¨‹åºè¯­è¨€çš„è¿æ¥æ­¥éª¤ï¼Œä¸€åˆ‡æ–¹æ³•è°ƒç”¨åœ¨Classæ–‡ä»¶é‡Œé¢å­˜å‚¨çš„éƒ½æ˜¯ç¬¦å·å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ–¹æ³•åœ¨å®é™…è¿è¡Œæ—¶å†…å­˜å¸ƒå±€ä¸­çš„å…¥å£åœ°å€ã€‚å› æ­¤ä¸€äº›è°ƒç”¨éœ€è¦åœ¨åŠ è½½æœŸé—´ï¼Œç”šè‡³åˆ°è¿è¡ŒæœŸé—´æ‰èƒ½ç¡®å®šç›®æ ‡æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ã€‚</p><h4 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>åœ¨ç±»åŠ è½½çš„è§£æé˜¶æ®µï¼Œå°†é™æ€æ–¹æ³•å’Œç§æœ‰æ–¹æ³•å¯¹åº”çš„ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ã€‚å› ä¸ºé™æ€æ–¹æ³•ä¸ç±»å…³è”ï¼Œç§æœ‰æ–¹æ³•ä¸å¯èƒ½è¢«ç»§æ‰¿æˆ–è€…é‡å†™ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå³å¯ç¡®å®šã€‚</p><p>å­—èŠ‚ç æŒ‡ä»¤é›†è®¾è®¡äº†ä¸åŒçš„æŒ‡ä»¤è°ƒç”¨ä¸åŒç±»å‹çš„æ–¹æ³•ï¼š</p><ul><li>invokestatic, è°ƒç”¨é™æ€æ–¹æ³•</li><li>invokespecial, è°ƒç”¨å®ä¾‹æ„é€ å™¨æ–¹æ³•ï¼Œç§æœ‰æ–¹æ³•ï¼Œçˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚</li><li>invokevirtual, ç”¨äºè°ƒç”¨æ‰€æœ‰çš„è™šæ–¹æ³•ï¼ˆè¢«finalä¿®é¥°çš„æ–¹æ³•ï¼‰</li><li>invokeinterface,ç”¨äºè°ƒç”¨æ¥å£æ–¹æ³•ï¼Œä¼šåœ¨è¿è¡Œæ—¶å†ç¡®å®šä¸€ä¸ªå®ç°æ¥å£çš„å¯¹è±¡</li><li>invokedynamic, åœ¨è¿è¡Œæ—¶åŠ¨æ€è§£æå‡ºè°ƒç”¨ç‚¹é™å®šç¬¦å¼•ç”¨çš„æ–¹æ³•ã€‚</li></ul><p>å‰å››æ¡æŒ‡ä»¤ï¼Œåˆ†æ´¾é€»è¾‘éƒ½å›ºåŒ–åœ¨Javaè™šæ‹Ÿæœºå†…éƒ¨ï¼ŒinvokedynamicæŒ‡ä»¤çš„åˆ†æ´¾é€»è¾‘æ˜¯ç”±ç”¨æˆ·è®¾å®šçš„å¼•å¯¼æ–¹æ³•æ¥å†³å®šçš„ã€‚</p><p>åªè¦èƒ½è¢«invokestatic å’Œ invokespecialæŒ‡ä»¤è°ƒç”¨çš„æ–¹æ³•ï¼Œéƒ½å¯ä»¥åœ¨è§£æé˜¶æ®µç¡®å®šå”¯ä¸€çš„è°ƒç”¨ç‰ˆæœ¬ã€‚Javaè¯­è¨€ä¸­ç¬¦åˆè¿™ä¸ªæ¡ä»¶çš„æ–¹æ³•æœ‰é™æ€æ–¹æ³•ã€æ„é€ æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€çˆ¶ç±»æ–¹æ³•å’Œè¢«finalä¿®é¥°çš„æ–¹æ³•,è¿™äº”ç§æ–¹æ³•è¢«ç§°ä¸ºéè™šæ–¹æ³•ï¼Œå…¶ä»–çš„è¢«ç§°ä¸ºè™šæ–¹æ³•ã€‚</p><p>è§£æè°ƒç”¨æ˜¯ä¸€ä¸ªé™æ€çš„è¿‡ç¨‹ï¼Œ åœ¨ç±»åŠ è½½çš„è§£æé˜¶æ®µå°±æŠŠæ¶‰åŠçš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºæ˜ç¡®çš„ç›´æ¥å¼•ç”¨ï¼Œä¸å¿…å»¶è¿Ÿåˆ°è¿è¡ŒæœŸå†å»å®Œæˆã€‚</p><h4 id="åˆ†æ´¾"><a href="#åˆ†æ´¾" class="headerlink" title="åˆ†æ´¾"></a>åˆ†æ´¾</h4><ul><li><p>é™æ€åˆ†æ´¾<br>æ‰€æœ‰ä¾èµ–é™æ€ç±»å‹æ¥å†³å®šæ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾å«åšé™æ€åˆ†æ´¾ã€‚é™æ€åˆ†æ´¾çš„å…¸å‹åº”ç”¨è¡¨ç°æ˜¯æ–¹æ³•é‡è½½ã€‚<br>æ–¹æ³•é‡è½½å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åç§°ç›¸åŒï¼Œå‚æ•°åˆ—è¡¨ä¸åŒã€‚</p></li><li><p>åŠ¨æ€åˆ†æ´¾ä¸å®ç°<br>åœ¨è¿è¡ŒæœŸæ ¹æ®æ—¶æœºç±»å‹ç¡®å®šæ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾è¿‡ç¨‹å«åŠ¨æ€åˆ†æ´¾ï¼Œå®ƒå°±æ˜¯Javaè¯­è¨€ä¸­æ–¹æ³•é‡å†™çš„æœ¬è´¨ã€‚å¤šæ€çš„æ ¹æºåœ¨äºè™šæ–¹æ³•è°ƒç”¨æŒ‡ä»¤invokevirtualçš„æ‰§è¡Œé€»è¾‘ï¼Œå› æ­¤å¤šæ€åªå¯¹æ–¹æ³•æœ‰æ•ˆï¼Œå¯¹å­—æ®µæ— æ•ˆï¼ˆå­—æ®µæ°¸è¿œä¸å‚ä¸å¤šæ€ï¼‰ã€‚</p><p>åŠ¨æ€åˆ†æ´¾æ˜¯æ‰§è¡Œéå¸¸é¢‘ç¹çš„åŠ¨ä½œï¼Œè€Œä¸”åŠ¨æ€åˆ†æ´¾çš„æ–¹æ³•ç‰ˆæœ¬é€‰æ‹©è¿‡ç¨‹éœ€è¦è¿è¡Œæ—¶åœ¨æ¥å—ç€ç±»å‹æ–¹æ³•å…ƒæ•°æ®ä¸­æœç´¢åˆé€‚çš„ç›®æ ‡æ–¹æ³•ï¼Œ</p></li><li><p>å•åˆ†æ´¾å’Œå¤šåˆ†æ´¾<br>æ–¹æ³•çš„æ¥æ”¶è€…ï¼ˆè¦è¢«æ‰§è¡Œçš„æ–¹æ³•çš„æ‰€æœ‰è€…å«æ¥æ”¶è€…ï¼‰ä¸å‚æ•°ç»Ÿç§°ä¸ºæ–¹æ³•çš„å®—é‡ã€‚<br>å•åˆ†æ´¾æ˜¯æ ¹æ®ä¸€ä¸ªå®—é‡å¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œé€‰æ‹©ï¼›<br>å¤šåˆ†æ´¾æ˜¯æ ¹æ®å¤šä¸ªå®—é‡å¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œé€‰æ‹©ï¼›</p></li></ul><h4 id="Javaä¸­çš„è§£é‡Šæ‰§è¡Œä¸ç¼–è¯‘æ‰§è¡Œ"><a href="#Javaä¸­çš„è§£é‡Šæ‰§è¡Œä¸ç¼–è¯‘æ‰§è¡Œ" class="headerlink" title="Javaä¸­çš„è§£é‡Šæ‰§è¡Œä¸ç¼–è¯‘æ‰§è¡Œ"></a>Javaä¸­çš„è§£é‡Šæ‰§è¡Œä¸ç¼–è¯‘æ‰§è¡Œ</h4><p><img src="/2020/06/05/%E5%AD%97%E8%8A%82%E7%A0%81%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E/%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E.jpeg" alt="ç¼–è¯‘è¿‡ç¨‹"></p><p>åœ¨æ‰§è¡Œå‰å…ˆå¯¹ç¨‹åºæºç è¿›è¡Œè¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æå¤„ç†ï¼ŒæŠŠæºç è½¬åŒ–ä¸ºæŠ½è±¡è¯­æ³•æ ‘ã€‚</p><p>å¯¹äºC/C++æ¥è¯´ï¼Œè¯æ³•ã€è¯­æ³•åˆ†æä»¥ååˆ°åé¢çš„ä¼˜åŒ–å™¨å’Œç›®æ ‡ä»£ç ç”Ÿæˆå™¨éƒ½å¯ä»¥é€‰æ‹©ç‹¬ç«‹äºæ‰§è¡Œå¼•æ“ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´æœ‰æ„ä¹‰çš„ç¼–è¯‘å™¨å»å®ç°ï¼Œè¿™ç±»å°±æ˜¯ç¼–è¯‘æ‰§è¡Œã€‚</p><p>å¯¹äºJavaæ¥è¯´ï¼Œjavacç¼–è¯‘å™¨å®Œæˆäº†ç¨‹åºä»£ç ç»è¿‡è¯æ³•åˆ†æã€è¯­æ³•åˆ†æåˆ°æŠ½è±¡è¯­æ³•æ ‘ï¼Œå†ä¾¿åˆ©è¯­æ³•æ ‘ç”Ÿæˆçº¿æ€§çš„å­—èŠ‚ç æŒ‡ä»¤æµçš„è¿‡ç¨‹ã€‚</p><h4 id="åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸ç»™äºˆå¯„å­˜å™¨çš„æŒ‡ä»¤é›†"><a href="#åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸ç»™äºˆå¯„å­˜å™¨çš„æŒ‡ä»¤é›†" class="headerlink" title="åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸ç»™äºˆå¯„å­˜å™¨çš„æŒ‡ä»¤é›†"></a>åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸ç»™äºˆå¯„å­˜å™¨çš„æŒ‡ä»¤é›†</h4><ul><li>åŸºäºæ ˆçš„æŒ‡ä»¤é›†<br>é›¶åœ°å€æŒ‡ä»¤ï¼Œä¾èµ–æ“ä½œæ•°æ ˆè¿›è¡Œå·¥ä½œï¼Œ<br>ä¼˜ç‚¹æ˜¯å¯ç§»æ¤æ€§é«˜ï¼Œä¸ä¸å…·ä½“çš„ç¡¬ä»¶ç»‘å®šã€‚ç¼–è¯‘å™¨å®ç°ç®€å•ã€‚<br>ç¼ºç‚¹æ˜¯é€Ÿåº¦æ…¢ã€‚</li><li>ç»™äºˆå¯„å­˜å™¨çš„æŒ‡ä»¤é›†<br>è€Œåœ°å€æŒ‡ä»¤é›†ï¼Œç‰©ç†ç¡¬ä»¶ç›´æ¥æ”¯æŒçš„æŒ‡ä»¤é›†æ¶æ„ï¼Œä¾èµ–å¯„å­˜å™¨å·¥ä½œã€‚</li></ul><blockquote><p>è™šæ‹Ÿæœºæœ€ç»ˆä¼šå¯¹æ‰§è¡Œè¿‡ç¨‹ä½œå‡ºä¸€ç³»åˆ—ä¼˜åŒ–æ¥æé«˜æ€§èƒ½ï¼Œ å®é™…çš„æƒ…å†µä¼šå’Œç›–é¢æ¨¡å‹å·®è·éå¸¸å¤§ï¼Œå·®è·äº§ç”Ÿçš„æ ¹æœ¬åŸå› æ˜¯è™šæ‹Ÿæœºä¸­è§£æèµ·å’Œå³æ—¶ç¼–è¯‘èµ·éƒ½ä¼šå¯¹è¾“å…¥çš„å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–ï¼Œå³ä½¿è§£é‡Šå…¶ä¸­ä¹Ÿä¸æ˜¯æŒ‰ç…§å­—èŠ‚ç æŒ‡ä»¤å»é€æ¡æ‰§è¡Œçš„ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­—èŠ‚ç æ‰§è¡Œå¼•æ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>etcd</title>
      <link href="/2020/06/04/etcd/"/>
      <url>/2020/06/04/etcd/</url>
      
        <content type="html"><![CDATA[<p>åŸ¹å…»è‰¯å¥½çš„ç”Ÿæ´»ã€å­¦ä¹ ã€å·¥ä½œä¹ æƒ¯ã€‚</p><p>ç›¸å…³æ¦‚å¿µï¼š</p><ul><li>Etcd</li><li>coreOS</li><li>RancherOS</li></ul><h3 id="ä¸»æœºè§„åˆ’ï¼š"><a href="#ä¸»æœºè§„åˆ’ï¼š" class="headerlink" title="ä¸»æœºè§„åˆ’ï¼š"></a>ä¸»æœºè§„åˆ’ï¼š</h3><blockquote><p>è¦æ±‚ï¼šä¸»æœºåç§°è§„èŒƒã€IPæ®µç›¸é‚»ã€å¤‡æ³¨æ˜ç¡®</p></blockquote><table><thead><tr><th>ä¸»æœºåºå·</th><th>åç§°</th><th>å†…ç½‘IP</th><th>å¤–ç½‘IP</th><th>CPUæ ¸æ•°</th><th>å†…å­˜å¤§å°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>01</td><td>etcd-node-master-01</td><td>10.0.0.1</td><td>å¤–ç½‘IP</td><td>2</td><td>4G</td><td>å¤‡æ³¨</td></tr><tr><td>02</td><td>etcd-node-slave-02</td><td>10.0.0.2</td><td>å¤–ç½‘IP</td><td>2</td><td>4G</td><td>å¤‡æ³¨</td></tr><tr><td>03</td><td>etcd-node-slave-03</td><td>10.0.0.3</td><td>å¤–ç½‘IP</td><td>2</td><td>4G</td><td>å¤‡æ³¨</td></tr></tbody></table><h3 id="è®¾ç½®ä¸»æœºåç§°"><a href="#è®¾ç½®ä¸»æœºåç§°" class="headerlink" title="è®¾ç½®ä¸»æœºåç§°"></a>è®¾ç½®ä¸»æœºåç§°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname etcd-node-master-01</span><br><span class="line">hostnamectl set-hostname etcd-node-slave-02</span><br><span class="line">hostnamectl set-hostname etcd-node-slave-03</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹å†…ç½‘IPåœ°å€ï¼š"><a href="#ä¿®æ”¹å†…ç½‘IPåœ°å€ï¼š" class="headerlink" title="ä¿®æ”¹å†…ç½‘IPåœ°å€ï¼š"></a>ä¿®æ”¹å†…ç½‘IPåœ°å€ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33</span><br></pre></td></tr></table></figure><h3 id="é‡å¯ç½‘å…³ï¼š"><a href="#é‡å¯ç½‘å…³ï¼š" class="headerlink" title="é‡å¯ç½‘å…³ï¼š"></a>é‡å¯ç½‘å…³ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><h3 id="é˜²ç«å¢™è®¾ç½®ï¼š"><a href="#é˜²ç«å¢™è®¾ç½®ï¼š" class="headerlink" title="é˜²ç«å¢™è®¾ç½®ï¼š"></a>é˜²ç«å¢™è®¾ç½®ï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone&#x3D;public --add-port&#x3D;2379&#x2F;tcp --permanent</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h4 id="YUMå®‰è£…ï¼š"><a href="#YUMå®‰è£…ï¼š" class="headerlink" title="YUMå®‰è£…ï¼š"></a>YUMå®‰è£…ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y etcd</span><br></pre></td></tr></table></figure><h4 id="éªŒè¯-amp-æŸ¥çœ‹ç‰ˆæœ¬"><a href="#éªŒè¯-amp-æŸ¥çœ‹ç‰ˆæœ¬" class="headerlink" title="éªŒè¯&amp;æŸ¥çœ‹ç‰ˆæœ¬"></a>éªŒè¯&amp;æŸ¥çœ‹ç‰ˆæœ¬</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa etcd</span><br><span class="line">etcdctl -v</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹é…ç½®ï¼š"><a href="#ä¿®æ”¹é…ç½®ï¼š" class="headerlink" title="ä¿®æ”¹é…ç½®ï¼š"></a>ä¿®æ”¹é…ç½®ï¼š</h3><p>åˆ†åˆ«ä¿®æ”¹3ä¸ªä¸»æœºçš„é…ç½®æ–‡ä»¶/etc/etcd/etcd.conf</p><blockquote><p>æ³¨æ„ï¼ä¿®æ”¹å‰ä¸€å®šè¦å¤‡ä»½ï¼<br>   cp /etc/etcd/etcd.conf /etc/etcd/etcd.conf.bak</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ETCD_LISTEN_PEER_URLS&#x3D;&quot;http:&#x2F;&#x2F;10.0.0.1:2380&quot;</span><br><span class="line">ETCD_LISTEN_CLIENT_URLS&#x3D;&quot;http:&#x2F;&#x2F;10.0.0.1:2379,http:&#x2F;&#x2F;127.0.0.1:2379&quot;</span><br><span class="line">ETCD_NAME&#x3D;Master</span><br><span class="line">ETCD_INITIAL_ADVERTISE_PEER_URLS&#x3D;&quot;http:&#x2F;&#x2F;10.0.0.1:2380&quot;</span><br><span class="line">ETCD_ADVERTISE_CLIENT_URLS&#x3D;&quot;http:&#x2F;&#x2F;10.0.0.1:2379&quot;</span><br><span class="line">ETCD_INITIAL_CLUSTER&#x3D;â€œMaster&#x3D;http:&#x2F;&#x2F;10.0.0.1:2380,Node02&#x3D;http:&#x2F;&#x2F;10.0.0.2:2380,Node03&#x3D;http:&#x2F;&#x2F;10.0.0.3:2380&quot;</span><br><span class="line">ETCD_INITIAL_CLUSTER_TOKEN&#x3D;&quot;etcd-cluster&quot;</span><br><span class="line">ETCD_INITIAL_CLUSTER_STATE&#x3D;&quot;new&quot;</span><br></pre></td></tr></table></figure><h4 id="é‡å¯etcdæœåŠ¡"><a href="#é‡å¯etcdæœåŠ¡" class="headerlink" title="é‡å¯etcdæœåŠ¡"></a>é‡å¯etcdæœåŠ¡</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart etcd</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹Etcdé›†ç¾¤"><a href="#æŸ¥çœ‹Etcdé›†ç¾¤" class="headerlink" title="æŸ¥çœ‹Etcdé›†ç¾¤"></a>æŸ¥çœ‹Etcdé›†ç¾¤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">etcdctl member list</span><br></pre></td></tr></table></figure><h4 id="Etcd-æµ‹è¯•"><a href="#Etcd-æµ‹è¯•" class="headerlink" title="Etcd æµ‹è¯•"></a>Etcd æµ‹è¯•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">etcdctl set name test</span><br><span class="line">etcdctl get name</span><br></pre></td></tr></table></figure><h5 id="æ‰©å±•æ¦‚å¿µ"><a href="#æ‰©å±•æ¦‚å¿µ" class="headerlink" title="æ‰©å±•æ¦‚å¿µ"></a>æ‰©å±•æ¦‚å¿µ</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">è´Ÿè½½å‡è¡¡ï¼š</span><br><span class="line">åŒºåŸŸè´Ÿè½½å‡è¡¡ï¼šDNS</span><br><span class="line">ç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼šF5&#x2F;A10</span><br><span class="line">è½¯ä»¶è´Ÿè½½å‡è¡¡ï¼šNginx&#x2F;LVS&#x2F;HAProxy</span><br><span class="line"></span><br><span class="line">ç£ç›˜é˜µåˆ—ï¼šraid</span><br><span class="line">é˜²ç«å¢™æŠ€æœ¯ï¼šç¡¬ä»¶&#x2F;è½¯ä»¶</span><br><span class="line"></span><br><span class="line">NTPï¼ˆNetwork Time Protocalï¼‰æ˜¯ç”¨æ¥ä½¿è®¡ç®—æœºæ—¶é—´åŒæ­¥åŒ–çš„ä¸€ç§åè®®ï¼Œå®ƒå¯ä»¥ä½¿è®¡ç®—æœºå¯¹å…¶æœåŠ¡å™¨æˆ–æ—¶é’Ÿæºï¼ˆå¦‚çŸ³è‹±é’Ÿï¼ŒGPSç­‰ç­‰)åšåŒæ­¥åŒ–tongbuwangã€‚</span><br><span class="line"></span><br><span class="line">Radisçš„åˆ†å¸ƒå¼ç¼“å­˜;</span><br><span class="line">mysqlä¸»ä»ã€è¯»å†™åˆ†ç¦»ã€é«˜å¯ç”¨ã€åˆ†åº“åˆ†è¡¨ï¼›</span><br><span class="line"></span><br><span class="line">MHA</span><br><span class="line">å¤‡ä»½</span><br><span class="line">elk </span><br><span class="line">ci&#x2F;cd</span><br><span class="line">centos8 &#x2F; podman</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Etcd </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Etcd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</title>
      <link href="/2020/06/02/JVM%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F/"/>
      <url>/2020/06/02/JVM%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<p>å½“ä¸€ä¸ªç±»åŠ è½½åˆ°å†…å­˜åï¼ŒJVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸéƒ½éœ€è¦å­˜å‚¨ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ</p><p>1ï¼‰ç±»çš„æ ¼å¼ä¿¡æ¯ã€ä¸»æ¬¡ç‰ˆæœ¬å·ã€ å¸¸é‡æ± ã€å­—æ®µã€æ–¹æ³•ã€å±æ€§ä¿¡æ¯éœ€è¦å­˜å‚¨ï¼Œè¿™éƒ¨åˆ†æ•°æ®éœ€è¦æ¯ä¸ªçº¿ç¨‹å…±äº«ï¼›<br>   å½“ç±»åŠ è½½å™¨å°†é™æ€çš„äºŒè¿›åˆ¶å­—èŠ‚ç ä»ç±»æ–‡ä»¶åŠ è½½åˆ°å†…å­˜åï¼Œå¯¹å†…å®¹è¿›è¡ŒéªŒè¯ã€è§£æè½¬æ¢ä¸ºç¬¦åˆJVMå­˜å‚¨çš„æ•°æ®æ ¼å¼ã€‚</p><p>2ï¼‰ç”Ÿæˆçš„Classç±»å¯¹è±¡å’Œä»£ç è¿è¡Œæ—¶åŠ¨æ€åˆ›å»ºçš„å¯¹è±¡å’Œæ•°ç»„éœ€è¦å­˜å‚¨ï¼›<br>   é€šè¿‡loadingã€linkingã€initializingåç”Ÿæˆçš„Classå¯¹è±¡ï¼Œåšä¸ºç¨‹åºè®¿é—®è¿™ä¸ªç±»çš„å…¥å£ï¼Œ<br>   ä»¥åŠç¨‹åºè¿è¡Œæ—¶äº§ç”Ÿçš„å¯¹è±¡å’Œæ•°ç»„ï¼Œéƒ½æœ‰å¯èƒ½ä¼šè¢«ä¸åŒçš„çº¿ç¨‹å¼•ç”¨å’Œè®¿é—®ï¼Œå› æ­¤è¿™éƒ¨åˆ†åŒºåŸŸçš„æ•°æ®ä¹Ÿéœ€è¦çº¿ç¨‹å…±äº«ã€‚<br>3ï¼‰æ¯ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ•°æ®éœ€è¦å­˜å‚¨å’Œæ¯ä¸ªçº¿ç¨‹ä¸‹æ–¹æ³•çš„æ–¹æ³•æ•°æ®éœ€è¦å­˜å‚¨ï¼›<br>   å½“çº¿ç¨‹åˆ›å»ºçš„æ—¶å€™éœ€è¦æœ‰ä¸€ä¸ªçº¿ç¨‹æ ˆæ¥å­˜æ”¾çº¿ç¨‹ä¿¡æ¯ï¼Œä»¥åŠPCè®¡æ•°å™¨è®°å½•å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„ä»£ç è¡Œå·ã€‚<br>   è¿˜æœ‰JVMæœ¬åœ°çº¿ç¨‹æ‰§è¡Œæ—¶éœ€è¦çš„æœ¬åœ°çº¿ç¨‹æ ˆå­˜æ”¾æœ¬åœ°çº¿ç¨‹çš„æ‰§è¡Œæƒ…å†µã€‚</p><p>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹è§„å®šäº†å¦‚ä¸‹å†…å­˜åŒºåŸŸæ¥å­˜å‚¨æ•°æ®</p><blockquote><ul><li>å…±äº«åŒºåŸŸ</li></ul></blockquote><ul><li>å †åŒº</li><li>æ–¹æ³•åŒº<ul><li>è¿è¡Œæ—¶å¸¸é‡æ± </li><li>çº¿ç¨‹ç§æœ‰åŒºåŸŸ</li></ul></li><li>JVMçº¿ç¨‹æ ˆ</li><li>æœ¬åœ°æ–¹æ³•æ ˆ</li><li>PCè®¡æ•°å™¨</li></ul><p><img src="/2020/06/02/JVM%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F/runtime_dataarea.webp" alt="Runtime DataArea"></p><h3 id="å †åŒº"><a href="#å †åŒº" class="headerlink" title="å †åŒº"></a>å †åŒº</h3><p>  å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡ä»¥åŠæ•°ç»„éƒ½å­˜æ”¾åœ¨å †åŒºã€‚</p><h3 id="æ–¹æ³•åŒº"><a href="#æ–¹æ³•åŒº" class="headerlink" title="æ–¹æ³•åŒº"></a>æ–¹æ³•åŒº</h3><p>  ç”¨äºå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»å‹ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€åŠæ—¶ç¼–è¯‘å™¨å˜å¼‚åçš„ä»£ç ç¼“å­˜ç­‰æ•°æ®ã€‚</p><h4 id="è¿è¡Œæ—¶å¸¸é‡æ± "><a href="#è¿è¡Œæ—¶å¸¸é‡æ± " class="headerlink" title="è¿è¡Œæ—¶å¸¸é‡æ± "></a>è¿è¡Œæ—¶å¸¸é‡æ± </h4><p>  è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸæˆ–è€…è¿è¡ŒæœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚</p><h3 id="Javaè™šæ‹Ÿæœºæ ˆ"><a href="#Javaè™šæ‹Ÿæœºæ ˆ" class="headerlink" title="Javaè™šæ‹Ÿæœºæ ˆ"></a>Javaè™šæ‹Ÿæœºæ ˆ</h3><p>   æ¯ä¸ªçº¿ç¨‹ä¼šç”Ÿæˆä¸€ä¸ªçº¿ç¨‹æ ˆï¼Œæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™ï¼ŒJavaè™šæ‹Ÿæœºéƒ½ä¼šåŒæ­¥åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ä¿¡æ¯ã€‚</p><h5 id="å±€éƒ¨å˜é‡è¡¨"><a href="#å±€éƒ¨å˜é‡è¡¨" class="headerlink" title="å±€éƒ¨å˜é‡è¡¨"></a>å±€éƒ¨å˜é‡è¡¨</h5><p>å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§Javaè™šæ‹ŸæœºåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbooleanã€byteã€charã€shortã€intã€long ã€floatã€doubleï¼‰ã€å¼•ç”¨ç±»å‹ã€returnAddressç±»å‹ã€‚<br>      è¿™äº›æ•°æ®ç±»å‹åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­çš„å­˜å‚¨ç©ºé—´ä»¥å±€éƒ¨å˜é‡æ§½æ¥è¡¨ç¤ºï¼ˆ64ä½çš„longå’Œdoubleå ç”¨2ä¸ªå˜é‡æ§½ï¼Œå…¶ä½™æ•°æ®ç±»å‹å ç”¨1ä¸ªå˜é‡æ§½ï¼‰ã€‚å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´åœ¨ç¼–è¯‘æœŸå®Œæˆåˆ†é…ï¼Œå› æ­¤å½“è¿›å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨æ ˆå¸§ä¸­åˆ†é…å¤šå¤§çš„å±€éƒ¨å˜é‡ç©ºé—´æ˜¯ç¡®å®šçš„ã€‚åœ¨è¿è¡ŒæœŸé—´æ˜¯ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°ï¼ˆæ§½çš„å¤šå°‘ï¼‰ã€‚</p><h3 id="æœ¬åœ°æ–¹æ³•æ ˆ"><a href="#æœ¬åœ°æ–¹æ³•æ ˆ" class="headerlink" title="æœ¬åœ°æ–¹æ³•æ ˆ"></a>æœ¬åœ°æ–¹æ³•æ ˆ</h3><p>ä¸è™šæ‹Ÿæœºæ ˆä½œç”¨ç±»ä¼¼ï¼Œä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„æœ¬åœ°æ–¹æ³•æœåŠ¡ã€‚</p><h3 id="PCè®¡æ•°å™¨"><a href="#PCè®¡æ•°å™¨" class="headerlink" title="PCè®¡æ•°å™¨"></a>PCè®¡æ•°å™¨</h3><p>   å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚åœ¨Javaè™šæ‹Ÿæœºçš„æ¦‚å¿µæ¨¡å‹é‡Œï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><p>å¯¹äºJDK1.8ä»¥åHotSpotè™šæ‹Ÿæœºæ”¹ç”¨ä¸Jrokitã€J9ä¸€æ ·ä¸æœ¬åœ°å†…å­˜ä¸­å®ç°çš„å…ƒç©ºé—´ï¼ˆMeta-spaceï¼‰æ¥å®ç°æ–¹æ³•åŒºã€‚æ— è®ºæ˜¯åŸç©ºé—´è¿˜æ˜¯æ°¸ä¹…ä»£ï¼Œä»–ä»¬åªæ˜¯æ–¹æ³•åŒºçš„å®ç°ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± å’Œé™æ€å˜é‡çš„å­˜å‚¨é€»è¾‘ä¸Šä»ç„¶å±äºæ–¹æ³•åŒºã€‚å…ƒç©ºé—´ä½¿ç”¨çš„æ˜¯ç‰©ç†å†…å­˜ã€æ°¸ä¹…ä»£ä½¿ç”¨çš„æ˜¯JVMå†…å­˜ã€‚å› æ­¤å…ƒç©ºé—´çš„å¤§å°åªå—é™äºç‰©ç†å†…å­˜ã€‚</p><p><img src="/2020/06/02/JVM%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F/hotspot_runtimearea.png" alt="HotSpot è™šæ‹Ÿæœºå®ç°"></p><h2 id="HotSpot-è™šæ‹Ÿæœºå¯¹è±¡çš„åˆ›å»ºä¸å¼•ç”¨"><a href="#HotSpot-è™šæ‹Ÿæœºå¯¹è±¡çš„åˆ›å»ºä¸å¼•ç”¨" class="headerlink" title="HotSpot è™šæ‹Ÿæœºå¯¹è±¡çš„åˆ›å»ºä¸å¼•ç”¨"></a>HotSpot è™šæ‹Ÿæœºå¯¹è±¡çš„åˆ›å»ºä¸å¼•ç”¨</h2><h4 id="å¯¹è±¡çš„åˆ›å»º"><a href="#å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="å¯¹è±¡çš„åˆ›å»º"></a>å¯¹è±¡çš„åˆ›å»º</h4><p>1ï¼‰ åœ¨newä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå…ˆéœ€è¦é€šè¿‡ç±»åŠ è½½æ£€æŸ¥ï¼Œç„¶åè™šæ‹Ÿæœºä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ã€‚</p><p>å¯¹è±¡æ‰€éœ€è¦çš„å†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯ä»¥å®Œå…¨ç¡®å®šï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡å®é™…ä¸Šä¾¿ç­‰åŒäºæŠŠä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜å—ä»Javaå †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚</p><ul><li>æŒ‡é’ˆç¢°æ’<br>å‡è®¾å†…å­˜è§„æ•´ï¼Œå°†ä½¿ç”¨è¿‡çš„åœ¨ä¸€è¾¹ï¼Œç©ºé—²çš„åœ¨ä¸€è¾¹ï¼Œä¸­é—´æ”¾ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºåˆ†ç•Œç‚¹çš„æŒ‡ç¤ºå™¨ï¼Œæ‰€åˆ†é…å†…å­˜å°±æ˜¯æŠŠæŒ‡é’ˆå‘ç©ºé—²ç©ºé—´æ–¹å‘æŒªåŠ¨ä¸€æ®µä¸å¯¹è±¡ç›¸ç­‰çš„è·ç¦»ã€‚<br>ä½¿ç”¨Serialã€ParNewå¸¦å‹ç¼©æ•´ç†è¿‡ç¨‹çš„GCæ”¶é›†å™¨æ—¶ï¼Œé‡‡ç”¨æŒ‡é’ˆç¢°æ’ï¼Œç®€å•é«˜æ•ˆï¼›</li><li>ç©ºé—²åˆ—è¡¨<br>å‡è®¾å†…å­˜ä¸è§„æ•´ï¼Œæ˜¯ä¸€å—å—ä¸è¿ç»­çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨è®°å½•å“ªå—å†…å­˜å¯ç”¨ï¼Œå“ªå—å†…å­˜ä¸å¯ç”¨ï¼Œåœ¨åˆ†é…çš„æ—¶å€™åœ¨åˆ—è¡¨ä¸­æ‰¾ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´åˆ’åˆ†ç»™å¯¹è±¡å®ä¾‹ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ã€‚<br>ä½¿ç”¨CMSåŸºäºæ¸…é™¤ç®—æ³•çš„æ”¶é›†å™¨æ—¶ï¼Œç†è®ºä¸Šåªèƒ½é‡‡ç”¨å¤æ‚çš„ç©ºé—²åˆ—è¡¨æ¥åˆ†é…å†…å­˜ã€‚</li></ul><h5 id="Thread-Local-Allocation-Buffer"><a href="#Thread-Local-Allocation-Buffer" class="headerlink" title="Thread Local Allocation Buffer"></a>Thread Local Allocation Buffer</h5><p>åœ¨å †ä¸­åˆ›å»ºå¯¹è±¡æ˜¯ç‰¹åˆ«é¢‘ç¹çš„äº‹æƒ…ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°å¤šçº¿ç¨‹çš„è®¿é—®ã€‚å¦‚ä½•ä¿è¯é«˜æ•ˆä¸”å®‰å…¨çš„ç”³è¯·ç©ºé—´ï¼Ÿ</p><ul><li>åŒæ­¥æˆ–è€…CAS+å¤±è´¥é‡è¯•çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ï¼›</li><li>ä¸ºæ¯ä¸ªçº¿ç¨‹åœ¨å †ä¸­é¢„å…ˆåˆ†é…ä¸€å°å—å†…å­˜ï¼Œé€šè¿‡-XX:+/-UseTLAB è®¾å®šï¼›</li></ul><p>2ï¼‰åˆ†é…å®Œå†…å­˜åï¼Œä¸ºå†…å­˜ç©ºé—´åˆå§‹åŒ–é›¶å€¼ä»¥åŠå¿…è¦çš„è®¾ç½®ã€‚<br>åˆå§‹åŒ–é›¶å€¼å¯ä»¥ä¿è¯å¯¹è±¡å®ä¾‹å­—æ®µåœ¨Javaå¯¹è±¡ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚<br>ä¹‹åè®¾ç½®è¿™ä¸ªå¯¹è±¡çš„ç±»å‹ã€å…³è”ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€GCåˆ†ä»£å¹´é¾„ä¿¡æ¯ç­‰ã€‚</p><p>3ï¼‰æ‰§è¡Œ &lt;init&gt;() æ–¹æ³•ï¼Œå°†å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚</p><h4 id="å¯¹è±¡çš„å†…å­˜å¸ƒå±€"><a href="#å¯¹è±¡çš„å†…å­˜å¸ƒå±€" class="headerlink" title="å¯¹è±¡çš„å†…å­˜å¸ƒå±€"></a>å¯¹è±¡çš„å†…å­˜å¸ƒå±€</h4><p>åœ¨Hotspotè™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¸ƒå±€åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†</p><ul><li>å¯¹è±¡å¤´ï¼ˆHeaderï¼‰<ul><li>ä¸€éƒ¨åˆ†æ˜¯å¯¹è±¡è‡ªèº«è¿è¡Œæ—¶æ•°æ®ï¼ŒHashCode, GCåˆ†ä»£å¹´é¾„ï¼Œé”çŠ¶æ€æ ‡å¿—ï¼Œçº¿ç¨‹æŒæœ‰é”ï¼Œåå‘çº¿ç¨‹ID,åå‘æ—¶é—´æˆ³ï¼ˆæ•°ç»„é•¿åº¦ï¼‰ã€‚</li><li>ä¸€éƒ¨åˆ†æ˜¯ç±»å‹æŒ‡é’ˆï¼ŒæŒ‡å‘å®ƒçš„ç±»å‹å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œç”¨æ¥ç¡®å®šæ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚</li></ul></li><li>å®ä¾‹æ•°æ®ï¼ˆInstance Dataï¼‰<br>å­—æ®µçš„å­˜å‚¨é¡ºåºå—åˆ°è™šæ‹Ÿæœºåˆ†é…ç­–ç•¥ï¼ˆ-XX:FieldsAllocationStyleï¼‰å’Œå­—æ®µåœ¨æºç ä¸­çš„é¡ºåºå½±å“ã€‚<br>é»˜è®¤ç›¸åŒå®½åº¦çš„å­—æ®µè¢«åˆ†é…åˆ°ä¸€èµ·å­˜æ”¾ï¼Œçˆ¶ç±»ä¸­å®šä¹‰çš„å˜é‡ä¼šå‡ºç°åœ¨å­ç±»ä¹‹å‰ã€‚<br>ä½¿ç”¨+XX:CompactFields=trueå­—ç±»ä¸­è¾ƒçª„çš„å˜é‡ä¹Ÿä¼šæ’å…¥åˆ°çˆ¶ç±»å˜é‡çš„ç©ºéš™ä¹‹ä¸­ã€‚</li><li>å¡«å……ï¼ˆPaddingï¼‰<br>ä¸ºäº†æ»¡è¶³ç¡¬ä»¶çš„æ€§èƒ½éœ€æ±‚å’Œæé«˜åƒåœ¾å›æ”¶æ—¶æŒ‡é’ˆæ‰«æçš„æ–¹ä¾¿æ€§ã€‚HotSpotè™šæ‹Ÿæœºçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡çš„èµ·å§‹åœ°å€å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚çš„æ•´æ•°å€ï¼ˆä»»ä½•å¯¹è±¡çš„å¤§å°å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚çš„æ•´æ•°å€ï¼‰ã€‚</li></ul><h3 id="å¯¹è±¡çš„è®¿é—®å®šä½"><a href="#å¯¹è±¡çš„è®¿é—®å®šä½" class="headerlink" title="å¯¹è±¡çš„è®¿é—®å®šä½"></a>å¯¹è±¡çš„è®¿é—®å®šä½</h3><p>å¯¹è±¡åœ¨å †ä¸­åˆ›å»ºå¥½äº†ï¼ŒJavaç¨‹åºä¼šé€šè¿‡æ ˆä¸Šå±€éƒ¨å˜é‡è¡¨ä¸­çš„referenceå­—æ®µæ¥å¼•ç”¨å †ä¸Šçš„å¯¹è±¡ã€‚</p><ul><li>å¥æŸ„è®¿é—®<br>Javaå †ä¸­åˆ’åˆ†å‡ºä¸€å—å†…å­˜ä½œä¸ºå¥æŸ„æ± ï¼Œreferenceä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªå…·ä½“çš„åœ°å€ä¿¡æ¯ã€‚<br>å¥½å¤„ï¼šreferenceä¸­å­˜å‚¨çš„äº‹ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œå¯¹è±¡è¢«ç§»åŠ¨æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆã€‚<br><img src="/2020/06/02/JVM%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F/jubing.jpeg" alt="å¥æŸ„è®¿é—®"></li><li>ç›´æ¥æŒ‡é’ˆ<br>referenceä¸­å­˜å‚¨çš„æ˜¯å¯¹è±¡çš„åœ°å€ã€‚å¥½å¤„æ˜¯é€Ÿåº¦å¿«ï¼ŒèŠ‚çº¦äº†æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ã€‚<br><img src="/2020/06/02/JVM%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F/direct.jpeg" alt="ç›´æ¥æŒ‡é’ˆ"></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> è¿è¡Œæ—¶åŒºåŸŸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JVMå†…å­˜æ¨¡å‹</title>
      <link href="/2020/06/02/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
      <url>/2020/06/02/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<p>è®¡ç®—æœºä¸ºäº†æå‡æ•ˆç‡ï¼Œå¢åŠ äº†å¤šå†…æ ¸ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªå†…æ ¸å¢åŠ äº†è‡ªå·±çš„é«˜é€Ÿç¼“å­˜ï¼Œè€Œä»–ä»¬åˆå…±äº«åŒä¸€ä¸ªä¸»å†…å­˜ã€‚</p><p><img src="/2020/06/02/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/jmm01.jpeg" alt="è®¡ç®—æœºå¤„ç†å™¨ã€é«˜é€Ÿç¼“å­˜ã€ä¸»å†…å­˜ä¹‹é—´çš„äº¤äº’å…³ç³»"></p><p>é™¤äº†å¢åŠ é«˜é€Ÿç¼“å­˜å¤–ï¼Œä¸ºäº†ä½¿å¤„ç†å™¨å†…éƒ¨çš„è¿ç®—å•å…ƒèƒ½å°½é‡è¢«å……åˆ†åˆ©ç”¨ï¼Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹è¾“å…¥ä»£ç è¿›è¡Œä¹±åºæ‰§è¡Œä¼˜åŒ–ï¼Œä½†ä¿è¯ç»“æœä¸é¡ºåºæ‰§è¡Œçš„ç»“æœä¸€è‡´ã€‚</p><p>ä¸å¤„ç†å™¨çš„ä¹±åºæ‰§è¡Œä¼˜åŒ–ç±»ä¼¼ï¼ŒJavaè™šæ‹Ÿæœºçš„å³æ—¶ç¼–è¯‘å™¨ä¹Ÿæœ‰æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ã€‚</p><h2 id="Javaå†…å­˜æ¨¡å‹"><a href="#Javaå†…å­˜æ¨¡å‹" class="headerlink" title="Javaå†…å­˜æ¨¡å‹"></a>Javaå†…å­˜æ¨¡å‹</h2><p>ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­æ›¾è¯•å›¾å®šä¹‰ä¸€ç§Javaå†…å­˜æ¨¡å‹æ¥å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ã€‚</p><h4 id="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"><a href="#ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜" class="headerlink" title="ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"></a>ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜</h4><p>Javaå†…å­˜æ¨¡å‹çš„ä¸»è¦ç›®çš„æ˜¯å®šä¹‰ç¨‹åºä¸­å„ç§å˜é‡çš„è®¿é—®è§„åˆ™ï¼ˆå…³æ³¨è™šæ‹Ÿæœºä¸­æŠŠå˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­å–å‡ºå˜é‡çš„åº•å±‚ç»†èŠ‚ã€‚ï¼‰<br>Javaå†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆé™¤çº¿ç¨‹ç§æœ‰çš„ä»¥å¤–ï¼‰ã€‚<br>çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜çš„æ•°æ®ã€‚ä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œçº¿ç¨‹ä¹‹é—´å˜é‡å€¼çš„ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚</p><p><img src="/2020/06/02/JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/jmm02.jpeg" alt></p><h3 id="å†…å­˜é—´äº¤äº’æ“ä½œ"><a href="#å†…å­˜é—´äº¤äº’æ“ä½œ" class="headerlink" title="å†…å­˜é—´äº¤äº’æ“ä½œ"></a>å†…å­˜é—´äº¤äº’æ“ä½œ</h3><p>å…³äºä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´çš„äº¤äº’åè®®ï¼ŒJavaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰äº†8ç§çš„æ“ä½œã€‚</p><p>Javaè™šæ‹Ÿæœºå®ç°æ—¶å¿…é¡»ä¿è¯æ¯ç§æ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œä¸å¯å†åˆ†çš„ï¼ˆå¯¹äºdoubleå’Œlongæ¥è®²ï¼Œloadã€storeã€ã€readã€writeå…è®¸æœ‰ä¾‹å¤–ï¼‰ã€‚</p><ul><li><p>lock ï¼š é”å®šï¼Œä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çš„çŠ¶æ€ã€‚</p></li><li><p>unlock: è§£é”ï¼Œä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶ä½“çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®šã€‚</p></li><li><p>read: è¯»å–ï¼Œä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡çš„å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°å·¥ä½œå†…å­˜ï¼Œä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨ã€‚</p></li><li><p>write: å†™å…¥ï¼Œä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼å­˜æ”¾åˆ°ä¸»å†…å­˜å˜é‡ä¸­ã€‚</p></li><li><p>load: è½½å…¥ï¼Œä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠreadæ“ä½œä»ä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ã€‚</p></li><li><p>useï¼šä½¿ç”¨ï¼Œä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨å˜é‡çš„å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°†ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚</p></li><li><p>assign: èµ‹å€¼ï¼Œä½œç”¨äºå·¥ä½œå˜é‡ï¼ŒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜å˜é‡ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚</p></li><li><p>store: å­˜å‚¨ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„writeæ“ä½œä½¿ç”¨ã€‚</p></li></ul><p>Javaå†…å­˜æ¨¡å‹è§„å®šå¿…é¡»æ»¡è¶³å¦‚ä¸‹è§„åˆ™ï¼š</p><blockquote><p>1) ä¸å…è®¸read å’Œ loadã€storeå’Œwriteæ“ä½œå•ç‹¬å‡ºç°ï¼Œå³ä¸å…è®¸ä¸€ä¸ªå˜é‡ä»ä¸»å†…å­˜è¯»å–äº†ä½†å·¥ä½œå†…å­˜ä¸æ¥å—ï¼Œæˆ–è€…å·¥ä½œå†…å­˜å‘èµ·å›å†™å•ä¸»å†…å­˜ä¸æ¥å—<br>2ï¼‰ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹ä¸¢å¼ƒå®ƒæœ€è¿‘çš„assignæ“ä½œï¼Œå³å˜é‡åœ¨å·¥ä½œå†…å­˜ä¸­æ”¹å˜äº†ä¹‹åå¿…é¡»æŠŠè¯¥å˜åŒ–åŒæ­¥å›ä¸»å†…å­˜ã€‚<br>3ï¼‰ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰å‘ç”Ÿassignæ“ä½œå°±æŠŠæ•°æ®ä»çº¿ç¨‹çš„å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ä¸­ã€‚<br>4) ä¸€ä¸ªæ–°çš„å˜é‡åªèƒ½åœ¨ä¸»å†…å­˜ä¸­â€œè¯ç”Ÿâ€ï¼Œä¸å…è®¸åœ¨å·¥ä½œå†…å­˜ä¸­ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–ï¼ˆload\assignï¼‰çš„å˜é‡,å³å¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œuseä¹‹å‰å¿…é¡»ä½¿ç”¨loadï¼Œ ä½¿ç”¨storeä¹‹å‰å¿…é¡»ä½¿ç”¨assignã€‚ã€‚<br>5ï¼‰ä¸€ä¸ªå˜é‡åœ¨åŒä¸€ä¸ªæ—¶åˆ»å†…åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡Œlockæ“ä½œï¼Œ ä½†lockæ“ä½œå¯ä»¥è¢«åŒä¸€ä¸ªçº¿ç¨‹é‡å¤æ‰§è¡Œå¤šæ¬¡ï¼Œ å¤šæ¬¡æ‰§è¡Œlockåï¼Œ åªæœ‰æ‰§è¡Œç›¸åŒæ¬¡æ•°çš„unlockæ“ä½œï¼Œå˜é‡æ‰ä¼šè¢«è§£é”ã€‚<br>6)å¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œunlockä¹‹å‰ï¼Œ å¿…é¡»å…ˆæŠŠæ­¤å˜é‡åŒæ­¥å›ä¸»å†…å­˜ä¸­ï¼ˆæ‰§è¡Œstoreã€writeæ“ä½œï¼‰</p></blockquote><h3 id="volatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a href="#volatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™" class="headerlink" title="volatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a>volatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h3><p>volatileæ˜¯Javaè™šæ‹Ÿæœºæœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚å®ƒæœ‰ä¸¤ä¸ªç‰¹æ€§ï¼š<br>1ï¼‰ä¿è¯æ­¤å˜é‡å¯¹äºæ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ï¼ˆä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹ç«‹å³å¯è§ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªçº¿ç¨‹åœ¨ä½¿ç”¨è¢«volatileä¿®é¥°çš„å˜é‡æ—¶ï¼Œéƒ½ä¼šå¼ºåˆ¶ä»ä¸»å†…å­˜ä¸­åŒæ­¥è¯¥å˜é‡çš„å€¼åˆ°å·¥ä½œå†…å­˜ä¸­ï¼‰<br> åœ¨ä¸ç¬¦åˆä»¥ä¸‹ä¸¤æ¡è§„åˆ™çš„åœºæ™¯ä¸­ï¼Œä»ç„¶éœ€è¦é€šè¿‡åŠ é”æ¥ä¿è¯åŸå­æ€§ï¼ˆsynchronizedã€java.util.concurrentä¸­çš„é”æˆ–è€…åŸå­ç±»ï¼‰ï¼š</p><ul><li>è¿ç®—ç»“æœå¹¶ä¸ä¾èµ–å˜é‡çš„å½“å‰å€¼ï¼Œæˆ–è€…èƒ½å¤Ÿç¡®ä¿åªæœ‰å•ä¸€çš„çº¿ç¨‹ä¿®æ”¹å˜é‡çš„å€¼ï¼›</li><li>å˜é‡ä¸éœ€è¦ä¸å…¶ä»–çŠ¶æ€å˜é‡å…±åŒå‚ä¸ä¸å˜çº¦æŸï¼›</li></ul><p>2ï¼‰ ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–</p><p>volatileå˜é‡è¯»æ“ä½œçš„æ€§èƒ½ä¸æ™®é€šå˜é‡å‡ ä¹æ²¡æœ‰å·®åˆ«ï¼Œä½†æ˜¯å†™æ“ä½œä¼šæ…¢äº›ï¼Œ å› ä¸ºå®ƒéœ€è¦åœ¨æœ¬åœ°ä»£ç ä¸­æ’å…¥è®¸å¤šå†…å­˜å±éšœæŒ‡ä»¤æ¥ä¿è¯å¤„ç†å™¨ä¸å‘ç”Ÿä¹±åºæ‰§è¡Œã€‚</p><h4 id="Singleton-DoubleCheck"><a href="#Singleton-DoubleCheck" class="headerlink" title="Singleton DoubleCheck"></a>Singleton DoubleCheck</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line">    private Singleton() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    private volatile static Singleton instance &#x3D; null;</span><br><span class="line"></span><br><span class="line">    public static Singleton getInstance() &#123;</span><br><span class="line">        if (instance &#x3D;&#x3D; null) &#123;</span><br><span class="line">            synchronized (Singleton.class) &#123;</span><br><span class="line">                if (instance &#x3D;&#x3D; null) &#123;</span><br><span class="line">                    instance &#x3D; new Singleton(); &#x2F;&#x2F;warning</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œinstance = new Singleton()æœ€ç»ˆä¼šè¢«ç¼–è¯‘æˆå¤šæ¡æ±‡ç¼–æŒ‡ä»¤ã€‚<br>ï¼ˆ1ï¼‰ä¸ºSingletonçš„å®ä¾‹åˆ†é…å†…å­˜ã€‚<br>ï¼ˆ2ï¼‰è°ƒç”¨Singletonçš„æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æˆå‘˜å˜é‡<br>ï¼ˆ3ï¼‰å°†instanceå¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´ã€‚</p><p>æˆ–è€…å¯èƒ½è¢«é‡æ’åºä¸º(1)ã€(3)ã€ï¼ˆ2ï¼‰ï¼Œ ä¹Ÿå°±æ˜¯å½“åˆ†é…å†…å­˜åï¼Œå¦‚æœæ²¡æœ‰å¯¹instance åŠ volatileï¼Œå°†instanceå¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´åï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è¯»åˆ°æœªè¢«åˆå§‹åŒ–çš„å¯¹è±¡ã€‚</p><h3 id="é’ˆå¯¹longå’Œdoubleç±»å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a href="#é’ˆå¯¹longå’Œdoubleç±»å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™" class="headerlink" title="é’ˆå¯¹longå’Œdoubleç±»å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a>é’ˆå¯¹longå’Œdoubleç±»å‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h3><p>Javaå†…å­˜æ¨¡å‹è¦æ±‚lockã€unlockã€readã€writeã€ loadã€assignã€useã€storeè¿™8ç§æ“ä½œéƒ½å…·æœ‰åŸå­æ€§ï¼Œä½†æ˜¯å¯¹äº64ä½æ•°æ®ç±»å‹çš„long å’Œdouble, åœ¨æ¨¡å‹ä¸­å®šä¹‰äº†ä¸€æ¡å®½æ¾çš„è§„å®šï¼Œ å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢«volatileä¿®é¥°çš„64ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸º2æ¬¡32ä¸ºçš„æ“ä½œæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è™šæ‹Ÿæœºè‡ªå·±é€‰æ‹©æ˜¯å¦è¦ä¿è¯64ä½æ•°æ®ç±»å‹çš„loadã€storeã€readã€writeè¿™å››ä¸ªæ“ä½œçš„åŸå­æ€§ã€‚</p><p>ç»è¿‡å®é™…çš„æµ‹è¯•ï¼Œåœ¨ç›®å‰çš„ä¸»æµå¹³å°ä¸‹å•†ç”¨çš„64ä½Javaè™šæ‹Ÿæœºä¸­å¹¶ä¸ä¼šå‡ºç°éåŸå­æ€§è®¿é—®è¡Œä¸ºï¼Œä½†æ˜¯å¯¹äº32ä½çš„Javaè™šæ‹Ÿæœºï¼ˆå¦‚32ä½çš„X86Hotspotï¼‰å­˜åœ¨éåŸå­æ€§è®¿é—®çš„é£é™©ã€‚</p><p>å› æ­¤ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œé™¤éè¯¥æ•°æ®æœ‰æ˜ç¡®å¯çŸ¥çš„çº¿ç¨‹ç«äº‰ï¼Œå¦åˆ™æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ä¸€èˆ¬ä¸éœ€è¦å› ä¸ºè¿™ä¸ªåŸå› åˆ»æ„æŠŠç”¨åˆ°çš„longå’Œdoubleå˜é‡ä¸“é—¨å£°æ˜ä½volatileã€‚</p><h3 id="åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§"><a href="#åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§" class="headerlink" title="åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§"></a>åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§</h3><h5 id="åŸå­æ€§ï¼ˆAtomicityï¼‰"><a href="#åŸå­æ€§ï¼ˆAtomicityï¼‰" class="headerlink" title="åŸå­æ€§ï¼ˆAtomicityï¼‰"></a>åŸå­æ€§ï¼ˆAtomicityï¼‰</h5><p>æœ‰Javaå†…å­˜æ¨¡å‹æ¥ç›´æ¥ä¿è¯çš„åŸå­æ€§å˜é‡æ“ä½œåŒ…æ‹¬readã€loadã€assignã€useã€storeã€writeã€‚å› æ­¤åŸºæœ¬æ•°æ®ç±»å‹çš„è®¿é—®éƒ½æ˜¯å…·å¤‡åŸå­æ€§çš„ã€‚</p><p>å¦‚æœåº”ç”¨åœºæ™¯éœ€è¦ä¸€ä¸ªæ›´å¤§èŒƒå›´çš„ä¿è¯ï¼Œéœ€è¦ä½¿ç”¨é”ã€æˆ–è€…synchronizedå…³é”®å­—æ¥ä¿è¯åŸå­æ€§ã€‚<br>ï¼ˆlockã€unlockå¹¶æ²¡æœ‰ç›´æ¥å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨ï¼‰ã€‚</p><h5 id="å¯è§æ€§ï¼ˆvisibilityï¼‰"><a href="#å¯è§æ€§ï¼ˆvisibilityï¼‰" class="headerlink" title="å¯è§æ€§ï¼ˆvisibilityï¼‰"></a>å¯è§æ€§ï¼ˆvisibilityï¼‰</h5><p>å¯è§æ€§å°±æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼æ—¶ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ã€‚</p><h6 id="volatile"><a href="#volatile" class="headerlink" title="volatile"></a>volatile</h6><p>volatileçš„ç‰¹æ®Šè§„åˆ™ä¿è¯äº†æ–°å€¼ç«‹å³èƒ½åŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œä»¥åŠæ¯æ¬¡ä½¿ç”¨å‰éƒ½ç«‹å³ä»ä¸»å†…å­˜åˆ·æ–°ã€‚è€Œæ™®é€šå˜é‡åˆ™ä¸èƒ½ä¿è¯â€œç«‹å³â€ã€‚</p><h6 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h6><p>åŒæ­¥å—çš„å¯è§æ€§æ—¶ç”±â€œå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œunlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆæŠŠæ­¤å˜é‡åŒæ­¥å›ä¸»å†…å­˜ä¸­â€è¿™æ¡è§„åˆ™è·å¾—ã€‚</p><h6 id="final"><a href="#final" class="headerlink" title="final"></a>final</h6><p>è¢«finalä¿®é¥°çš„å­—æ®µåœ¨æ„é€ å™¨ä¸­ä¸€æ—¦è¢«åˆå§‹åŒ–å®Œæˆï¼Œå¹¶ä¸”æ„é€ å™¨æ²¡æœ‰æŠŠthisçš„å¼•ç”¨ä¼ é€’å‡ºå»ï¼Œé‚£ä¹ˆåœ¨å…¶ä»–çº¿ç¨‹ä¸­å°±èƒ½çœ‹è§finalå­—æ®µçš„å€¼ã€‚</p><blockquote><p>thiså¼•ç”¨é€ƒé€¸ï¼Œå…¶ä»–çº¿ç¨‹æœ‰å¯èƒ½é€šè¿‡è¿™ä¸ªå¼•ç”¨è®¿é—®åˆ°â€œåˆå§‹åŒ–äº†ä¸€èˆ¬â€çš„å¯¹è±¡ã€‚</p></blockquote><h5 id="æœ‰åºæ€§"><a href="#æœ‰åºæ€§" class="headerlink" title="æœ‰åºæ€§"></a>æœ‰åºæ€§</h5><p>å¦‚æœåœ¨æœ¬çº¿ç¨‹ä¸­è§‚å¯Ÿï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼ˆçº¿ç¨‹å†…ä¼¼è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰ï¼‰ï¼›<br>å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ï¼ˆæŒ‡ä»¤é‡æ’åºå’Œå·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜åŒæ­¥å»¶è¿Ÿç°è±¡ï¼‰ï¼›</p><p>Javaè¯­è¨€æä¾›äº†volatileå’Œsychronizedä¸¤ä¸ªå…³é”®å­—æ¥ä¿è¯çº¿ç¨‹ä¹‹é—´çš„æœ‰åºæ€§ã€‚<br>volatileï¼šæœ¬èº«åŒ…å«äº†ç¦ç”¨æŒ‡ä»¤é‡æ’åºçš„è¯­ä¹‰ï¼›<br>synchronizedï¼šä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡Œlockæ“ä½œï¼›</p><h3 id="å…ˆè¡Œå‘ç”ŸåŸåˆ™"><a href="#å…ˆè¡Œå‘ç”ŸåŸåˆ™" class="headerlink" title="å…ˆè¡Œå‘ç”ŸåŸåˆ™"></a>å…ˆè¡Œå‘ç”ŸåŸåˆ™</h3><p>å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼šåˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ç«äº‰ï¼Œçº¿ç¨‹æ˜¯å¦å®‰å…¨çš„é‡è¦æ‰‹æ®µã€‚</p><p>ç¨‹åºæ¬¡åºè§„åˆ™ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§æ§åˆ¶æµé¡ºåºï¼ˆåˆ†æ”¯ã€å¾ªç¯ç­‰ï¼‰ï¼Œä¹¦å†™åœ¨å‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿåœ¨ä¹¦å†™åœ¨åé¢çš„æ“ä½œï¼›</p><p>ç®¡ç¨‹é”å®šè§„åˆ™ï¼šä¸€ä¸ªunlockçš„æ“ä½œå…ˆè¡Œå‘ç”Ÿåœ¨åé¢å¯¹åŒä¸€ä¸ªé”çš„æ“ä½œã€‚</p><p>volatileå˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼›</p><p>çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šThreadå¯¹è±¡çš„startï¼ˆï¼‰æ–¹æ³•å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œï¼›</p><p>çº¿ç¨‹çš„ä¸­æ­¢è§„åˆ™ï¼šçº¿ç¨‹ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½å…ˆè¡Œå‘ç”Ÿäºæ­¤çº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹ï¼Œå¯ä»¥é€šè¿‡thread.join()æ–¹æ³•æ˜¯å¦ç»“æŸã€thread.isAlive()è¿”å›å€¼æ¥æ£€æµ‹çº¿ç¨‹æ˜¯å¦å·²ç»åœæ­¢ï¼›</p><p>çº¿ç¨‹çš„ç»ˆç«¯è§„åˆ™ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡thread.interrupted()æ£€æµ‹æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿï¼›</p><p>å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡åˆå§‹åŒ–å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰å…ˆè¡Œå‘ç”Ÿäºä»–çš„finalize()æ–¹æ³•çš„å¼€å§‹ï¼›</p><p>ä¼ é€’æ€§ï¼šå¦‚æœæ“ä½œAå…ˆè¡Œå‘ç”Ÿäºæ“ä½œBï¼Œæ“ä½œBå…ˆè¡Œå‘ç”Ÿäºæ“ä½œCï¼Œé‚£å°±å¯ä»¥å¾—å‡ºï¼Œæ“ä½œAå…ˆè¡Œå‘ç”Ÿäºæ“ä½œCã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> JMM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç±»åŠ è½½å™¨å’Œç±»åŠ è½½æœºåˆ¶</title>
      <link href="/2020/06/01/ClassLoader/"/>
      <url>/2020/06/01/ClassLoader/</url>
      
        <content type="html"><![CDATA[<p>Javaä»£ç è¦åœ¨JVMä¸­æ­£å¸¸è¿è¡Œï¼Œé¦–å…ˆè¦å…ˆç¼–è¯‘æˆ.classæ–‡ä»¶ï¼Œç”±ç±»åŠ è½½å™¨å°†å…¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä¹‹åç”±ç±»ç¼–è¯‘å™¨æ¥ç¼–è¯‘æ‰§è¡Œã€‚<br>åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿ<br>1ï¼‰ä»€ä¹ˆæ—¶å€™éœ€è¦åŠ è½½ä¸€ä¸ªç±»å‘¢ï¼Ÿ<br>2ï¼‰éšä¾¿ä»»ä½•ä¸€ä¸ªæ–‡ä»¶éƒ½æ˜¯å¦å¯ä»¥è¢«åŠ è½½å‘¢ï¼Œå®ƒçš„åŠ è½½è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ<br>3ï¼‰ç±»åŠ è½½å™¨éœ€è¦å¯¹å†…å­˜ä¸­çš„å†…å®¹åšä»€ä¹ˆå·¥ä½œæ‰å¯ä»¥è¢«JVMç›´æ¥ä½¿ç”¨ï¼Ÿ</p><blockquote><p>è™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä» Class æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Classç±»å‹ï¼Œè¿™å°±æ˜¯è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶ã€‚â€”ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç±»å‹çš„åŠ è½½ã€é“¾æ¥å’Œåˆå§‹åŒ–è¿‡ç¨‹éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å®Œæˆçš„ã€‚</span><br><span class="line">Javaå¯ä»¥åŠ¨æ€æ‰©å±•çš„è¯­è¨€ç‰¹æ€§å°±æ˜¯ä¾èµ–è¿è¡ŒæœŸåŠ¨æ€åŠ è½½å’ŒåŠ¨æ€è¿æ¥è¿™ä¸ªç‰¹ç‚¹å®ç°çš„ã€‚</span><br></pre></td></tr></table></figure><h1 id="ç±»çš„åŠ è½½æ—¶æœº"><a href="#ç±»çš„åŠ è½½æ—¶æœº" class="headerlink" title="ç±»çš„åŠ è½½æ—¶æœº"></a>ç±»çš„åŠ è½½æ—¶æœº</h1><p>  Javaè™šæ‹Ÿæœºè§„èŒƒå¹¶æ²¡æœ‰è§„å®šä»€ä¹ˆæ—¶å€™åŠ è½½ç±»ï¼Œä½†æ˜¯è§„å®šäº†ä»€ä¹ˆæ—¶å€™åˆå§‹åŒ–ä¸€ä¸ªç±»ã€‚</p><p>  è™šæ‹Ÿæœºè§„èŒƒä¸¥æ ¼è§„å®šäº†æœ‰ä¸”åªæœ‰5ä¸­æƒ…å†µå¿…é¡»ç«‹å³å¯¹ç±»è¿›è¡Œâ€œåˆå§‹åŒ–â€ã€‚<br>  1ï¼‰é‡åˆ°newã€getstaticã€putstaticã€invokestaticï¼›<br>  2ï¼‰åˆå§‹åŒ–ç±»çš„æ—¶å€™ï¼Œå¯¹çˆ¶ç±»è¿›è¡Œåˆå§‹åŒ–ï¼›<br>  3ï¼‰JVMæ‰§è¡Œçš„æ—¶å€™ï¼Œå¯¹ä¸»ç±»è¿›è¡Œåˆå§‹åŒ–ï¼›<br>  4ï¼‰ä½¿ç”¨java.lang.reflectåŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶ï¼›<br>  5ï¼‰ä½¿ç”¨jdk1.7çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ªjava.lang.invoke.MethodHandlerå®ä¾‹æœ€åè§£æç»“æœæ˜¯REF_getstatic, REF_putstatic, REF_invokestaticæ—¶ï¼Œå¯¹è¯¥ç±»è¿›è¡Œåˆå§‹åŒ–ï¼›<br>  6) jdk1.8ä¸­å­ç±»å®ç°çš„æ¥å£ä¸­å®šä¹‰äº†defaultæ–¹æ³•æ—¶ï¼›</p><h1 id="ç±»çš„åŠ è½½è¿‡ç¨‹"><a href="#ç±»çš„åŠ è½½è¿‡ç¨‹" class="headerlink" title="ç±»çš„åŠ è½½è¿‡ç¨‹"></a>ç±»çš„åŠ è½½è¿‡ç¨‹</h1><p>ç±»çš„åŠ è½½è¿‡ç¨‹æ€»å…±åˆ†ä¸ºï¼šLoadingï¼ˆåŠ è½½ï¼‰ã€Linkingï¼ˆè¿æ¥ï¼‰ã€Initializingï¼ˆåˆå§‹åŒ–ï¼‰ã€Usingï¼ˆä½¿ç”¨ï¼‰ã€Unloadingï¼ˆå¸è½½ï¼‰ã€‚<br>å…¶ä¸­ Linkingé˜¶æ®µ åˆ†ä¸º Verificationï¼ˆéªŒè¯ï¼‰ã€Preparationï¼ˆå‡†å¤‡ï¼‰ã€Resolutionï¼ˆè§£æï¼‰ã€‚</p><p><img src="/2020/06/01/ClassLoader/ClassLoader.jpeg" alt="ClassLoader"></p><h4 id="åŠ è½½"><a href="#åŠ è½½" class="headerlink" title="åŠ è½½"></a>åŠ è½½</h4><p>åŠ è½½é˜¶æ®µçš„æˆæœæ˜¯ç”ŸæˆClassç±»å¯¹è±¡ï¼Œå¹¶å°†è¯¥å¯¹è±¡å­˜å‚¨åœ¨å †ä¸­ã€‚Classå¯¹è±¡ä½œä¸ºè®¿é—®è¯¥å¯¹è±¡æ•°æ®çš„è®¿é—®å…¥å£ã€‚<br>åŠ è½½çš„æ­¥éª¤ï¼š<br>1ï¼‰ æ ¹æ®ç±»çš„å…¨é™å®šåè¯»å–ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼›<br>2ï¼‰ å¯¹äºŒè¿›åˆ¶å­—èŠ‚æµè¿›è¡Œè§£æè½¬æ¢ï¼Œå¹¶å°†ç±»ä¿¡æ¯å­˜å‚¨åœ¨æ–¹æ³•åŒºä¸­ï¼›<br>3ï¼‰ å †ä¸­ç”ŸæˆClassç±»å¯¹è±¡ï¼Œä½œä¸ºç¨‹åºè®¿é—®æ–¹æ³•åŒºä¸­çš„ç±»å‹æ•°æ®çš„å¤–éƒ¨æ¥å£ï¼›</p><blockquote><p>æ³¨æ„ï¼š<br>æ•°ç»„ç±»ä¸é€šè¿‡ç±»åŠ è½½å™¨åˆ›å»ºï¼Œç”±javaè™šæ‹Ÿæœºç›´æ¥åœ¨å†…å­˜ä¸­åŠ¨æ€æ„é€ å‡ºæ¥çš„ã€‚<br>æ•°ç»„çš„å…ƒç´ ç±»å‹ï¼ˆå»æ‰æ‰€æœ‰ç»´åº¦ï¼‰è¦é ç±»åŠ è½½å™¨åŠ è½½å®Œæˆã€‚<br>æ•°ç»„çš„ç»„ä»¶ç±»å‹ï¼ˆå»æ‰ä¸€ä¸ªç»´åº¦ï¼‰æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ•°ç»„å°†è¢«æ ‡è¯†åœ¨åŠ è½½è¯¥ç»„å»ºç±»å‹çš„ç±»åŠ è½½å™¨çš„ç±»åç§°ç©ºé—´ä¸Šã€‚<br>å¦‚æœæ•°ç»„çš„ç»„ä»¶ç±»å‹ä¸æ˜¯å¼•ç”¨ç±»å‹ï¼ŒJavaè™šæ‹Ÿæœºä¼šæŠŠæ•°ç»„æ ‡è®°ä¸ºä¸å¼•å¯¼ç±»åŠ è½½å™¨å…³è”ã€‚</p></blockquote><h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>éªŒè¯åŠ è½½çš„ç±»ä¿¡æ¯æ˜¯å¦ç¬¦åˆJavaè™šæ‹Ÿæœºè§„èŒƒï¼Œç±»çš„å®ç°å’Œç»§æ‰¿ã€æ–¹æ³•çš„æ‰§è¡Œã€å¯¹è±¡å’Œæ–¹æ³•çš„å¯è®¿é—®æ€§ç­‰ç­‰ï¼Œä¸»è¦åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š</p><p>1ï¼‰æ–‡ä»¶æ ¼å¼çš„éªŒè¯<br>   ä¸»è¦å¯¹Classæ–‡ä»¶ä¸­å†…å®¹è¿›è¡ŒéªŒè¯ï¼Œæ˜¯å¦ç¬¦åˆJavaè™šæ‹Ÿæœºè§„èŒƒã€‚<br>   æ¯”å¦‚é­”æ•°ã€å¸¸é‡æ± çš„ç±»å‹ã€æŒ‡å‘å¸¸é‡çš„ç´¢å¼•å€¼æ˜¯å¦å­˜åœ¨æˆ–è€…ç±»å‹æ˜¯å¦æ­£ç¡®ç­‰ç­‰ï¼›</p><blockquote><p>è¿™ä¸ªé˜¶æ®µçš„éªŒè¯æ˜¯åŸºäºäºŒè¿›åˆ¶å­—èŠ‚æµè¿›è¡Œçš„ï¼Œåªæœ‰é€šè¿‡äº†éªŒè¯æ‰ä¼šè¢«å…è®¸è¿›å…¥Javaè™šæ‹Ÿæœºçš„å†…å­˜æ–¹æ³•åŒºå­˜å‚¨ã€‚</p></blockquote><p>2ï¼‰å…ƒæ•°æ®éªŒè¯<br>   å¯¹å­—èŠ‚ç æè¿°ä¿¡æ¯è¿›è¡Œè¯­ä¹‰åˆ†æï¼Œä¿è¯æè¿°ä¿¡æ¯ç¬¦åˆã€ŠJavaè¯­è¨€è§„èŒƒã€‹æ¯”å¦‚:</p><ul><li>è¿™ä¸ªç±»æ˜¯å¦æœ‰çˆ¶ç±»ã€çˆ¶ç±»æ˜¯å¦å…è®¸ç»§æ‰¿ï¼ˆè¢«finalä¿®é¥°ï¼‰ï¼›</li><li>è¿™ä¸ªç±»æ˜¯å¦å®ç°äº†çˆ¶ç±»æ‰€è¦æ±‚å®ç°çš„æ‰€æœ‰æ–¹æ³•ï¼›</li><li>ç±»ä¸­çš„å­—æ®µã€æ–¹æ³•æ˜¯å¦ä¸çˆ¶ç±»äº§ç”ŸçŸ›ç›¾ï¼›</li></ul><p>3ï¼‰å­—èŠ‚ç éªŒè¯<br>   å¯¹ç±»çš„æ–¹æ³•ä½“è¿›è¡ŒéªŒè¯ï¼Œä¿è¯ä»»ä½•è·³è½¬æŒ‡ä»¤éƒ½ä¸ä¼šè·³è½¬åˆ°æ–¹æ³•ä½“ä»¥å¤–çš„å­—èŠ‚ç æŒ‡ä»¤ä¸Šï¼›<br>   ä¿è¯ç±»å‹è½¬åŒ–éƒ½æ˜¯æœ‰æ•ˆçš„.</p><p>4ï¼‰ç¬¦å·å¼•ç”¨éªŒè¯</p><blockquote><p>è™šæ‹Ÿæœºåœ¨è§£æé˜¶æ®µå°†ç¬¦å·å¼•ç”¨è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨çš„æ—¶å€™ï¼Œå¯¹ç¬¦å·å¼•ç”¨è¿›è¡ŒéªŒè¯ï¼›</p></blockquote><ul><li>ç¬¦å·å¼•ç”¨ä¸­é€šè¿‡å­—ç¬¦ä¸²æè¿°çš„å…¨é™å®šåèƒ½å¦æ‰¾åˆ°å¯¹åº”çš„ç±»ï¼›</li><li>åœ¨æŒ‡å®šç±»ä¸­æ˜¯å¦å­˜åœ¨ç¬¦åˆæ–¹æ³•çš„å­—æ®µæè¿°ä»¥åŠç®€å•åç§°æ‰€æè¿°çš„æ–¹æ³•å’Œå­—æ®µï¼›</li><li>ç¬¦å·å¼•ç”¨ä¸­çš„ç±»ã€å­—æ®µã€æ–¹æ³•çš„å¯è®¿é—®æ€§æ˜¯å¦å¯ä»¥è¢«å½“å‰ç±»è®¿é—®ï¼›</li></ul><p>ç¬¦å·å¼•ç”¨é˜¶æ®µæŠ›å‡ºçš„å¼‚å¸¸æœ‰ï¼šIllegalAccessErrorã€NoSuchFieldErrorã€NoSuchMethodErrorï¼›</p><h4 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h4><p>å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºç±»ä¸­å®šä¹‰çš„å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µï¼›</p><p>å¯¹äºç±»å˜é‡ï¼ˆé™æ€å±æ€§ï¼‰ï¼Œè®¾ç½®çš„æ˜¯â€œé›¶å€¼â€ï¼ŒçœŸæ­£èµ‹å€¼æ˜¯åœ¨åˆå§‹åŒ–é˜¶æ®µï¼›<br>å¯¹äºå¸¸é‡ï¼ˆfinal staticï¼‰ï¼Œä¼šè¢«è®¾ç½®ä¸ºConstantValueå±æ€§æ‰€æŒ‡å®šçš„åˆå§‹å€¼ã€‚</p><blockquote><p>å¯¹äºå¸¸é‡ï¼ŒJavacæ—¶ä¼šä¸ºvalueç”ŸæˆConstantValueå±æ€§ã€‚</p></blockquote><h4 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>è§£æé˜¶æ®µæ˜¯Javaè™šæ‹Ÿæœºå°†å¸¸é‡æ± çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹å¹¶æ²¡æœ‰è§„å®šä½•æ—¶è¿›è¡Œè§£æã€‚</p><ul><li>ç¬¦å·å¼•ç”¨ï¼šå¯ä»¥æ— æ­§ä¹‰çš„å®šä½åˆ°ç›®æ ‡å³å¯ï¼›ä¸è™šæ‹Ÿæœºçš„å†…å­˜å¸ƒå±€æ— å…³ï¼›å¼•ç”¨çš„ç›®æ ‡ä¸ä¸€å®šå·²ç»åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­ï¼›å¿…é¡»éµå¾ªã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒã€‹ï¼›</li><li>ç›´æ¥å¼•ç”¨ï¼šç›´æ¥å¯ä»¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€åç§»é‡ï¼Œæˆ–è€…å¯ä»¥é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ï¼›ä¸è™šæ‹Ÿæœºçš„å†…å­˜å¸ƒå±€ç›´æ¥ç›¸å…³ï¼›ç›´æ¥å¼•ç”¨çš„ç›®æ ‡ä¸€å®šå·²ç»åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­ï¼›</li></ul><p>è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–è€…æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ã€æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦å·å¼•ç”¨è¿›è¡Œã€‚</p><h5 id="ç±»ã€æ¥å£è§£æï¼š"><a href="#ç±»ã€æ¥å£è§£æï¼š" class="headerlink" title="ç±»ã€æ¥å£è§£æï¼š"></a>ç±»ã€æ¥å£è§£æï¼š</h5><p>è™šæ‹Ÿæœºçš„å®Œæ•´è§£æè¿‡ç¨‹ï¼š<br>1ï¼‰å¦‚æœä¸æ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œè™šæ‹Ÿæœºå°†ä¼šæŠŠå…¨é™å®šåä¼ ç»™å½“å‰ç±»çš„åŠ è½½å™¨å»åŠ è½½ï¼Œåœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œç”±äºå…ƒæ•°æ®éªŒè¯ã€å­—èŠ‚ç éªŒè¯çš„éœ€è¦ï¼Œåˆå¯èƒ½å‡ºå‘å…¶ä»–ç›¸å…³ç±»çš„åŠ è½½åŠ¨ä½œã€‚<br>2ï¼‰å¦‚æœæ˜¯ä¸€ä¸ªæ•°ç»„ç±»å‹ï¼Œå¹¶ä¸”æ•°ç»„çš„å…ƒç´ ç±»å‹ä¸ºå¯¹è±¡ï¼Œé‚£ä¹ˆä¼šæŒ‰ç…§ç¬¬ä¸€ç‚¹çš„è§„åˆ™åŠ è½½æ•°ç»„å…ƒç´ ç±»å‹ã€‚å¦‚æœæ˜¯åŸºç¡€æ•°æ®ç±»å‹åŒ…è£…ç±»ï¼Œé‚£ä¹ˆç”±è™šæ‹Ÿæœºç”Ÿæˆä¸€ä¸ªä»£è¡¨è¯¥æ•°ç»„å”¯ç‹¬å’Œå…ƒç´ çš„æ•°ç»„å¯¹è±¡ï¼›<br>3ï¼‰å‰é¢ä¸¤éƒ¨è§£æOKåè¿›è¡Œç¬¦å·å¼•ç”¨éªŒè¯ï¼Œç¡®å®šå½“å‰ç±»æ˜¯å¦æœ‰åŠ è½½ç±»çš„è®¿é—®æƒé™ã€‚</p><p>å¦‚æœä¸€ä¸ªç±»æ‹¥æœ‰å¦å¤–ä¸€ä¸ªç±»çš„è®¿é—®æƒé™ï¼Œé‚£ä¹ˆè‡³å°‘æœ‰ä¸€æ¡æ˜¯æˆç«‹çš„ï¼š<br>1ï¼‰è¢«è®¿é—®ç±»æ˜¯publicçš„ï¼Œå¹¶ä¸”ä¸è®¿é—®ç±»å¤„äºåŒä¸€ä¸ªæ¨¡å—ï¼›<br>2ï¼‰è¢«è®¿é—®ç±»æ˜¯publicçš„ï¼Œä¸ä¸è®¿é—®ç±»å¤„äºåŒä¸€ä¸ªæ¨¡å—ï¼Œä½†æ˜¯è¢«è®¿é—®ç±»çš„æ¨¡å—å…è®¸è®¿é—®ç±»è®¿é—®ï¼›<br>3ï¼‰è¢«è®¿é—®ç±»ä¸æ˜¯publicçš„ï¼Œä½†æ˜¯ä¸è®¿é—®ç±»å¤„äºåŒä¸€ä¸ªåŒ…ä¸­</p><h5 id="å­—æ®µè§£æ"><a href="#å­—æ®µè§£æ" class="headerlink" title="å­—æ®µè§£æ"></a>å­—æ®µè§£æ</h5><p>å¯¹å­—æ®µè¡¨å†…class_indexé¡¹ä¸­ç´¢å¼•çš„CONSTANT_Class_Infoç¬¦å·å¼•ç”¨è¿›è¡Œè§£æï¼ˆå³å­—æ®µæ‰€å±ç±»ï¼‰</p><p>1ï¼‰å…ˆæŸ¥æ‰¾å½“å‰ç±»æ˜¯å¦åŒ…å«äº†ç®€å•åç§°ä¸æè¿°ç¬¦ä¸ç›®æ ‡ç›¸åŒ¹é…<br>2ï¼‰ä»ä¸‹å¾€ä¸Šçš„é¡ºåºæŸ¥æ‰¾å®ç°çš„æ¥å£ç±»<br>3ï¼‰ä»ä¸‹å¾€ä¸Šçš„é¡ºåºæŸ¥æ‰¾çˆ¶ç±»<br>4ï¼‰éƒ½æ— æ³•æŸ¥æ‰¾åˆ°ï¼ŒæŠ›å‡ºjava.lang.NoSuchFieldError.</p><p>å¦‚æœæŸ¥æ‰¾æˆæœè¿”å›äº†å¼•ç”¨ï¼Œå°†ä¼šå¯¹è¿™ä¸ªå­—æ®µè¿›è¡Œæƒé™éªŒè¯ï¼Œå¯¹äºä¸å…·å¤‡æƒé™çš„è®¿é—®ä¼šæŠ›å‡ºIllegalAccessErrorï¼›</p><h5 id="æ–¹æ³•è§£æ"><a href="#æ–¹æ³•è§£æ" class="headerlink" title="æ–¹æ³•è§£æ"></a>æ–¹æ³•è§£æ</h5><p>è§£æå‡ºæ–¹æ³•è¡¨class_indexé¡¹ä¸­ç´¢å¼•çš„æ–¹æ³•æ‰€å±çš„ç±»æˆ–è€…æ¥å£çš„ç¬¦å·å¼•ç”¨ã€‚<br>å…·ä½“çš„è§£æè¿‡ç¨‹ä¸å­—æ®µè§£æç±»ä¼¼ã€‚</p><h5 id="æ¥å£æ–¹æ³•è§£æ"><a href="#æ¥å£æ–¹æ³•è§£æ" class="headerlink" title="æ¥å£æ–¹æ³•è§£æ"></a>æ¥å£æ–¹æ³•è§£æ</h5><p>ä¸æ–¹æ³•è§£æç±»ä¼¼ã€‚</p><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><p>è¿™ä¸ªé˜¶æ®µJavaè™šæ‹Ÿæœºæ‰çœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­ç¼–å†™çš„ç¨‹åºä»£ç ã€‚ç¨‹åºåœ¨è¿™ä¸ªé˜¶æ®µåˆå§‹åŒ–ç±»å˜é‡å’Œå…¶ä»–èµ„æºã€‚</p><p>åˆå§‹åŒ–é˜¶æ®µä¹Ÿæ˜¯æ‰§è¡Œ&lt;clinit&gt;()çš„è¿‡ç¨‹ã€‚<br>&lt;clinit&gt;()æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ï¼›<br>ç¼–è¯‘å™¨æ”¶é›†é¡ºåºæ˜¯ç”±è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºå†³å®šçš„ï¼›<br>é™æ€è¯­å¥å—ä¸­æ™ºèƒ½è®¿é—®åˆ°å®šä¹‰åœ¨é™æ€è¯­å¥å—ä¹‹å‰çš„å˜é‡ï¼›<br>å®šä¹‰åœ¨é™æ€è¯­å¥å—åçš„å˜é‡ï¼Œé™æ€è¯­å¥å—å¯ä»¥èµ‹å€¼ï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®ï¼›<br>Javaè™šæ‹Ÿæœºä¿è¯çˆ¶ç±»çš„&lt;clinit&gt;() æ€»æ˜¯ä¼˜å…ˆäºå­ç±»çš„&lt;clinit&gt;()æ‰§è¡Œï¼›</p><blockquote><p>å¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰é™æ€è¯­å¥å—ï¼Œä¹Ÿæ²¡æœ‰å¯¹å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¿™ä¸ªç±»ç”Ÿæˆclinit()æ–¹æ³•ã€‚</p></blockquote><h1 id="ç±»åŠ è½½å™¨"><a href="#ç±»åŠ è½½å™¨" class="headerlink" title="ç±»åŠ è½½å™¨"></a>ç±»åŠ è½½å™¨</h1><p>ç±»åŠ è½½å™¨ä¸»è¦é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–æè¿°è¯¥ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼Œå®ƒå¤„äºJavaè™šæ‹Ÿæœºçš„å¤–éƒ¨ï¼Œæ–¹ä¾¿è®©åº”ç”¨ç¨‹åºè‡ªå·±å†³å®šå¦‚ä½•è·å–æ‰€éœ€çš„ç±»ã€‚</p><p>å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œå¿…é¡»ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨ä¸ç±»æœ¬èº«æ¥ç¡®å®šåœ¨Javaè™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§ã€‚<br>æ¯ä¸ªç±»åŠ è½½å™¨éƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»åç§°ç©ºé—´ã€‚</p><h3 id="ç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹"><a href="#ç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹" class="headerlink" title="ç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹"></a>ç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹</h3><p><img src="/2020/06/01/ClassLoader/ClassLoader02.webp" alt="åŒäº²å§”æ´¾æ¨¡å‹"></p><p>åŒäº²å§”æ´¾æ¨¡å‹è¦æ±‚é™¤äº†é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ä¹‹å¤–ï¼Œå…¶ä½™çš„ç±»åŠ è½½å™¨éƒ½åº”æœ‰è‡ªå·±çš„çˆ¶â€œç±»åŠ è½½å™¨â€ã€‚<br>å½“ç±»åŠ è½½å™¨éœ€è¦åŠ è½½ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œé¦–å…ˆçœ‹è¯¥ç±»æ˜¯å¦å·²ç»è¢«åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰è¢«åŠ è½½åˆ™å°è¯•ç€è®©çˆ¶â€œç±»åŠ è½½å™¨â€å»åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰çˆ¶â€œç±»åŠ è½½å™¨â€åˆ™è®©bootstrapClassLoaderä½œä¸ºçˆ¶â€œç±»åŠ è½½å™¨â€ï¼Œå¦‚æœçˆ¶â€œç±»åŠ è½½å™¨â€åŠ è½½å¤±è´¥ï¼Œåˆ™ä½¿ç”¨è‡ªå·±çš„find_classæ–¹æ³•å»åŠ è½½ã€‚</p><ul><li>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap Class Loaderï¼‰<br>å¯åŠ¨ç±»åŠ è½½å™¨è´Ÿè´£åŠ è½½&lt;JAVA_HOME&gt;\lib ç›®å½•ä¸‹çš„jaråŒ…ï¼ˆæŒ‰åå­—è¯†åˆ«ï¼Œåå­—ä¸ç¬¦åˆçš„ç±»åº“å­˜æ”¾åœ¨libç›®å½•ä¸‹ä¹Ÿä¸ä¼šè¢«åŠ è½½ï¼‰ï¼Œä¹Ÿå¯ä»¥æŒ‡å®š -Xbootclasspathå‚æ•°æŒ‡å®šåŠ è½½ç›®å½•ã€‚å¯åŠ¨ç±»åŠ è½½å™¨æ— æ³•è¢«javaç¨‹åºç›´æ¥å¼•ç”¨ã€‚</li><li>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension Class Loaderï¼‰<br>æ‰©å±•ç±»åŠ è½½å™¨è´Ÿè´£åŠ è½½&lt;JAVA_HOME&gt;\lib\extç›®å½•ä¸‹çš„jaråŒ…ï¼Œæˆ–è€…è¢«java.ext.dirsæŒ‡å®šçš„è·¯å¾„è¿™ç§çš„æ‰€æœ‰ç±»åº“ã€‚è¿™ä¸ªç±»åŠ è½½å™¨æ˜¯åœ¨ç±»sun.misc.Launcher$ExtClassLoaderä¸­ä»¥Javaä»£ç å®ç°çš„ã€‚</li><li>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication Class Loaderï¼‰<br>è´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ä¸Šçš„æ‰€æœ‰ç±»åº“ã€‚è¿™ä¸ªç±»åŠ è½½å™¨æ˜¯åœ¨sun.misc.Launcher$AppClassLoaderå®ç°ã€‚</li></ul><h5 id="å®šåˆ¶è‡ªå·±çš„ç±»åŠ è½½å™¨"><a href="#å®šåˆ¶è‡ªå·±çš„ç±»åŠ è½½å™¨" class="headerlink" title="å®šåˆ¶è‡ªå·±çš„ç±»åŠ è½½å™¨"></a>å®šåˆ¶è‡ªå·±çš„ç±»åŠ è½½å™¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomClassLoader</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomClassLoader</span><span class="params">(ClassLoader parent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(parent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line"></span><br><span class="line">        String path = <span class="string">"/classes/"</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            InputStream ins = <span class="keyword">new</span> FileInputStream(path + name.replace(<span class="string">"."</span>, File.separator) + <span class="string">".class"</span>);</span><br><span class="line">            ByteArrayOutputStream baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            <span class="keyword">int</span> bufferSize = <span class="number">4096</span>;</span><br><span class="line">            <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[bufferSize];</span><br><span class="line">            <span class="keyword">int</span> bytesNumRead = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((bytesNumRead = ins.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                baos.write(buffer, <span class="number">0</span>, bytesNumRead);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">byte</span>[] classData = baos.toByteArray();</span><br><span class="line">            <span class="keyword">return</span> defineClass(name, classData, <span class="number">0</span>, classData.length);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        CustomClassLoader classLoader = <span class="keyword">new</span> CustomClassLoader(<span class="keyword">null</span>);</span><br><span class="line">        Class clazz = classLoader.loadClass(<span class="string">"com.*.ClassLoader"</span>);</span><br><span class="line">        System.out.println(clazz.getClassLoader());</span><br><span class="line">        System.out.println(clazz.getClass());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> ClassLoader </tag>
            
            <tag> ç±»åŠ è½½æœºåˆ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç±»æ–‡ä»¶ç»“æ„</title>
      <link href="/2020/05/29/%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/"/>
      <url>/2020/05/29/%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<p>Javaè™šæ‹Ÿæœºè§„èŒƒè§„å®šClassæ–‡ä»¶æ ¼å¼ç»Ÿä¸€é‡‡ç”¨ä¸€ç§ç±»ä¼¼äºCè¯­è¨€ç»“æ„ä½“çš„ä¼ªç»“æ„ä½“æ¥å­˜å‚¨æ•°æ®ï¼Œ<br>è¿™ç§ä¼ªç»“æ„ä½“å­˜å‚¨ä¸¤ç§æ•°æ®ç±»å‹ï¼šæ— ç¬¦å·æ•°å’Œè¡¨ã€‚</p><p>æ— ç¬¦å·æ•°ï¼šå±äºåŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä»¥u1ã€u2ã€u4ã€u8åˆ†åˆ«ä»£è¡¨1ä¸ªå­—èŠ‚ã€2ä¸ªå­—èŠ‚ã€4ä¸ªå­—èŠ‚ã€8ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•°ï¼Œæ— ç¬¦å·æ•°å¯ä»¥ç”¨æ¥æè¿°æ•°å­—ã€ç´¢å¼•å¼•ç”¨ã€æ•°é‡å€¼æˆ–è€…æŒ‰ç…§UTF-8ç¼–ç ç»“æ„æ„æˆçš„å­—ç¬¦ä¸²å€¼ã€‚</p><p>è¡¨ï¼šç”±å¤šä¸ªæ— ç¬¦å·æ•°æˆ–è€…å…¶ä»–è¡¨ä½œä¸ºæ•°æ®é¡¹æ„æˆçš„ç¬¦åˆæ•°æ®ç±»å‹ï¼Œæ‰€ä»¥è¡¨éƒ½ä¹ æƒ¯æ€§åœ°ä»¥_infoç»“å°¾ã€‚<br>è¡¨ç”¨äºæè¿°æœ‰å±‚æ¬¡å…³ç³»çš„ç¬¦åˆç»“æ„çš„æ•°æ®ï¼Œæ•´ä¸ªClassæ–‡ä»¶å°±æ˜¯ä¸€å¼ è¡¨ï¼Œç”±ä¸‹è¡¨ä¸­æ•°æ®é¡¹æ„æˆã€‚</p><table><thead><tr><th>ç±»å‹</th><th>åç§°</th><th>ä¸ªæ•°</th></tr></thead><tbody><tr><td>u4</td><td>Magic</td><td>1</td></tr><tr><td>u2</td><td>minor_version</td><td>1</td></tr><tr><td>u2</td><td>major_version</td><td>1</td></tr><tr><td>u2</td><td>constant_pool_count</td><td>1</td></tr><tr><td>cp_info</td><td>constant_pool</td><td>constant_pool_count - 1</td></tr><tr><td>u2</td><td>access_flag</td><td>1</td></tr><tr><td>u2</td><td>this_class</td><td>1</td></tr><tr><td>u2</td><td>super_class</td><td>1</td></tr><tr><td>u2</td><td>interface_count</td><td>1</td></tr><tr><td>u2</td><td>interfaces</td><td>interface_count</td></tr><tr><td>u2</td><td>fields_count</td><td>1</td></tr><tr><td>field_info</td><td>fields</td><td>fields_count</td></tr><tr><td>u2</td><td>method_count</td><td>1</td></tr><tr><td>method_info</td><td>methods</td><td>methods_count</td></tr><tr><td>u2</td><td>attributes_count</td><td>1</td></tr><tr><td>attribute_info</td><td>attributes</td><td>attributes_count</td></tr></tbody></table><h4 id="é­”æ•°"><a href="#é­”æ•°" class="headerlink" title="é­”æ•°"></a>é­”æ•°</h4><p>æ¯ä¸ªClassæ–‡ä»¶çš„å¤´å››ä¸ªå­—èŠ‚ç§°ä¸ºé­”æ•°ï¼Œå…¶å€¼çš„16è¿›åˆ¶è¡¨ç¤ºä¸º0xCAFEBABEï¼ˆæ¢ç®—ä¸ºäºŒè¿›åˆ¶ä¸º1100 1010 1111 1110 1011 1010 1011 1110ï¼‰ï¼Œè™šæ‹Ÿæœºåœ¨åŠ è½½ç±»æ—¶åˆ†æè¯¥æ–‡ä»¶æ˜¯å¦ä¸ºClassæ–‡ä»¶ã€‚</p><h4 id="ç‰ˆæœ¬å·"><a href="#ç‰ˆæœ¬å·" class="headerlink" title="ç‰ˆæœ¬å·"></a>ç‰ˆæœ¬å·</h4><p>ç¬¬5ã€6ä¸ªå­—èŠ‚è¡¨ç¤ºæ¬¡ç‰ˆæœ¬å·ã€‚ç¬¬7ã€8ä¸ªå­—èŠ‚è¡¨ç¤ºä¸»ç‰ˆæœ¬å·ã€‚<br>é«˜ç‰ˆæœ¬çš„JDKèƒ½å¤Ÿå‘ä¸‹å…¼å®¹ä½ç‰ˆæœ¬çš„Classæ–‡ä»¶ï¼Œè™šæ‹Ÿæœºä¼šæ‹’ç»æ‰§è¡Œè¶…è¿‡å…¶ç‰ˆæœ¬çš„Classæ–‡ä»¶ã€‚</p><h4 id="å¸¸é‡æ± "><a href="#å¸¸é‡æ± " class="headerlink" title="å¸¸é‡æ± "></a>å¸¸é‡æ± </h4><p>å¸¸é‡æ± ä¸­å­˜æ”¾ä¸¤å¤§ç±»å¸¸é‡ï¼š</p><ul><li>å­—é¢é‡å¸¸é‡ï¼š<br>æ¯”è¾ƒæ¥è¿‘Javaè¯­è¨€å±‚é¢çš„å¸¸é‡æ¦‚å¿µï¼Œæ¯”å¦‚å­—ç¬¦ä¸²å’Œè¢«å£°æ˜ä¸ºfinalçš„å¸¸é‡å€¼ã€‚å¯¹äºèŒƒå›´åœ¨-127ï½128ä¹‹é—´çš„åŒ…è£…ç±»å‹ä¹Ÿæ˜¯å¸¸é‡ã€‚</li><li>ç¬¦å·å¼•ç”¨å¸¸é‡ï¼šå±äºç¼–è¯‘åŸç†æ–¹é¢çš„æ¦‚å¿µï¼ŒåŒ…å«<ol><li>ç±»å’Œæ¥å£çš„å…¨é™å®šå</li><li>å­—æ®µçš„åç§°å’Œæè¿°ç¬¦</li><li>æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦</li></ol></li></ul><p>å¸¸é‡æ± çš„å¤§å°ä¸å›ºå®šï¼Œç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œç¬¬é›¶é¡¹ç©ºå‡ºæ¥ï¼Œä¸ºäº†æ»¡è¶³æŸäº›æŒ‡å‘å¸¸é‡æ± çš„ç´¢å¼•å€¼çš„æ•°æ®â€œä¸å¼•ç”¨ä»»ä½•ä¸€ä¸ªå¸¸é‡æ± é¡¹ç›®â€ã€‚</p><p>å¸¸é‡æ± çš„æ¯ä¸€é¡¹å¸¸é‡éƒ½æ˜¯ä¸€ä¸ªè¡¨ï¼Œè¿™ä¸ªè¡¨çš„ç¬¬ä¸€ä½éƒ½æ˜¯ä¸€ä¸ªu1ç±»å‹çš„æ ‡è¯†ä½ã€‚</p><p>ä¸‹é¢æ˜¯å¸¸é‡æ± ä¸­çš„14ç§é¡¹ç›®ç±»å‹ï¼š<br><img src="/2020/05/29/%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/14kindsofconstants.webp" alt="å¸¸é‡æ± ä¸­çš„14ç§é¡¹ç›®ç±»å‹"></p><p>ä¸‹é¢æ˜¯å¸¸é‡æ± ä¸­çš„14ç§é¡¹ç›®ç±»å‹çš„ç»“æ„è¡¨ï¼š</p><p><img src="/2020/05/29/%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/14kindsofconstantsdetail1.webp" alt="å¸¸é‡æ± ä¸­çš„è¡¨ç±»å‹"></p><p><img src="/2020/05/29/%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/14kindsofconstantsdetail2.webp" alt="å¸¸é‡æ± ä¸­çš„è¡¨ç±»å‹"></p><table><thead><tr><th>å¸¸é‡æ± ä¸­æ•°æ®é¡¹ç±»å‹</th><th>ç±»å‹æ ‡å¿—</th><th>ç±»å‹æè¿°</th></tr></thead><tbody><tr><td>CONSTANT_Utf8</td><td>1</td><td>UTF-8ç¼–ç çš„Unicodeå­—ç¬¦ä¸²</td></tr><tr><td>CONSTANT_Integer</td><td>3</td><td>intç±»å‹å­—é¢å€¼</td></tr><tr><td>CONSTANT_Float</td><td>4</td><td>floatç±»å‹å­—é¢å€¼</td></tr><tr><td>CONSTANT_Long</td><td>5</td><td>longç±»å‹å­—é¢å€¼</td></tr><tr><td>CONSTANT_Double</td><td>6</td><td>doubleç±»å‹å­—é¢å€¼</td></tr><tr><td>CONSTANT_Class</td><td>7</td><td>å¯¹ä¸€ä¸ªç±»æˆ–æ¥å£çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td>CONSTANT_String</td><td>8</td><td>Stringç±»å‹å­—é¢å€¼</td></tr><tr><td>CONSTANT_Fieldref</td><td>9</td><td>å¯¹ä¸€ä¸ªå­—æ®µçš„ç¬¦å·å¼•ç”¨</td></tr><tr><td>CONSTANT_Methodref</td><td>10</td><td>å¯¹ä¸€ä¸ªç±»ä¸­å£°æ˜çš„æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td>CONSTANT_InterfaceMethodref</td><td>11</td><td>å¯¹ä¸€ä¸ªæ¥å£ä¸­å£°æ˜çš„æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td></tr><tr><td>CONSTANT_NameAndType</td><td>12</td><td>å¯¹ä¸€ä¸ªå­—æ®µæˆ–æ–¹æ³•çš„éƒ¨åˆ†ç¬¦å·å¼•ç”¨</td></tr></tbody></table><h4 id="è®¿é—®æ ‡å¿—"><a href="#è®¿é—®æ ‡å¿—" class="headerlink" title="è®¿é—®æ ‡å¿—"></a>è®¿é—®æ ‡å¿—</h4><p>è®¿é—®æ ‡å¿—æ ‡ç¤ºäº†å½“å‰ç±»çš„ä¿®é¥°ç¬¦ï¼Œæ¯”å¦‚ public / final / super / interface /  enum / abstract / annotation / synthetic</p><table><thead><tr><th>æ ‡å¿—åç§°</th><th>æ ‡å¿—å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ACC_PUBLIC</td><td>0x00 01</td><td>æ˜¯å¦ä¸ºPublicç±»å‹</td></tr><tr><td>ACC_FINAL</td><td>0x00 10</td><td>æ˜¯å¦è¢«å£°æ˜ä¸ºfinalï¼Œåªæœ‰ç±»å¯ä»¥è®¾ç½®</td></tr><tr><td>ACC_SUPER</td><td>0x00 20</td><td>æ˜¯å¦å…è®¸ä½¿ç”¨invokespecialå­—èŠ‚ç æŒ‡ä»¤çš„æ–°è¯­ä¹‰ï¼</td></tr><tr><td>ACC_INTERFACE</td><td>0x02 00</td><td>æ ‡å¿—è¿™æ˜¯ä¸€ä¸ªæ¥å£</td></tr><tr><td>ACC_ABSTRACT</td><td>0x04 00</td><td>æ˜¯å¦ä¸ºabstractç±»å‹ï¼Œå¯¹äºæ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥è¯´ï¼Œæ¬¡æ ‡å¿—å€¼ä¸ºçœŸï¼Œå…¶ä»–ç±»å‹ä¸ºå‡</td></tr><tr><td>ACC_SYNTHETIC</td><td>0x10 00</td><td>æ ‡å¿—è¿™ä¸ªç±»å¹¶éç”±ç”¨æˆ·ä»£ç äº§ç”Ÿ</td></tr><tr><td>ACC_ANNOTATION</td><td>0x20 00</td><td>æ ‡å¿—è¿™æ˜¯ä¸€ä¸ªæ³¨è§£</td></tr><tr><td>ACC_ENUM</td><td>ï¼x40 00</td><td>æ ‡å¿—è¿™æ˜¯ä¸€ä¸ªæšä¸¾</td></tr></tbody></table><h4 id="ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ"><a href="#ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ" class="headerlink" title="ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ"></a>ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ã€æ¥å£ç´¢å¼•é›†åˆ</h4><ul><li>ç±»ç´¢å¼•ï¼šthis_class, ç”¨äºç¡®å®šè¿™ä¸ªç±»çš„å…¨é™å®šå</li><li>çˆ¶ç±»ç´¢å¼•ï¼šsuper_class, çˆ¶ç±»ç´¢å¼•ç”¨äºç¡®å®šè¿™ä¸ªç±»çš„çˆ¶ç±»çš„å…¨é™å®šå</li><li>æ¥å£ç´¢å¼•é›†åˆï¼šinterfaces, ç”¨äºæè¿°è¿™ä¸ªç±»å®ç°äº†å“ªäº›æ¥å£</li></ul><h4 id="å­—æ®µè¡¨é›†åˆ"><a href="#å­—æ®µè¡¨é›†åˆ" class="headerlink" title="å­—æ®µè¡¨é›†åˆ"></a>å­—æ®µè¡¨é›†åˆ</h4><p>å­—æ®µè¡¨é›†åˆï¼ˆfield_infoï¼‰ç”¨äºæè¿°æ¥å£æˆ–è€…ç±»ä¸­å£°æ˜çš„å˜é‡ï¼ŒåŒ…å«ç±»å˜é‡å’Œå®ä¾‹å˜é‡ï¼Œä½†ä¸åŒ…å«æ–¹æ³•å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡ã€‚</p><p>|ç±»å‹|åç§°|æ•°é‡|<br>|â€”-|â€”-|â€”-|â€”-|<br>|u2 |access_flag|1|è®¿é—®ä¿®é¥°ç¬¦|<br>|u2 |name_index | 1| å­—æ®µçš„ç®€å•åç§°,å¦‚String str = â€œ123â€, strå°±æ˜¯ç®€å•åç§°|<br>|u2 |descritpor_index|1| å­—æ®µæˆ–è€…æ–¹æ³•çš„æè¿°ç¬¦|<br>|u2 |attributes_count |1 |  |<br>|attribute_info | attributes | attributes_count| |</p><p>è®¿é—®ä¿®é¥°ç¬¦</p><table><thead><tr><th>æ ‡å¿—åç§°</th><th>æ ‡å¿—å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ACC_PUBLIC</td><td>0x0001</td><td>å­—æ®µæ˜¯å¦ä¸ºpublic</td></tr><tr><td>ACC_PRIVATE</td><td>0x0002</td><td>å­—æ®µæ˜¯å¦ä¸ºprivate</td></tr><tr><td>ACC_PROTECTED</td><td>0x0004</td><td>å­—æ®µæ˜¯å¦ä¸ºprotected</td></tr><tr><td>ACC_STATIC</td><td>0x0008</td><td>å­—æ®µæ˜¯å¦ä¸ºstatic</td></tr><tr><td>ACC_FINAL</td><td>0x0010</td><td>å­—æ®µæ˜¯å¦ä¸ºfinal</td></tr><tr><td>ACC_VOLATILE</td><td>0x0040</td><td>å­—æ®µæ˜¯å¦ä¸ºvolatile</td></tr><tr><td>ACC_TRANSTENT</td><td>0x0080</td><td>å­—æ®µæ˜¯å¦ä¸ºtransient</td></tr><tr><td>ACC_SYNCHETIC</td><td>0x1000</td><td>å­—æ®µæ˜¯å¦ä¸ºç”±ç¼–è¯‘å™¨è‡ªåŠ¨äº§ç”Ÿ</td></tr><tr><td>ACC_ENUM</td><td>0x4000</td><td>å­—æ®µæ˜¯å¦ä¸ºenum</td></tr></tbody></table><p>æè¿°ç¬¦ï¼š<br>æè¿°ç¬¦çš„ä½œç”¨æ˜¯ç”¨æ¥æè¿°å­—æ®µçš„æ•°æ®ç±»å‹ã€æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼ˆæ•°é‡ã€ç±»å‹ã€é¡ºåºï¼‰å’Œè¿”å›å€¼ã€‚<br>æ ¹æ®æè¿°ç¬¦çš„è§„åˆ™ï¼šåŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠä»£è¡¨æ— è¿”å›å€¼çš„voidç±»å‹éƒ½ç”¨ä¸€ä¸ªå¤§å†™çš„å­—ç¬¦æ¥è¡¨ç¤º;<br>è€Œå¯¹è±¡ç±»å‹åˆ™ç”¨å­—ç¬¦LåŠ å¯¹è±¡çš„å…¨é™å®šåæ¥æè¿°;</p><table><thead><tr><th>æ ‡å¿—ç¬¦å·</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>B</td><td>byte</td></tr><tr><td>C</td><td>char</td></tr><tr><td>D</td><td>double</td></tr><tr><td>F</td><td>float</td></tr><tr><td>I</td><td>int</td></tr><tr><td>J</td><td>long</td></tr><tr><td>S</td><td>short</td></tr><tr><td>Z</td><td>boolean</td></tr><tr><td>V</td><td>void æŒ‰ç…§å…ˆå‚æ•°åˆ—è¡¨åè¿”å›å€¼çš„é¡ºåºæè¿°ï¼Œå‚æ•°åˆ—è¡¨æŒ‰ç…§é¡ºåºæ”¾åœ¨â€()â€å†…éƒ¨ï¼ŒString toString()æè¿°ä¸ºV()java.lang.String</td></tr><tr><td>L</td><td>å¯¹è±¡ç±»å‹</td></tr><tr><td>[</td><td>æ•°ç»„ç±»å‹ [I: ä»£è¡¨int[], [[I:ä»£è¡¨int[][]</td></tr></tbody></table><h3 id="æ–¹æ³•è¡¨é›†åˆ"><a href="#æ–¹æ³•è¡¨é›†åˆ" class="headerlink" title="æ–¹æ³•è¡¨é›†åˆ"></a>æ–¹æ³•è¡¨é›†åˆ</h3><p>Class æ–‡ä»¶ä¸­å¯¹æ–¹æ³•çš„æè¿°å’Œå¯¹å­—æ®µçš„æè¿°å®Œå…¨æ˜¯ä¸€è‡´çš„ï¼Œ æ–¹æ³•è¡¨ä¸­çš„ç»“æ„å’Œå­—æ®µè¡¨ä¸­çš„æ¥å£ä¸€æ ·ã€‚</p><p>å› ä¸ºvolatileå…³é”®å­—å’Œtransientå…³é”®å­—ä¸èƒ½ä¿®é¥°æ–¹æ³•ï¼Œæ‰€ä»¥æ–¹æ³•è¡¨çš„è®¿é—®æ ‡å¿—ä¸­æ²¡æœ‰ACC_VOLATILEå’ŒACC_TRANSIENTã€‚ ä½†æ˜¯å¢åŠ äº†synchronized,native,abstract,strictfp(strict float point, ç²¾ç¡®çš„æµ®ç‚¹æ•°)å…³é”®å­—çš„ä¿®é¥°ç¬¦ã€‚<br>å¯¹äºæ–¹æ³•é‡Œçš„ä»£ç ï¼Œç»è¿‡ç¼–è¯‘å™¨å˜å¼‚å¸¸å­—èŠ‚ç æŒ‡ä»¤åï¼Œå­˜æ”¾åœ¨æ–¹æ³•å±æ€§è¡¨ä¸­ä¸€ä¸ªåä¸ºcodeçš„å±æ€§é‡Œã€‚</p><table><thead><tr><th>æ ‡å¿—åç§°</th><th>æ ‡å¿—å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ACC_PUBLIC</td><td>0x00 01</td><td>æ–¹æ³•æ˜¯å¦ä¸ºpublic</td></tr><tr><td>ACC_PRIVATE</td><td>0x00 02</td><td>æ–¹æ³•æ˜¯å¦ä¸ºprivate</td></tr><tr><td>ACC_PROTECTED</td><td>0x00 04</td><td>æ–¹æ³•æ˜¯å¦ä¸ºprotected</td></tr><tr><td>ACC_STATIC</td><td>0x00 08</td><td>æ–¹æ³•æ˜¯å¦ä¸ºstatic</td></tr><tr><td>ACC_FINAL</td><td>0x00 10</td><td>æ–¹æ³•æ˜¯å¦ä¸ºfinal</td></tr><tr><td>ACC_SYHCHRONRIZED</td><td>0x00 20</td><td>æ–¹æ³•æ˜¯å¦ä¸ºsynchronized</td></tr><tr><td>ACC_BRIDGE</td><td>0x00 40</td><td>æ–¹æ³•æ˜¯å¦æ˜¯æœ‰ç¼–è¯‘å™¨äº§ç”Ÿçš„æ–¹æ³•</td></tr><tr><td>ACC_VARARGS</td><td>0x00 80</td><td>æ–¹æ³•æ˜¯å¦æ¥å—å‚æ•°</td></tr><tr><td>ACC_NATIVE</td><td>0x01 00</td><td>æ–¹æ³•æ˜¯å¦ä¸ºnative</td></tr><tr><td>ACC_ABSTRACT</td><td>0x04 00</td><td>æ–¹æ³•æ˜¯å¦ä¸ºabstract</td></tr><tr><td>ACC_STRICTFP</td><td>0x08 00</td><td>æ–¹æ³•æ˜¯å¦ä¸ºstrictfp ï¼ˆstrict-float-point,ç²¾å‡†çš„æµ®ç‚¹æ•°ï¼‰</td></tr><tr><td>ACC_SYNTHETIC</td><td>0x10 00</td><td>æ–¹æ³•æ˜¯å¦æ˜¯æœ‰ç¼–è¯‘å™¨è‡ªåŠ¨äº§ç”Ÿçš„</td></tr></tbody></table><h4 id="å±æ€§è¡¨é›†åˆ"><a href="#å±æ€§è¡¨é›†åˆ" class="headerlink" title="å±æ€§è¡¨é›†åˆ"></a>å±æ€§è¡¨é›†åˆ</h4><p>åœ¨Classæ–‡ä»¶ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨ä¸­éƒ½å¯ä»¥æºå¸¦è‡ªå·±çš„å±æ€§è¡¨é›†åˆï¼ˆattribute_infoï¼‰,ç”¨äºæè¿°æŸäº›åœºæ™¯çš„ä¸“æœ‰ä¿¡æ¯ã€‚</p><p>ä¸å¼ºåˆ¶è¦æ±‚å„å±æ€§è¡¨çš„é¡ºåºï¼Œåªè¦ä¸ä¸å·²æœ‰å±æ€§è¡¨é‡åå³å¯ã€‚<br>ä»»ä½•äººå®ç°çš„ç¼–è¯‘å™¨éƒ½å¯ä»¥å‘å±æ€§è¡¨ä¸­å†™å…¥è‡ªå·±å®šä¹‰çš„å±æ€§ä¿¡æ¯ï¼ŒJavaè™šæ‹Ÿæœºåœ¨è¿è¡Œæ—¶ä¼šå¿½ç•¥ä¸è®¤è¯†çš„å±æ€§ã€‚</p><table><thead><tr><th>å±æ€§åç§°</th><th>ä½¿ç”¨ä½ç½®</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>Code</td><td>æ–¹æ³•è¡¨</td><td>Javaä»£ç ç¼–è¯‘æˆçš„å­—èŠ‚ç æŒ‡ä»¤</td></tr><tr><td>ConstantValue</td><td>å­—æ®µè¡¨</td><td>finalå…³é”®å­—å®šä¹‰çš„å¸¸é‡æ± </td></tr><tr><td>Deprecated</td><td>ç±»ï¼Œæ–¹æ³•ï¼Œå­—æ®µè¡¨</td><td>è¢«å£°æ˜ä¸ºdeprecatedçš„æ–¹æ³•å’Œå­—æ®µ</td></tr><tr><td>Exceptions</td><td>æ–¹æ³•è¡¨</td><td>æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸</td></tr><tr><td>EnclosingMethod</td><td>ç±»æ–‡ä»¶</td><td>ä»…å½“ä¸€ä¸ªç±»ä¸ºå±€éƒ¨ç±»æˆ–è€…åŒ¿åç±»æ˜¯æ‰èƒ½æ‹¥æœ‰è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§ç”¨äºæ ‡è¯†è¿™ä¸ªç±»æ‰€åœ¨çš„å¤–å›´æ–¹æ³•</td></tr><tr><td>InnerClass</td><td>ç±»æ–‡ä»¶</td><td>å†…éƒ¨ç±»åˆ—è¡¨</td></tr><tr><td>LineNumberTable</td><td>Codeå±æ€§</td><td>Javaæºç çš„è¡Œå·ä¸å­—èŠ‚ç æŒ‡ä»¤çš„å¯¹åº”å…³ç³»</td></tr><tr><td>LocalVariableTable</td><td>Codeå±æ€§</td><td>æ–¹æ³•çš„å±€éƒ¨å˜é‡æè¿°</td></tr><tr><td>StackMapTable</td><td>Codeå±æ€§</td><td>JDK1.6ä¸­æ–°å¢çš„å±æ€§ï¼Œä¾›æ–°çš„ç±»å‹æ£€æŸ¥æ£€éªŒå™¨æ£€æŸ¥å’Œå¤„ç†ç›®æ ‡æ–¹æ³•çš„å±€éƒ¨å˜é‡å’Œæ“ä½œæ•°æœ‰æ‰€éœ€è¦çš„ç±»æ˜¯å¦åŒ¹é…</td></tr><tr><td>Signature</td><td>ç±»ï¼Œæ–¹æ³•è¡¨ï¼Œå­—æ®µè¡¨</td><td>ç”¨äºæ”¯æŒæ³›å‹æƒ…å†µä¸‹çš„æ–¹æ³•ç­¾å</td></tr><tr><td>SourceFile</td><td>ç±»æ–‡ä»¶</td><td>è®°å½•æºæ–‡ä»¶åç§°</td></tr><tr><td>SourceDebugExtension</td><td>ç±»æ–‡ä»¶</td><td>ç”¨äºå­˜å‚¨é¢å¤–çš„è°ƒè¯•ä¿¡æ¯</td></tr><tr><td>Synthetic</td><td>ç±»ï¼Œæ–¹æ³•è¡¨ï¼Œå­—æ®µè¡¨</td><td>æ ‡å¿—æ–¹æ³•æˆ–å­—æ®µä¸ºç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„</td></tr><tr><td>LocalVariableTypeTable</td><td>ç±»</td><td>ä½¿ç”¨ç‰¹å¾ç­¾åä»£æ›¿æè¿°ç¬¦ï¼Œæ˜¯ä¸ºäº†å¼•å…¥æ³›å‹è¯­æ³•ä¹‹åèƒ½æè¿°æ³›å‹å‚æ•°åŒ–ç±»å‹è€Œæ·»åŠ </td></tr><tr><td>RuntimeVisibleAnnotations</td><td>ç±»ï¼Œæ–¹æ³•è¡¨ï¼Œå­—æ®µè¡¨</td><td>ä¸ºåŠ¨æ€æ³¨è§£æä¾›æ”¯æŒ</td></tr><tr><td>RuntimeInvisibleAnnotations</td><td>è¡¨ï¼Œæ–¹æ³•è¡¨ï¼Œå­—æ®µè¡¨</td><td>ç”¨äºæŒ‡æ˜å“ªäº›æ³¨è§£æ˜¯è¿è¡Œæ—¶ä¸å¯è§çš„</td></tr><tr><td>RuntimeVisibleParameterAnnotation</td><td>æ–¹æ³•è¡¨</td><td>ä½œç”¨ä¸RuntimeVisibleAnnotationså±æ€§ç±»ä¼¼ï¼Œåªä¸è¿‡ä½œç”¨å¯¹è±¡ä¸ºæ–¹æ³•</td></tr><tr><td>RuntimeInvisibleParameterAnnotation</td><td>æ–¹æ³•è¡¨</td><td>ä½œç”¨ä¸RuntimeInvisibleAnnotationså±æ€§ç±»ä¼¼ï¼Œä½œç”¨å¯¹è±¡å“ªä¸ªä¸ºæ–¹æ³•å‚æ•°</td></tr><tr><td>AnnotationDefault</td><td>æ–¹æ³•è¡¨</td><td>ç”¨äºè®°å½•æ³¨è§£ç±»å…ƒç´ çš„é»˜è®¤å€¼</td></tr><tr><td>BootstrapMethods</td><td>ç±»æ–‡ä»¶</td><td>ç”¨äºä¿å­˜invokeddynamicæŒ‡ä»¤å¼•ç”¨çš„å¼•å¯¼æ–¹å¼é™å®šç¬¦</td></tr></tbody></table><p>å¯¹äºçœ‹äº†æ–‡ç« è¿˜æœ‰ç‚¹æ‡µçš„åŒå­¦ï¼Œçœ‹è¿™é‡Œçš„è§†é¢‘è®²è§£ï¼Œå¿½ç•¥å¹¿å‘Šã€‚ã€Š<a href="https://www.bilibili.com/video/BV1xJ41167VH?p=1" target="_blank" rel="noopener">å…¨ç½‘æœ€ç‰›JVMå­—èŠ‚ç ç»“æ„åˆ†æã€Classç±»æ–‡ä»¶æ ¸å¿ƒç»“æ„</a>ã€‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
            <tag> Classç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaè™šæ‹Ÿæœº</title>
      <link href="/2020/05/28/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
      <url>/2020/05/28/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ³¨ï¼šæœ¬ç³»åˆ—ä¸ºã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹çš„è¯»ä¹¦ç¬”è®°ã€‚<br>å°‘é‡æ¥æºäºç½‘ç»œï¼Œè§†é¢‘æ•™æã€‚</p></blockquote><h3 id="å¦‚ä½•è®¾è®¡ä¸€ä¸ªè™šæ‹Ÿæœº"><a href="#å¦‚ä½•è®¾è®¡ä¸€ä¸ªè™šæ‹Ÿæœº" class="headerlink" title="å¦‚ä½•è®¾è®¡ä¸€ä¸ªè™šæ‹Ÿæœº"></a>å¦‚ä½•è®¾è®¡ä¸€ä¸ªè™šæ‹Ÿæœº</h3><p>å‡è®¾è‡ªå·±è¦å†™ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œåº”è¯¥è€ƒè™‘ä»€ä¹ˆï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è™šæ‹Ÿæœºè¦è¿è¡Œä»€ä¹ˆï¼Ÿ</span><br><span class="line">å¦‚ä½•æŠŠè§„èŒƒçš„æ–‡ä»¶å†…å®¹è¯»å–åˆ°å†…å­˜ä¸­ï¼Ÿ</span><br><span class="line">è¯»å–åˆ°å†…å­˜ä¸­çš„æ•°æ®å¦‚ä½•å­˜å‚¨ï¼Ÿ</span><br><span class="line">å¦‚ä½•æ‰§è¡Œè¿™äº›è§„èŒƒæ–‡ä»¶ä¸­çš„æ•°æ®ç¿»è¯‘æˆæ“ä½œç³»ç»Ÿè®¤è¯†çš„æŒ‡ä»¤ï¼Ÿ</span><br><span class="line">æ‰§è¡Œå®Œæˆåå¦‚ä½•æ¸…ç†ï¼Ÿ</span><br></pre></td></tr></table></figure><h3 id="è™šæ‹Ÿæœºçš„ä¸»è¦åŠŸèƒ½ä»¥åŠç»„æˆ"><a href="#è™šæ‹Ÿæœºçš„ä¸»è¦åŠŸèƒ½ä»¥åŠç»„æˆ" class="headerlink" title="è™šæ‹Ÿæœºçš„ä¸»è¦åŠŸèƒ½ä»¥åŠç»„æˆ"></a>è™šæ‹Ÿæœºçš„ä¸»è¦åŠŸèƒ½ä»¥åŠç»„æˆ</h3><p>è™šæ‹Ÿæœºè¦è¿è¡Œä»£ç ï¼Œè¿™äº›ä»£ç è¦å®šåˆ¶ä¸€ä¸ªè§„èŒƒï¼Œè¿™æ ·è™šæ‹Ÿæœºæ‰å¯ä»¥æ ¹æ®åˆ¶å®šå¥½çš„è§„èŒƒå»è§£æå’Œæ‰§è¡Œã€‚å¯¹äºJavaè™šæ‹Ÿæœºæ¥è®²ï¼Œå®ƒè¦è¯»å–çš„æ–‡ä»¶å°±æ˜¯Classç±»æ–‡ä»¶ã€‚<br>æˆ‘ä»¬éœ€è¦ä¸€æ®µä»£ç æŠŠClassç±»æ–‡ä»¶å†…å®¹è¯»å–åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶è¦æ³¨æ„åˆ¤æ–­ï¼Œè¯»å–çš„æ–‡ä»¶å†…å®¹æ˜¯å¦ç¬¦åˆClassç±»æ–‡ä»¶çš„è§„èŒƒï¼ŒåŒæ—¶æ–‡ä»¶å†…å®¹æ˜¯å¦ä¼šå±å®³åˆ°è™šæ‹Ÿæœºã€‚<br>æŠŠæ–‡ä»¶å†…å®¹è¯»å–åˆ°å†…å­˜ä¸­åï¼Œå¦‚ä½•å­˜æ”¾ã€æ–¹ä¾¿ç®¡ç†å’Œä½¿ç”¨ï¼ŒåŒæ—¶è¦ä¿è¯æ€§èƒ½ã€å®‰å…¨æ€§ã€‚<br>æŠŠè¿™äº›æ–‡ä»¶å†…å®¹â€œç¿»è¯‘â€ä¸ºæ“ä½œç³»ç»Ÿè®¤è¯†çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”æ“æ§è¿™äº›æŒ‡ä»¤æŒ‰ç…§é¢„å®šçš„â€œè§„åˆ™â€è¿è¡Œï¼Œè¾¾åˆ°å¯é¢„æœŸçš„ç»“æœã€‚ä¸ºäº†æå‡æ•ˆç‡éœ€è¦è€ƒè™‘å¤šçº¿ç¨‹å’Œå¹¶å‘ã€‚<br>æ‰§è¡Œå®Œæˆåï¼Œæ¸…ç†ä¸éœ€è¦çš„å†…å­˜ç©ºé—´ï¼Œä»¥ä¾¿å…¶ä»–ç¨‹åºä½¿ç”¨(JVMè§„èŒƒä¸­å¹¶æ²¡æœ‰è§„å®šåƒåœ¾å›æ”¶éƒ¨åˆ†)ã€‚</p><blockquote><p>JVMè™šæ‹Ÿæœºä¸åŒ…å«ClassLoaderéƒ¨åˆ†</p></blockquote><p><img src="/2020/05/28/Java%E8%99%9A%E6%8B%9F%E6%9C%BA/jvm.jpg" alt="jvm"></p><h3 id="è™šæ‹Ÿæœºç›¸å…³çŸ¥è¯†ä¼ é€é—¨"><a href="#è™šæ‹Ÿæœºç›¸å…³çŸ¥è¯†ä¼ é€é—¨" class="headerlink" title="è™šæ‹Ÿæœºç›¸å…³çŸ¥è¯†ä¼ é€é—¨"></a>è™šæ‹Ÿæœºç›¸å…³çŸ¥è¯†ä¼ é€é—¨</h3><ul><li><input checked disabled type="checkbox"> <a href="/2020/05/29/ç±»æ–‡ä»¶ç»“æ„">ç±»æ–‡ä»¶ç»“æ„</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/01/ClassLoader">ç±»åŠ è½½å™¨å’Œç±»åŠ è½½æœºåˆ¶</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/02/JVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ">JVMè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/05/å­—èŠ‚ç æ‰§è¡Œå¼•æ“">å­—èŠ‚ç æ‰§è¡Œå¼•æ“</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/02/JVMå†…å­˜æ¨¡å‹">JVM å†…å­˜æ¨¡å‹</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/08/çº¿ç¨‹å’Œå¹¶å‘">çº¿ç¨‹å’Œå¹¶å‘</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/10/å†…å­˜åˆ†é…ä¸å›æ”¶">å†…å­˜åˆ†é…ä¸å›æ”¶</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/11/ç¼–è¯‘ä¸ä¼˜åŒ–">ç¼–è¯‘ä¸ç¼–è¯‘ä¼˜åŒ–æŠ€æœ¯</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/16/å¸¸ç”¨ç›‘æ§ä¸æ•…éšœå¤„ç†å·¥å…·">å¸¸ç”¨ç›‘æ§ä¸æ•…éšœå¤„ç†å·¥å…·</a></li><li><input checked disabled type="checkbox"> <a href="/2020/06/17/å¸¸ç”¨JVMå‚æ•°">å¸¸ç”¨çš„JVMå‚æ•°</a></li></ul><p>æ‰©å±•é˜…è¯»ï¼š<a href="https://blog.csdn.net/brave2211/article/details/20380971" target="_blank" rel="noopener">æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºåˆ°åº•æ˜¯ä»€ä¹ˆ</a></p><p>Javaè™šæ‹Ÿæœºæ˜¯ä¸€ç§æŠ½è±¡çš„è®¡ç®—æœºï¼Œå®ƒæ¨¡æ‹Ÿäº†ä¸€å¥—è‡ªå·±çš„ç¡¬ä»¶ä½“ç³»ç»“æ„ï¼ˆå¤„ç†å™¨ã€å †æ ˆã€æŒ‡ä»¤é›†å’Œå¯„å­˜å™¨ï¼‰ã€‚<br>ä¸åŒçš„å¹³å°æœ‰ç€ä¸åŒçš„å®ç°ç‰ˆæœ¬ï¼Œå±è”½äº†å¹³å°çš„å·®å¼‚æ€§ã€‚ä½¿å¾—ä¸åŒå¹³å°ä¸Šçš„è™šæ‹Ÿæœºå¯ä»¥è¿è¡Œè¢«javacç¼–è¯‘çš„åŒä¸€ä»½.classæ–‡ä»¶ã€‚</p><p>å…³äºJVMçš„é¢è¯•é¢˜ï¼š<br><a href="https://juejin.im/post/5d22f4e8e51d455a68490bf4" target="_blank" rel="noopener">24ä¸ªJvmé¢è¯•é¢˜æ€»ç»“åŠç­”æ¡ˆ</a><br><a href="https://blog.csdn.net/qq_41701956/article/details/100074023" target="_blank" rel="noopener">å¸¸è§JVMé¢è¯•é¢˜åŠç­”æ¡ˆæ•´ç†</a><br><a href="https://blog.csdn.net/HarderXin/article/details/104066411" target="_blank" rel="noopener">2020å¹´JVMé¢è¯•é¢˜åè¡€æ•´ç†ã€è¿‡å¹´å¿…çœ‹ã€‘</a><br><a href="https://www.jianshu.com/p/54eb60cfa7bd" target="_blank" rel="noopener">æ€»ç»“çš„JVMé¢è¯•é¢˜</a><br><a href="https://zhuanlan.zhihu.com/p/56903960" target="_blank" rel="noopener">é¢è¯•å¿…é—®çš„JVMåº”è¯¥æ€ä¹ˆå­¦ï¼ˆé¢è¯•é¢˜å«ç­”æ¡ˆï¼‰</a><br><a href="http://www.spring4all.com/article/18645" target="_blank" rel="noopener">å¤§å‚é¢è¯•ç»ï¼šé«˜é¢‘ç‡JVMé¢è¯•é—®é¢˜æ•´ç†ï¼</a><br><a href="https://www.bilibili.com/read/cv4094201/" target="_blank" rel="noopener">2019å¹´JVMé¢è¯•éƒ½é—®äº†ä»€ä¹ˆï¼Ÿå¿«çœ‹çœ‹è¿™22é“é¢è¯•é¢˜ï¼ï¼ˆé™„ç­”æ¡ˆè§£æï¼‰</a><br><a href="https://xie.infoq.cn/article/b783efac59c5817b886329321" target="_blank" rel="noopener">JVM é¢è¯•é¢˜ 68 é—®ï¼Œé¢è¯•åˆå¯ä»¥å¤šæ‰¯ä¸€ä¸ªå°æ—¶äº†ï¼</a><br><a href="https://segmentfault.com/a/1190000021290506" target="_blank" rel="noopener">ã€æå®šJvmé¢è¯•ã€‘ Java å†…å­˜åŒºåŸŸæ­ç§˜é™„å¸¸è§é¢è¯•é¢˜è§£æ</a></p>]]></content>
      
      
      <categories>
          
          <category> JavaæŠ€æœ¯æ ˆ </category>
          
          <category> Javaè™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JVM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sublimeå¿«æ·é”®</title>
      <link href="/2019/05/29/sublime%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
      <url>/2019/05/29/sublime%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
      
        <content type="html"><![CDATA[<h4 id="Edit"><a href="#Edit" class="headerlink" title="Edit"></a>Edit</h4><p>cmd + [ | Left Indent<br>cmd + ] | Right Indent<br>cmd + ctrl + up | Swap line up<br>cmd + ctrl + down | swap line down<br>cmd + shift + d | Duplicate line<br>cmd + J | Jone Lines.<br>cmd + Left | Beginning Of Line<br>cmd + Right | End of Line<br>cmd + ctrl + / | Toggle comment block<br>ctrl + K | Delete To End.<br>ctrl + shift + K | Delete Line<br>ctrl + T | swap words.<br>cmd + shift + Enter | Insert line before<br>cmd + Enter | insert line after<br>cmd + option + T | Special characters<br>ctrl + D | delete word after</p><h4 id="Selection"><a href="#Selection" class="headerlink" title="Selection"></a>Selection</h4><p>cmd + D | Expand selection to words.<br>ctrl + cmd + G | Expand all selection to words<br>cmd + L | expand selection to line<br>Esc | Single selection , cancle multiple selection.<br>ctrl + shift + up | add previous line<br>ctrl + shift + down | add next line.<br>cmd + shift + L | å°†é€‰ä¸­çš„åŒºåŸŸåˆ†å‰²æˆå¤šè¡Œé€‰ä¸­çŠ¶æ€(å¤šå…‰æ ‡æ“ä½œçŠ¶æ€)|Split into lines<br>option + mouse | å¤šé‡å…‰æ ‡é€‰ä¸­<br>cmd + shift + J | å·²ç¼©è¿›å±‚çº§ä¸ºä¾æ®ï¼Œä¸€å±‚å±‚å‘å¤–é€‰ä¸­|Expand selection to indentation.<br>ctrl + shift + M å°†åŒ¹é…æ‹¬å·ä¸­çš„å†…å®¹é€‰ä¸­|ã€‚</p><h4 id="Find"><a href="#Find" class="headerlink" title="Find"></a>Find</h4><p>cmd + F | find<br>cmd + G | find next<br>cmd + shift + F | find in files<br>cmd + shift + E | ç¼“å­˜ç”¨äºæ›¿æ¢çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¹‹åçš„æ›¿æ¢<br>cmd + E | ç¼“å­˜ç”¨äºæŸ¥æ‰¾çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¹‹åçš„æŸ¥æ‰¾ã€‚<br>cmd + option + E | replace Next</p><h4 id="Go-To"><a href="#Go-To" class="headerlink" title="Go To"></a>Go To</h4><p>cmd + P | go to Anything<br>cmd + R | go to Symbol<br>cmd + G | Go to line.<br>ctrl + M | jump to matching bracket()<br>cmd + F2 | Toggle bookmark<br>F2. | Jump to Next bookmark.<br>cmd + shift + F2 | clear all bookmarks.<br>cmd + option + right | Next File</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿäº§åŠ› </category>
          
          <category> sublimeå¿«æ·é”® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç”Ÿäº§åŠ› </tag>
            
            <tag> sublime </tag>
            
            <tag> å¿«æ·é”® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå‘½ä»¤-äº¤é›†ã€å¹¶é›†ã€å·®é›†</title>
      <link href="/2019/05/29/Linux%E5%91%BD%E4%BB%A4-%E4%BA%A4%E9%9B%86%E3%80%81%E5%B9%B6%E9%9B%86%E3%80%81%E5%B7%AE%E9%9B%86/"/>
      <url>/2019/05/29/Linux%E5%91%BD%E4%BB%A4-%E4%BA%A4%E9%9B%86%E3%80%81%E5%B9%B6%E9%9B%86%E3%80%81%E5%B7%AE%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>Linux å‘½ä»¤</p><p>ä¸¤ä¸ªæ–‡ä»¶æ¯”å¯¹ï¼Œæ±‚äº¤é›†ï¼Œå¹¶é›†ï¼Œå·®é›†ã€‚</p><h6 id="a-txt"><a href="#a-txt" class="headerlink" title="a.txt"></a>a.txt</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">aaaaa</span><br><span class="line">bbbbb</span><br><span class="line">ccccc</span><br><span class="line">ddddd</span><br><span class="line">eeeee</span><br><span class="line">fffff</span><br><span class="line">ggggg</span><br></pre></td></tr></table></figure><h6 id="b-txt"><a href="#b-txt" class="headerlink" title="b.txt"></a>b.txt</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">aaaaa</span><br><span class="line">ccccc</span><br><span class="line">eeeee</span><br><span class="line">ggggg</span><br><span class="line">iiiii</span><br><span class="line">jjjjj</span><br><span class="line">kkkkk</span><br><span class="line">lllll</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•1-sort"><a href="#æ–¹æ³•1-sort" class="headerlink" title="æ–¹æ³•1: sort"></a>æ–¹æ³•1: sort</h2><h3 id="äº¤é›†ï¼š"><a href="#äº¤é›†ï¼š" class="headerlink" title="äº¤é›†ï¼š"></a>äº¤é›†ï¼š</h3><blockquote><p>$sort a.txt b.txt | uniq -d</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aaaaa</span><br><span class="line">ccccc</span><br><span class="line">eeeee</span><br><span class="line">ggggg</span><br></pre></td></tr></table></figure><h3 id="å¹¶é›†ï¼š"><a href="#å¹¶é›†ï¼š" class="headerlink" title="å¹¶é›†ï¼š"></a>å¹¶é›†ï¼š</h3><blockquote><p>sort a.txt b.txt | uniq</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">aaaaa</span><br><span class="line">bbbbb</span><br><span class="line">ccccc</span><br><span class="line">ddddd</span><br><span class="line">eeeee</span><br><span class="line">fffff</span><br><span class="line">ggggg</span><br><span class="line">iiiii</span><br><span class="line">jjjjj</span><br><span class="line">kkkkk</span><br><span class="line">lllll</span><br></pre></td></tr></table></figure><h3 id="å·®é›†ï¼š"><a href="#å·®é›†ï¼š" class="headerlink" title="å·®é›†ï¼š"></a>å·®é›†ï¼š</h3><blockquote><p>sort a.txt b.txt b.txt | uniq -u</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bbbbb</span><br><span class="line">ddddd</span><br><span class="line">fffff</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š sort å…ˆç»™æ–‡ä»¶æ’åºã€‚<br>-d æ˜¾ç¤ºæ¬¡æ•°å¤§äºä¸€æ¬¡çš„è¡Œ<br>-u æ˜¾ç¤ºæ¬¡æ•°ä»…ä¸ºä¸€æ¬¡çš„è¡Œ</p><h2 id="æ–¹æ³•2-comm"><a href="#æ–¹æ³•2-comm" class="headerlink" title="æ–¹æ³•2: comm"></a>æ–¹æ³•2: comm</h2><blockquote><p>comm a.txt b.txt</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">        aaaaa</span><br><span class="line">bbbbb</span><br><span class="line">        ccccc</span><br><span class="line">ddddd</span><br><span class="line">        eeeee</span><br><span class="line">fffff</span><br><span class="line">        ggggg</span><br><span class="line">    iiiii</span><br><span class="line">    jjjjj</span><br><span class="line">    kkkkk</span><br><span class="line">    lllll</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºä¸‰åˆ—ï¼š<br>ç¬¬ä¸€åˆ—ï¼šaä¸­æœ‰ï¼Œbæ²¡æœ‰ã€‚aå·®b comm -2 -3 a.txt b.txt<br>ç¬¬äºŒåˆ—ï¼šaæ²¡æœ‰ï¼Œbæœ‰ã€‚ bå·®a comm -1 -3 a.txt b.txt<br>ç¬¬ä¸‰åˆ—ï¼šabéƒ½æœ‰ aäº¤b comm -1 -2 a.txt b.txt</p><h3 id="å¤§å°å†™äº’è½¬"><a href="#å¤§å°å†™äº’è½¬" class="headerlink" title="å¤§å°å†™äº’è½¬"></a>å¤§å°å†™äº’è½¬</h3><p>æ³¨æ„ï¼š ä»¥ä¸‹å‘½ä»¤Mac OSæ— æ•ˆ</p><p>sed â€˜s/[a-z]/\u&amp;/gâ€™<br>sed â€˜s/[A-Z]/\l&amp;/gâ€™</p><h3 id="æ‹†è§£æ¯ä¸€è¡Œä¸­å›ºå®šå…³é”®å­—çš„åˆ—"><a href="#æ‹†è§£æ¯ä¸€è¡Œä¸­å›ºå®šå…³é”®å­—çš„åˆ—" class="headerlink" title="æ‹†è§£æ¯ä¸€è¡Œä¸­å›ºå®šå…³é”®å­—çš„åˆ—"></a>æ‹†è§£æ¯ä¸€è¡Œä¸­å›ºå®šå…³é”®å­—çš„åˆ—</h3><p>sed â€˜s/.(action=[a-zA-Z]{1,}).(cmd=[_a-zA-Z-]{1,})./\1 \2/â€˜<br>æ³¨æ„ï¼šåœ¨æ¬¡æ•°åŒ¹é…æ—¶ï¼š<br>1ï¼‰åœ†æ‹¬å·å¿…é¡»è½¬ä¹‰<br>2ï¼‰èŠ±æ‹¬å·å¿…é¡»è½¬ä¹‰</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> Linuxå‘½ä»¤ - äº¤é›†ã€å¹¶é›†ã€å·®é›† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> comm </tag>
            
            <tag> sort </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VIMå‘½ä»¤æ•´ç†</title>
      <link href="/2019/05/29/VIM%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/"/>
      <url>/2019/05/29/VIM%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h4 id="Alive"><a href="#Alive" class="headerlink" title="Alive"></a>Alive</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">I: Insert Mode</span><br><span class="line">Esc: Nomal Mode</span><br><span class="line">Q : Quite With Out Save.</span><br><span class="line">WQ : Write And Quite</span><br><span class="line">HJKL: Left Down Up Right.</span><br><span class="line">X: Cut Character</span><br><span class="line">DD: Delete Line</span><br><span class="line">P: Pesta Character</span><br></pre></td></tr></table></figure><h4 id="Felling-Better"><a href="#Felling-Better" class="headerlink" title="Felling Better"></a>Felling Better</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a: åœ¨å…‰æ ‡åæ’å…¥</span><br><span class="line">o: åœ¨å½“å‰è¡Œåæ’å…¥ä¸€ä¸ªæ–°è¡Œ</span><br><span class="line">O: åœ¨å½“å‰è¡Œå‰æ’å…¥ä¸€ä¸ªæ–°è¡Œ</span><br><span class="line">cw: åˆ é™¤ä»å…‰æ ‡æ‰€åœ¨ä½ç½®ååˆ°ä¸€ä¸ªå•è¯ç»“å°¾çš„å­—ç¬¦ c2w, c3w.</span><br><span class="line">Moving</span><br><span class="line">0 &#x2F; ^ å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–ï¼ˆä¸æ˜¯blankçš„ä½ç½®ï¼‰</span><br><span class="line">$ &#x2F; g_ å…‰æ ‡ç§»åŠ¨åˆ°è¡Œå°¾ï¼ˆä¸æ˜¯blankçš„ä½ç½®ï¼‰</span><br><span class="line">&#x2F;pattern å®šä½åˆ°patternçš„åŒºåŸŸ</span><br><span class="line">Pesta</span><br><span class="line">p: pesta</span><br><span class="line">u : undo</span><br><span class="line">ctrl+r : redo</span><br></pre></td></tr></table></figure><h4 id="Better-Faster-Stronger"><a href="#Better-Faster-Stronger" class="headerlink" title="Better,Faster,Stronger"></a>Better,Faster,Stronger</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">2d : delete two lines.</span><br><span class="line">100idesu[Esc]: insert 100 times desu.</span><br><span class="line">4p : pesta 4 times.</span><br><span class="line">% : swap &#123;&#125;</span><br><span class="line">#&#x2F;* : å‘ä¸Šï¼ä¸‹æœç´¢å½“å‰å…‰æ ‡æ‰€åœ¨çš„å•è¯</span><br><span class="line"></span><br><span class="line">0y$ ï¼šç§»åŠ¨åˆ°è¡Œé¦–ï¼Œå¼€å§‹copyï¼Œä¸€ç›´åˆ°æœ¬è¡Œæœ€åä¸€ä¸ªå­—ç¬¦ã€‚</span><br><span class="line">d: delete and copy</span><br><span class="line">v: select and copy</span><br><span class="line">gU: å˜å¤§å†™ and copy</span><br><span class="line">gu: å˜å°å†™ And copy</span><br></pre></td></tr></table></figure><h4 id="å—æ“ä½œ"><a href="#å—æ“ä½œ" class="headerlink" title="å—æ“ä½œ"></a>å—æ“ä½œ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">^ -&gt; åˆ°å¼€å¤´</span><br><span class="line">Ctrl-v -&gt; å¼€å§‹å—æ“ä½œ</span><br><span class="line">Ctrl-d -&gt; å‘ä¸‹ç§»åŠ¨</span><br><span class="line">Iâ€“ [Esc]-&gt; æ’å…¥â€“</span><br></pre></td></tr></table></figure><h4 id="vimè¶…èƒ½åŠ›"><a href="#vimè¶…èƒ½åŠ›" class="headerlink" title="vimè¶…èƒ½åŠ›"></a>vimè¶…èƒ½åŠ›</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">åœ¨å½“å‰è¡Œç§»åŠ¨å…‰æ ‡ï¼š</span><br><span class="line">0: åˆ°è¡Œé¦–</span><br><span class="line">^: åˆ°æœ¬è¡Œçš„ç¬¬ä¸€ä¸ªéblankå­—ç¬¦</span><br><span class="line">$: åˆ°è¡Œå°¾</span><br><span class="line">g_ï¼šåˆ°æœ¬è¡Œæœ€åä¸€ä¸ªéblankå­—ç¬¦</span><br><span class="line">faï¼šåˆ°ä¸‹ä¸€ä¸ªä¸ºaçš„å­—ç¬¦å¤„ï¼Œ fsåˆ°ä¸‹ä¸€ä¸ªä¸ºsçš„å­—ç¬¦å¤„</span><br><span class="line">tï¼Œï¼›åˆ°é€—å·å‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œtaåˆ°aå‰çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">3faï¼šå½“å‰è¡ŒæŸ¥æ‰¾ç¬¬ä¸‰ä¸ªå‡ºç°çš„a</span><br><span class="line">dtï¼Œï¼šåˆ é™¤å¤šæœ‰çš„å†…å®¹ï¼Œä¸€ç›´åˆ°é€—å·å‡ºç°ã€‚</span><br></pre></td></tr></table></figure><h4 id="åŒºåŸŸé€‰æ‹©"><a href="#åŒºåŸŸé€‰æ‹©" class="headerlink" title="åŒºåŸŸé€‰æ‹©"></a>åŒºåŸŸé€‰æ‹©</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a å’Œ i</span><br><span class="line">action å¯ä»¥æ˜¯ä»»ä½•å‘½ä»¤ï¼Œdï¼šdeleteï¼Œ yï¼šcopyï¼Œ vï¼šview mode</span><br><span class="line">object å¯ä»¥æ˜¯ï¼šwï¼šwordï¼Œ sï¼šstatementï¼Œ pï¼šparagraphï¼Œä¹Ÿå¯ä»¥æ˜¯ç‰¹æ®Šçš„å­—ç¬¦ã€‚</span><br><span class="line">ä¾‹å¦‚å­—ç¬¦ä¸²ï¼š(map (+) (&quot;foo&quot;)),å…‰æ ‡åœ¨oä¸Šã€‚</span><br><span class="line">viâ€ : foo</span><br><span class="line">vaâ€ : â€œfooâ€</span><br><span class="line">vi) : â€œfooâ€</span><br><span class="line">va) : (â€œfooâ€)</span><br><span class="line">v2i): map (+) (â€œfooâ€)</span><br><span class="line">v2a): (map (+) (â€œfooâ€))</span><br></pre></td></tr></table></figure><h4 id="å¯è§†åŒ–é€‰æ‹©"><a href="#å¯è§†åŒ–é€‰æ‹©" class="headerlink" title="å¯è§†åŒ–é€‰æ‹©"></a>å¯è§†åŒ–é€‰æ‹©</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">######ç¼©è¿›######</span><br><span class="line">ä½¿ç”¨vï¼Vè¿›å…¥å¯è§†åŒ–æ¨¡å¼</span><br><span class="line">J ï¼š æŠŠæ‰€æœ‰çš„è¡Œé“¾æ¥èµ·æ¥å˜æˆä¸€è¡Œ</span><br><span class="line">&lt;&#x2F;&gt;ï¼šå·¦å³ç¼©è¿›</span><br><span class="line">&#x3D; ï¼šè‡ªåŠ¨ç¼©è¿›</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">######è¡Œåè¿½åŠ ######</span><br><span class="line">ctrl+v ï¼š è¿›å…¥å¯è§†åŒ–ç¼–è¾‘æ¨¡å¼</span><br><span class="line">é€‰ä¸­ç›¸åº”çš„è¡Œï¼ˆjæˆ–è€…ctrl+d æˆ–è€…ï¼pattern æˆ–è€…%ï¼‰</span><br><span class="line">$åˆ°è¡Œæœ€å</span><br><span class="line">A(append,åœ¨è¡Œå°¾è¿½åŠ )ï¼Œ è¾“å…¥å­—ç¬¦ä¸²ï¼Œ æŒ‰ESC</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> VIM </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
